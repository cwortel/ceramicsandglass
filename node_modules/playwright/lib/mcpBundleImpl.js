"use strict";var Ld=Object.create;var aa=Object.defineProperty;var Fd=Object.getOwnPropertyDescriptor;var qd=Object.getOwnPropertyNames;var Ud=Object.getPrototypeOf,zd=Object.prototype.hasOwnProperty;var Vd=(a,e,r)=>e in a?aa(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r;var M=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),Lo=(a,e)=>{for(var r in e)aa(a,r,{get:e[r],enumerable:!0})},Ma=(a,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of qd(e))!zd.call(a,t)&&t!==r&&aa(a,t,{get:()=>e[t],enumerable:!(s=Fd(e,t))||s.enumerable});return a},Fo=(a,e,r)=>(Ma(a,e,"default"),r&&Ma(r,e,"default")),ht=(a,e,r)=>(r=a!=null?Ld(Ud(a)):{},Ma(e||!a||!a.__esModule?aa(r,"default",{value:a,enumerable:!0}):r,a)),Hd=a=>Ma(aa({},"__esModule",{value:!0}),a);var Me=(a,e,r)=>Vd(a,typeof e!="symbol"?e+"":e,r);var pi=M((Ya,fi)=>{(function(a,e){typeof Ya=="object"&&typeof fi!="undefined"?e(Ya):typeof define=="function"&&define.amd?define(["exports"],e):e(a.URI=a.URI||{})})(Ya,(function(a){"use strict";function e(){for(var _=arguments.length,p=Array(_),b=0;b<_;b++)p[b]=arguments[b];if(p.length>1){p[0]=p[0].slice(0,-1);for(var x=p.length-1,E=1;E<x;++E)p[E]=p[E].slice(1,-1);return p[x]=p[x].slice(1),p.join("")}else return p[0]}function r(_){return"(?:"+_+")"}function s(_){return _===void 0?"undefined":_===null?"null":Object.prototype.toString.call(_).split(" ").pop().split("]").shift().toLowerCase()}function t(_){return _.toUpperCase()}function n(_){return _!=null?_ instanceof Array?_:typeof _.length!="number"||_.split||_.setInterval||_.call?[_]:Array.prototype.slice.call(_):[]}function o(_,p){var b=_;if(p)for(var x in p)b[x]=p[x];return b}function i(_){var p="[A-Za-z]",b="[\\x0D]",x="[0-9]",E="[\\x22]",j=e(x,"[A-Fa-f]"),W="[\\x0A]",se="[\\x20]",le=r(r("%[EFef]"+j+"%"+j+j+"%"+j+j)+"|"+r("%[89A-Fa-f]"+j+"%"+j+j)+"|"+r("%"+j+j)),xe="[\\:\\/\\?\\#\\[\\]\\@]",ae="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",me=e(xe,ae),Ee=_?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",he=_?"[\\uE000-\\uF8FF]":"[]",oe=e(p,x,"[\\-\\.\\_\\~]",Ee),ve=r(p+e(p,x,"[\\+\\-\\.]")+"*"),ue=r(r(le+"|"+e(oe,ae,"[\\:]"))+"*"),Qt=r(r("25[0-5]")+"|"+r("2[0-4]"+x)+"|"+r("1"+x+x)+"|"+r("[1-9]"+x)+"|"+x),Je=r(r("25[0-5]")+"|"+r("2[0-4]"+x)+"|"+r("1"+x+x)+"|"+r("0?[1-9]"+x)+"|0?0?"+x),Ke=r(Je+"\\."+Je+"\\."+Je+"\\."+Je),de=r(j+"{1,4}"),Qe=r(r(de+"\\:"+de)+"|"+Ke),Ye=r(r(de+"\\:")+"{6}"+Qe),dt=r("\\:\\:"+r(de+"\\:")+"{5}"+Qe),Wt=r(r(de)+"?\\:\\:"+r(de+"\\:")+"{4}"+Qe),bt=r(r(r(de+"\\:")+"{0,1}"+de)+"?\\:\\:"+r(de+"\\:")+"{3}"+Qe),Yr=r(r(r(de+"\\:")+"{0,2}"+de)+"?\\:\\:"+r(de+"\\:")+"{2}"+Qe),Da=r(r(r(de+"\\:")+"{0,3}"+de)+"?\\:\\:"+de+"\\:"+Qe),Na=r(r(r(de+"\\:")+"{0,4}"+de)+"?\\:\\:"+Qe),Er=r(r(r(de+"\\:")+"{0,5}"+de)+"?\\:\\:"+de),Pr=r(r(r(de+"\\:")+"{0,6}"+de)+"?\\:\\:"),wt=r([Ye,dt,Wt,bt,Yr,Da,Na,Er,Pr].join("|")),Sr=r(r(oe+"|"+le)+"+"),Us=r(wt+"\\%25"+Sr),Gt=r(wt+r("\\%25|\\%(?!"+j+"{2})")+Sr),Ad=r("[vV]"+j+"+\\."+e(oe,ae,"[\\:]")+"+"),$d=r("\\["+r(Gt+"|"+wt+"|"+Ad)+"\\]"),Do=r(r(le+"|"+e(oe,ae))+"*"),Xr=r($d+"|"+Ke+"(?!"+Do+")|"+Do),ea=r(x+"*"),No=r(r(ue+"@")+"?"+Xr+r("\\:"+ea)+"?"),ta=r(le+"|"+e(oe,ae,"[\\:\\@]")),kd=r(ta+"*"),jo=r(ta+"+"),Dd=r(r(le+"|"+e(oe,ae,"[\\@]"))+"+"),xt=r(r("\\/"+kd)+"*"),Rr=r("\\/"+r(jo+xt)+"?"),zs=r(Dd+xt),ja=r(jo+xt),Or="(?!"+ta+")",xg=r(xt+"|"+Rr+"|"+zs+"|"+ja+"|"+Or),Tr=r(r(ta+"|"+e("[\\/\\?]",he))+"*"),ra=r(r(ta+"|[\\/\\?]")+"*"),Mo=r(r("\\/\\/"+No+xt)+"|"+Rr+"|"+ja+"|"+Or),Nd=r(ve+"\\:"+Mo+r("\\?"+Tr)+"?"+r("\\#"+ra)+"?"),jd=r(r("\\/\\/"+No+xt)+"|"+Rr+"|"+zs+"|"+Or),Md=r(jd+r("\\?"+Tr)+"?"+r("\\#"+ra)+"?"),Eg=r(Nd+"|"+Md),Pg=r(ve+"\\:"+Mo+r("\\?"+Tr)+"?"),Sg="^("+ve+")\\:"+r(r("\\/\\/("+r("("+ue+")@")+"?("+Xr+")"+r("\\:("+ea+")")+"?)")+"?("+xt+"|"+Rr+"|"+ja+"|"+Or+")")+r("\\?("+Tr+")")+"?"+r("\\#("+ra+")")+"?$",Rg="^(){0}"+r(r("\\/\\/("+r("("+ue+")@")+"?("+Xr+")"+r("\\:("+ea+")")+"?)")+"?("+xt+"|"+Rr+"|"+zs+"|"+Or+")")+r("\\?("+Tr+")")+"?"+r("\\#("+ra+")")+"?$",Og="^("+ve+")\\:"+r(r("\\/\\/("+r("("+ue+")@")+"?("+Xr+")"+r("\\:("+ea+")")+"?)")+"?("+xt+"|"+Rr+"|"+ja+"|"+Or+")")+r("\\?("+Tr+")")+"?$",Tg="^"+r("\\#("+ra+")")+"?$",Cg="^"+r("("+ue+")@")+"?("+Xr+")"+r("\\:("+ea+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",p,x,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",oe,ae),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",oe,ae),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",oe,ae),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",oe,ae),"g"),NOT_QUERY:new RegExp(e("[^\\%]",oe,ae,"[\\:\\@\\/\\?]",he),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",oe,ae,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",oe,ae),"g"),UNRESERVED:new RegExp(oe,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",oe,me),"g"),PCT_ENCODED:new RegExp(le,"g"),IPV4ADDRESS:new RegExp("^("+Ke+")$"),IPV6ADDRESS:new RegExp("^\\[?("+wt+")"+r(r("\\%25|\\%(?!"+j+"{2})")+"("+Sr+")")+"?\\]?$")}}var u=i(!1),c=i(!0),h=(function(){function _(p,b){var x=[],E=!0,j=!1,W=void 0;try{for(var se=p[Symbol.iterator](),le;!(E=(le=se.next()).done)&&(x.push(le.value),!(b&&x.length===b));E=!0);}catch(xe){j=!0,W=xe}finally{try{!E&&se.return&&se.return()}finally{if(j)throw W}}return x}return function(p,b){if(Array.isArray(p))return p;if(Symbol.iterator in Object(p))return _(p,b);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),f=function(_){if(Array.isArray(_)){for(var p=0,b=Array(_.length);p<_.length;p++)b[p]=_[p];return b}else return Array.from(_)},v=2147483647,d=36,y=1,m=26,g=38,w=700,S=72,P=128,R="-",O=/^xn--/,A=/[^\0-\x7E]/,U=/[\x2E\u3002\uFF0E\uFF61]/g,z={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},$=d-y,V=Math.floor,q=String.fromCharCode;function L(_){throw new RangeError(z[_])}function I(_,p){for(var b=[],x=_.length;x--;)b[x]=p(_[x]);return b}function k(_,p){var b=_.split("@"),x="";b.length>1&&(x=b[0]+"@",_=b[1]),_=_.replace(U,".");var E=_.split("."),j=I(E,p).join(".");return x+j}function F(_){for(var p=[],b=0,x=_.length;b<x;){var E=_.charCodeAt(b++);if(E>=55296&&E<=56319&&b<x){var j=_.charCodeAt(b++);(j&64512)==56320?p.push(((E&1023)<<10)+(j&1023)+65536):(p.push(E),b--)}else p.push(E)}return p}var ce=function(p){return String.fromCodePoint.apply(String,f(p))},Y=function(p){return p-48<10?p-22:p-65<26?p-65:p-97<26?p-97:d},re=function(p,b){return p+22+75*(p<26)-((b!=0)<<5)},K=function(p,b,x){var E=0;for(p=x?V(p/w):p>>1,p+=V(p/b);p>$*m>>1;E+=d)p=V(p/$);return V(E+($+1)*p/(p+g))},Z=function(p){var b=[],x=p.length,E=0,j=P,W=S,se=p.lastIndexOf(R);se<0&&(se=0);for(var le=0;le<se;++le)p.charCodeAt(le)>=128&&L("not-basic"),b.push(p.charCodeAt(le));for(var xe=se>0?se+1:0;xe<x;){for(var ae=E,me=1,Ee=d;;Ee+=d){xe>=x&&L("invalid-input");var he=Y(p.charCodeAt(xe++));(he>=d||he>V((v-E)/me))&&L("overflow"),E+=he*me;var oe=Ee<=W?y:Ee>=W+m?m:Ee-W;if(he<oe)break;var ve=d-oe;me>V(v/ve)&&L("overflow"),me*=ve}var ue=b.length+1;W=K(E-ae,ue,ae==0),V(E/ue)>v-j&&L("overflow"),j+=V(E/ue),E%=ue,b.splice(E++,0,j)}return String.fromCodePoint.apply(String,b)},ge=function(p){var b=[];p=F(p);var x=p.length,E=P,j=0,W=S,se=!0,le=!1,xe=void 0;try{for(var ae=p[Symbol.iterator](),me;!(se=(me=ae.next()).done);se=!0){var Ee=me.value;Ee<128&&b.push(q(Ee))}}catch(Gt){le=!0,xe=Gt}finally{try{!se&&ae.return&&ae.return()}finally{if(le)throw xe}}var he=b.length,oe=he;for(he&&b.push(R);oe<x;){var ve=v,ue=!0,Qt=!1,Je=void 0;try{for(var Ke=p[Symbol.iterator](),de;!(ue=(de=Ke.next()).done);ue=!0){var Qe=de.value;Qe>=E&&Qe<ve&&(ve=Qe)}}catch(Gt){Qt=!0,Je=Gt}finally{try{!ue&&Ke.return&&Ke.return()}finally{if(Qt)throw Je}}var Ye=oe+1;ve-E>V((v-j)/Ye)&&L("overflow"),j+=(ve-E)*Ye,E=ve;var dt=!0,Wt=!1,bt=void 0;try{for(var Yr=p[Symbol.iterator](),Da;!(dt=(Da=Yr.next()).done);dt=!0){var Na=Da.value;if(Na<E&&++j>v&&L("overflow"),Na==E){for(var Er=j,Pr=d;;Pr+=d){var wt=Pr<=W?y:Pr>=W+m?m:Pr-W;if(Er<wt)break;var Sr=Er-wt,Us=d-wt;b.push(q(re(wt+Sr%Us,0))),Er=V(Sr/Us)}b.push(q(re(Er,0))),W=K(j,Ye,oe==he),j=0,++oe}}}catch(Gt){Wt=!0,bt=Gt}finally{try{!dt&&Yr.return&&Yr.return()}finally{if(Wt)throw bt}}++j,++E}return b.join("")},Ie=function(p){return k(p,function(b){return O.test(b)?Z(b.slice(4).toLowerCase()):b})},De=function(p){return k(p,function(b){return A.test(b)?"xn--"+ge(b):b})},ne={version:"2.1.0",ucs2:{decode:F,encode:ce},decode:Z,encode:ge,toASCII:De,toUnicode:Ie},be={};function Re(_){var p=_.charCodeAt(0),b=void 0;return p<16?b="%0"+p.toString(16).toUpperCase():p<128?b="%"+p.toString(16).toUpperCase():p<2048?b="%"+(p>>6|192).toString(16).toUpperCase()+"%"+(p&63|128).toString(16).toUpperCase():b="%"+(p>>12|224).toString(16).toUpperCase()+"%"+(p>>6&63|128).toString(16).toUpperCase()+"%"+(p&63|128).toString(16).toUpperCase(),b}function Ne(_){for(var p="",b=0,x=_.length;b<x;){var E=parseInt(_.substr(b+1,2),16);if(E<128)p+=String.fromCharCode(E),b+=3;else if(E>=194&&E<224){if(x-b>=6){var j=parseInt(_.substr(b+4,2),16);p+=String.fromCharCode((E&31)<<6|j&63)}else p+=_.substr(b,6);b+=6}else if(E>=224){if(x-b>=9){var W=parseInt(_.substr(b+4,2),16),se=parseInt(_.substr(b+7,2),16);p+=String.fromCharCode((E&15)<<12|(W&63)<<6|se&63)}else p+=_.substr(b,9);b+=9}else p+=_.substr(b,3),b+=3}return p}function At(_,p){function b(x){var E=Ne(x);return E.match(p.UNRESERVED)?E:x}return _.scheme&&(_.scheme=String(_.scheme).replace(p.PCT_ENCODED,b).toLowerCase().replace(p.NOT_SCHEME,"")),_.userinfo!==void 0&&(_.userinfo=String(_.userinfo).replace(p.PCT_ENCODED,b).replace(p.NOT_USERINFO,Re).replace(p.PCT_ENCODED,t)),_.host!==void 0&&(_.host=String(_.host).replace(p.PCT_ENCODED,b).toLowerCase().replace(p.NOT_HOST,Re).replace(p.PCT_ENCODED,t)),_.path!==void 0&&(_.path=String(_.path).replace(p.PCT_ENCODED,b).replace(_.scheme?p.NOT_PATH:p.NOT_PATH_NOSCHEME,Re).replace(p.PCT_ENCODED,t)),_.query!==void 0&&(_.query=String(_.query).replace(p.PCT_ENCODED,b).replace(p.NOT_QUERY,Re).replace(p.PCT_ENCODED,t)),_.fragment!==void 0&&(_.fragment=String(_.fragment).replace(p.PCT_ENCODED,b).replace(p.NOT_FRAGMENT,Re).replace(p.PCT_ENCODED,t)),_}function yt(_){return _.replace(/^0*(.*)/,"$1")||"0"}function we(_,p){var b=_.match(p.IPV4ADDRESS)||[],x=h(b,2),E=x[1];return E?E.split(".").map(yt).join("."):_}function ye(_,p){var b=_.match(p.IPV6ADDRESS)||[],x=h(b,3),E=x[1],j=x[2];if(E){for(var W=E.toLowerCase().split("::").reverse(),se=h(W,2),le=se[0],xe=se[1],ae=xe?xe.split(":").map(yt):[],me=le.split(":").map(yt),Ee=p.IPV4ADDRESS.test(me[me.length-1]),he=Ee?7:8,oe=me.length-he,ve=Array(he),ue=0;ue<he;++ue)ve[ue]=ae[ue]||me[oe+ue]||"";Ee&&(ve[he-1]=we(ve[he-1],p));var Qt=ve.reduce(function(Ye,dt,Wt){if(!dt||dt==="0"){var bt=Ye[Ye.length-1];bt&&bt.index+bt.length===Wt?bt.length++:Ye.push({index:Wt,length:1})}return Ye},[]),Je=Qt.sort(function(Ye,dt){return dt.length-Ye.length})[0],Ke=void 0;if(Je&&Je.length>1){var de=ve.slice(0,Je.index),Qe=ve.slice(Je.index+Je.length);Ke=de.join(":")+"::"+Qe.join(":")}else Ke=ve.join(":");return j&&(Ke+="%"+j),Ke}else return _}var Zt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Ae="".match(/(){0}/)[1]===void 0;function ie(_){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b={},x=p.iri!==!1?c:u;p.reference==="suffix"&&(_=(p.scheme?p.scheme+":":"")+"//"+_);var E=_.match(Zt);if(E){Ae?(b.scheme=E[1],b.userinfo=E[3],b.host=E[4],b.port=parseInt(E[5],10),b.path=E[6]||"",b.query=E[7],b.fragment=E[8],isNaN(b.port)&&(b.port=E[5])):(b.scheme=E[1]||void 0,b.userinfo=_.indexOf("@")!==-1?E[3]:void 0,b.host=_.indexOf("//")!==-1?E[4]:void 0,b.port=parseInt(E[5],10),b.path=E[6]||"",b.query=_.indexOf("?")!==-1?E[7]:void 0,b.fragment=_.indexOf("#")!==-1?E[8]:void 0,isNaN(b.port)&&(b.port=_.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?E[4]:void 0)),b.host&&(b.host=ye(we(b.host,x),x)),b.scheme===void 0&&b.userinfo===void 0&&b.host===void 0&&b.port===void 0&&!b.path&&b.query===void 0?b.reference="same-document":b.scheme===void 0?b.reference="relative":b.fragment===void 0?b.reference="absolute":b.reference="uri",p.reference&&p.reference!=="suffix"&&p.reference!==b.reference&&(b.error=b.error||"URI is not a "+p.reference+" reference.");var j=be[(p.scheme||b.scheme||"").toLowerCase()];if(!p.unicodeSupport&&(!j||!j.unicodeSupport)){if(b.host&&(p.domainHost||j&&j.domainHost))try{b.host=ne.toASCII(b.host.replace(x.PCT_ENCODED,Ne).toLowerCase())}catch(W){b.error=b.error||"Host's domain name can not be converted to ASCII via punycode: "+W}At(b,u)}else At(b,x);j&&j.parse&&j.parse(b,p)}else b.error=b.error||"URI can not be parsed.";return b}function $t(_,p){var b=p.iri!==!1?c:u,x=[];return _.userinfo!==void 0&&(x.push(_.userinfo),x.push("@")),_.host!==void 0&&x.push(ye(we(String(_.host),b),b).replace(b.IPV6ADDRESS,function(E,j,W){return"["+j+(W?"%25"+W:"")+"]"})),(typeof _.port=="number"||typeof _.port=="string")&&(x.push(":"),x.push(String(_.port))),x.length?x.join(""):void 0}var _t=/^\.\.?\//,Bt=/^\/\.(\/|$)/,Jt=/^\/\.\.(\/|$)/,Te=/^\/?(?:.|\n)*?(?=\/|$)/;function Ge(_){for(var p=[];_.length;)if(_.match(_t))_=_.replace(_t,"");else if(_.match(Bt))_=_.replace(Bt,"/");else if(_.match(Jt))_=_.replace(Jt,"/"),p.pop();else if(_==="."||_==="..")_="";else{var b=_.match(Te);if(b){var x=b[0];_=_.slice(x.length),p.push(x)}else throw new Error("Unexpected dot segment condition")}return p.join("")}function qe(_){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=p.iri?c:u,x=[],E=be[(p.scheme||_.scheme||"").toLowerCase()];if(E&&E.serialize&&E.serialize(_,p),_.host&&!b.IPV6ADDRESS.test(_.host)){if(p.domainHost||E&&E.domainHost)try{_.host=p.iri?ne.toUnicode(_.host):ne.toASCII(_.host.replace(b.PCT_ENCODED,Ne).toLowerCase())}catch(se){_.error=_.error||"Host's domain name can not be converted to "+(p.iri?"Unicode":"ASCII")+" via punycode: "+se}}At(_,b),p.reference!=="suffix"&&_.scheme&&(x.push(_.scheme),x.push(":"));var j=$t(_,p);if(j!==void 0&&(p.reference!=="suffix"&&x.push("//"),x.push(j),_.path&&_.path.charAt(0)!=="/"&&x.push("/")),_.path!==void 0){var W=_.path;!p.absolutePath&&(!E||!E.absolutePath)&&(W=Ge(W)),j===void 0&&(W=W.replace(/^\/\//,"/%2F")),x.push(W)}return _.query!==void 0&&(x.push("?"),x.push(_.query)),_.fragment!==void 0&&(x.push("#"),x.push(_.fragment)),x.join("")}function je(_,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},x=arguments[3],E={};return x||(_=ie(qe(_,b),b),p=ie(qe(p,b),b)),b=b||{},!b.tolerant&&p.scheme?(E.scheme=p.scheme,E.userinfo=p.userinfo,E.host=p.host,E.port=p.port,E.path=Ge(p.path||""),E.query=p.query):(p.userinfo!==void 0||p.host!==void 0||p.port!==void 0?(E.userinfo=p.userinfo,E.host=p.host,E.port=p.port,E.path=Ge(p.path||""),E.query=p.query):(p.path?(p.path.charAt(0)==="/"?E.path=Ge(p.path):((_.userinfo!==void 0||_.host!==void 0||_.port!==void 0)&&!_.path?E.path="/"+p.path:_.path?E.path=_.path.slice(0,_.path.lastIndexOf("/")+1)+p.path:E.path=p.path,E.path=Ge(E.path)),E.query=p.query):(E.path=_.path,p.query!==void 0?E.query=p.query:E.query=_.query),E.userinfo=_.userinfo,E.host=_.host,E.port=_.port),E.scheme=_.scheme),E.fragment=p.fragment,E}function ct(_,p,b){var x=o({scheme:"null"},b);return qe(je(ie(_,x),ie(p,x),x,!0),x)}function Be(_,p){return typeof _=="string"?_=qe(ie(_,p),p):s(_)==="object"&&(_=ie(qe(_,p),p)),_}function ka(_,p,b){return typeof _=="string"?_=qe(ie(_,b),b):s(_)==="object"&&(_=qe(_,b)),typeof p=="string"?p=qe(ie(p,b),b):s(p)==="object"&&(p=qe(p,b)),_===p}function Fs(_,p){return _&&_.toString().replace(!p||!p.iri?u.ESCAPE:c.ESCAPE,Re)}function st(_,p){return _&&_.toString().replace(!p||!p.iri?u.PCT_ENCODED:c.PCT_ENCODED,Ne)}var Gr={scheme:"http",domainHost:!0,parse:function(p,b){return p.host||(p.error=p.error||"HTTP URIs must have a host."),p},serialize:function(p,b){var x=String(p.scheme).toLowerCase()==="https";return(p.port===(x?443:80)||p.port==="")&&(p.port=void 0),p.path||(p.path="/"),p}},Ro={scheme:"https",domainHost:Gr.domainHost,parse:Gr.parse,serialize:Gr.serialize};function Oo(_){return typeof _.secure=="boolean"?_.secure:String(_.scheme).toLowerCase()==="wss"}var Kr={scheme:"ws",domainHost:!0,parse:function(p,b){var x=p;return x.secure=Oo(x),x.resourceName=(x.path||"/")+(x.query?"?"+x.query:""),x.path=void 0,x.query=void 0,x},serialize:function(p,b){if((p.port===(Oo(p)?443:80)||p.port==="")&&(p.port=void 0),typeof p.secure=="boolean"&&(p.scheme=p.secure?"wss":"ws",p.secure=void 0),p.resourceName){var x=p.resourceName.split("?"),E=h(x,2),j=E[0],W=E[1];p.path=j&&j!=="/"?j:void 0,p.query=W,p.resourceName=void 0}return p.fragment=void 0,p}},To={scheme:"wss",domainHost:Kr.domainHost,parse:Kr.parse,serialize:Kr.serialize},_d={},bd=!0,Co="[A-Za-z0-9\\-\\.\\_\\~"+(bd?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",ut="[0-9A-Fa-f]",wd=r(r("%[EFef]"+ut+"%"+ut+ut+"%"+ut+ut)+"|"+r("%[89A-Fa-f]"+ut+"%"+ut+ut)+"|"+r("%"+ut+ut)),xd="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Ed="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Pd=e(Ed,'[\\"\\\\]'),Sd="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Rd=new RegExp(Co,"g"),xr=new RegExp(wd,"g"),Od=new RegExp(e("[^]",xd,"[\\.]",'[\\"]',Pd),"g"),Io=new RegExp(e("[^]",Co,Sd),"g"),Td=Io;function qs(_){var p=Ne(_);return p.match(Rd)?p:_}var Ao={scheme:"mailto",parse:function(p,b){var x=p,E=x.to=x.path?x.path.split(","):[];if(x.path=void 0,x.query){for(var j=!1,W={},se=x.query.split("&"),le=0,xe=se.length;le<xe;++le){var ae=se[le].split("=");switch(ae[0]){case"to":for(var me=ae[1].split(","),Ee=0,he=me.length;Ee<he;++Ee)E.push(me[Ee]);break;case"subject":x.subject=st(ae[1],b);break;case"body":x.body=st(ae[1],b);break;default:j=!0,W[st(ae[0],b)]=st(ae[1],b);break}}j&&(x.headers=W)}x.query=void 0;for(var oe=0,ve=E.length;oe<ve;++oe){var ue=E[oe].split("@");if(ue[0]=st(ue[0]),b.unicodeSupport)ue[1]=st(ue[1],b).toLowerCase();else try{ue[1]=ne.toASCII(st(ue[1],b).toLowerCase())}catch(Qt){x.error=x.error||"Email address's domain name can not be converted to ASCII via punycode: "+Qt}E[oe]=ue.join("@")}return x},serialize:function(p,b){var x=p,E=n(p.to);if(E){for(var j=0,W=E.length;j<W;++j){var se=String(E[j]),le=se.lastIndexOf("@"),xe=se.slice(0,le).replace(xr,qs).replace(xr,t).replace(Od,Re),ae=se.slice(le+1);try{ae=b.iri?ne.toUnicode(ae):ne.toASCII(st(ae,b).toLowerCase())}catch(oe){x.error=x.error||"Email address's domain name can not be converted to "+(b.iri?"Unicode":"ASCII")+" via punycode: "+oe}E[j]=xe+"@"+ae}x.path=E.join(",")}var me=p.headers=p.headers||{};p.subject&&(me.subject=p.subject),p.body&&(me.body=p.body);var Ee=[];for(var he in me)me[he]!==_d[he]&&Ee.push(he.replace(xr,qs).replace(xr,t).replace(Io,Re)+"="+me[he].replace(xr,qs).replace(xr,t).replace(Td,Re));return Ee.length&&(x.query=Ee.join("&")),x}},Cd=/^([^\:]+)\:(.*)/,$o={scheme:"urn",parse:function(p,b){var x=p.path&&p.path.match(Cd),E=p;if(x){var j=b.scheme||E.scheme||"urn",W=x[1].toLowerCase(),se=x[2],le=j+":"+(b.nid||W),xe=be[le];E.nid=W,E.nss=se,E.path=void 0,xe&&(E=xe.parse(E,b))}else E.error=E.error||"URN can not be parsed.";return E},serialize:function(p,b){var x=b.scheme||p.scheme||"urn",E=p.nid,j=x+":"+(b.nid||E),W=be[j];W&&(p=W.serialize(p,b));var se=p,le=p.nss;return se.path=(E||b.nid)+":"+le,se}},Id=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ko={scheme:"urn:uuid",parse:function(p,b){var x=p;return x.uuid=x.nss,x.nss=void 0,!b.tolerant&&(!x.uuid||!x.uuid.match(Id))&&(x.error=x.error||"UUID is not valid."),x},serialize:function(p,b){var x=p;return x.nss=(p.uuid||"").toLowerCase(),x}};be[Gr.scheme]=Gr,be[Ro.scheme]=Ro,be[Kr.scheme]=Kr,be[To.scheme]=To,be[Ao.scheme]=Ao,be[$o.scheme]=$o,be[ko.scheme]=ko,a.SCHEMES=be,a.pctEncChar=Re,a.pctDecChars=Ne,a.parse=ie,a.removeDotSegments=Ge,a.serialize=qe,a.resolveComponents=je,a.resolve=ct,a.normalize=Be,a.equal=ka,a.escapeComponent=Fs,a.unescapeComponent=st,Object.defineProperty(a,"__esModule",{value:!0})}))});var Xa=M((py,mi)=>{"use strict";mi.exports=function a(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var s,t,n;if(Array.isArray(e)){if(s=e.length,s!=r.length)return!1;for(t=s;t--!==0;)if(!a(e[t],r[t]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(n=Object.keys(e),s=n.length,s!==Object.keys(r).length)return!1;for(t=s;t--!==0;)if(!Object.prototype.hasOwnProperty.call(r,n[t]))return!1;for(t=s;t--!==0;){var o=n[t];if(!a(e[o],r[o]))return!1}return!0}return e!==e&&r!==r}});var gi=M((my,vi)=>{"use strict";vi.exports=function(e){for(var r=0,s=e.length,t=0,n;t<s;)r++,n=e.charCodeAt(t++),n>=55296&&n<=56319&&t<s&&(n=e.charCodeAt(t),(n&64512)==56320&&t++);return r}});var mr=M((vy,bi)=>{"use strict";bi.exports={copy:zf,checkDataType:hn,checkDataTypes:Vf,coerceToTypes:Hf,toHash:pn,getProperty:mn,escapeQuotes:vn,equal:Xa(),ucs2length:gi(),varOccurences:Jf,varReplace:Qf,schemaHasRules:Wf,schemaHasRulesExcept:Gf,schemaUnknownRules:Kf,toQuotedString:fn,getPathExpr:Yf,getPath:Xf,getData:rp,unescapeFragment:ap,unescapeJsonPointer:yn,escapeFragment:sp,escapeJsonPointer:gn};function zf(a,e){e=e||{};for(var r in a)e[r]=a[r];return e}function hn(a,e,r,s){var t=s?" !== ":" === ",n=s?" || ":" && ",o=s?"!":"",i=s?"":"!";switch(a){case"null":return e+t+"null";case"array":return o+"Array.isArray("+e+")";case"object":return"("+o+e+n+"typeof "+e+t+'"object"'+n+i+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+t+'"number"'+n+i+"("+e+" % 1)"+n+e+t+e+(r?n+o+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+t+'"'+a+'"'+(r?n+o+"isFinite("+e+")":"")+")";default:return"typeof "+e+t+'"'+a+'"'}}function Vf(a,e,r){switch(a.length){case 1:return hn(a[0],e,r,!0);default:var s="",t=pn(a);t.array&&t.object&&(s=t.null?"(":"(!"+e+" || ",s+="typeof "+e+' !== "object")',delete t.null,delete t.array,delete t.object),t.number&&delete t.integer;for(var n in t)s+=(s?" && ":"")+hn(n,e,r,!0);return s}}var yi=pn(["string","number","integer","boolean","null"]);function Hf(a,e){if(Array.isArray(e)){for(var r=[],s=0;s<e.length;s++){var t=e[s];(yi[t]||a==="array"&&t==="array")&&(r[r.length]=t)}if(r.length)return r}else{if(yi[e])return[e];if(a==="array"&&e==="array")return["array"]}}function pn(a){for(var e={},r=0;r<a.length;r++)e[a[r]]=!0;return e}var Zf=/^[a-z$_][a-z$_0-9]*$/i,Bf=/'|\\/g;function mn(a){return typeof a=="number"?"["+a+"]":Zf.test(a)?"."+a:"['"+vn(a)+"']"}function vn(a){return a.replace(Bf,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function Jf(a,e){e+="[^0-9]";var r=a.match(new RegExp(e,"g"));return r?r.length:0}function Qf(a,e,r){return e+="([^0-9])",r=r.replace(/\$/g,"$$$$"),a.replace(new RegExp(e,"g"),r+"$1")}function Wf(a,e){if(typeof a=="boolean")return!a;for(var r in a)if(e[r])return!0}function Gf(a,e,r){if(typeof a=="boolean")return!a&&r!="not";for(var s in a)if(s!=r&&e[s])return!0}function Kf(a,e){if(typeof a!="boolean"){for(var r in a)if(!e[r])return r}}function fn(a){return"'"+vn(a)+"'"}function Yf(a,e,r,s){var t=r?"'/' + "+e+(s?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):s?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return _i(a,t)}function Xf(a,e,r){var s=fn(r?"/"+gn(e):mn(e));return _i(a,s)}var ep=/^\/(?:[^~]|~0|~1)*$/,tp=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function rp(a,e,r){var s,t,n,o;if(a==="")return"rootData";if(a[0]=="/"){if(!ep.test(a))throw new Error("Invalid JSON-pointer: "+a);t=a,n="rootData"}else{if(o=a.match(tp),!o)throw new Error("Invalid JSON-pointer: "+a);if(s=+o[1],t=o[2],t=="#"){if(s>=e)throw new Error("Cannot access property/index "+s+" levels up, current level is "+e);return r[e-s]}if(s>e)throw new Error("Cannot access data "+s+" levels up, current level is "+e);if(n="data"+(e-s||""),!t)return n}for(var i=n,u=t.split("/"),c=0;c<u.length;c++){var h=u[c];h&&(n+=mn(yn(h)),i+=" && "+n)}return i}function _i(a,e){return a=='""'?e:(a+" + "+e).replace(/([^\\])' \+ '/g,"$1")}function ap(a){return yn(decodeURIComponent(a))}function sp(a){return encodeURIComponent(gn(a))}function gn(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}function yn(a){return a.replace(/~1/g,"/").replace(/~0/g,"~")}});var _n=M((gy,wi)=>{"use strict";var np=mr();wi.exports=op;function op(a){np.copy(a,this)}});var Ei=M((yy,xi)=>{"use strict";var Lt=xi.exports=function(a,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var s=typeof r=="function"?r:r.pre||function(){},t=r.post||function(){};es(e,s,t,a,"",a)};Lt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0};Lt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Lt.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Lt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function es(a,e,r,s,t,n,o,i,u,c){if(s&&typeof s=="object"&&!Array.isArray(s)){e(s,t,n,o,i,u,c);for(var h in s){var f=s[h];if(Array.isArray(f)){if(h in Lt.arrayKeywords)for(var v=0;v<f.length;v++)es(a,e,r,f[v],t+"/"+h+"/"+v,n,t,h,s,v)}else if(h in Lt.propsKeywords){if(f&&typeof f=="object")for(var d in f)es(a,e,r,f[d],t+"/"+h+"/"+ip(d),n,t,h,s,d)}else(h in Lt.keywords||a.allKeys&&!(h in Lt.skipKeywords))&&es(a,e,r,f,t+"/"+h,n,t,h,s)}r(s,t,n,o,i,u,c)}}function ip(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}});var os=M((_y,Oi)=>{"use strict";var ua=pi(),Pi=Xa(),ss=mr(),ts=_n(),lp=Ei();Oi.exports=qt;qt.normalizeId=Ft;qt.fullPath=rs;qt.url=as;qt.ids=fp;qt.inlineRef=bn;qt.schema=ns;function qt(a,e,r){var s=this._refs[r];if(typeof s=="string")if(this._refs[s])s=this._refs[s];else return qt.call(this,a,e,s);if(s=s||this._schemas[r],s instanceof ts)return bn(s.schema,this._opts.inlineRefs)?s.schema:s.validate||this._compile(s);var t=ns.call(this,e,r),n,o,i;return t&&(n=t.schema,e=t.root,i=t.baseId),n instanceof ts?o=n.validate||a.call(this,n.schema,e,void 0,i):n!==void 0&&(o=bn(n,this._opts.inlineRefs)?n:a.call(this,n,e,void 0,i)),o}function ns(a,e){var r=ua.parse(e),s=Ri(r),t=rs(this._getId(a.schema));if(Object.keys(a.schema).length===0||s!==t){var n=Ft(s),o=this._refs[n];if(typeof o=="string")return cp.call(this,a,o,r);if(o instanceof ts)o.validate||this._compile(o),a=o;else if(o=this._schemas[n],o instanceof ts){if(o.validate||this._compile(o),n==Ft(e))return{schema:o,root:a,baseId:t};a=o}else return;if(!a.schema)return;t=rs(this._getId(a.schema))}return Si.call(this,r,t,a.schema,a)}function cp(a,e,r){var s=ns.call(this,a,e);if(s){var t=s.schema,n=s.baseId;a=s.root;var o=this._getId(t);return o&&(n=as(n,o)),Si.call(this,r,n,t,a)}}var up=ss.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function Si(a,e,r,s){if(a.fragment=a.fragment||"",a.fragment.slice(0,1)=="/"){for(var t=a.fragment.split("/"),n=1;n<t.length;n++){var o=t[n];if(o){if(o=ss.unescapeFragment(o),r=r[o],r===void 0)break;var i;if(!up[o]&&(i=this._getId(r),i&&(e=as(e,i)),r.$ref)){var u=as(e,r.$ref),c=ns.call(this,s,u);c&&(r=c.schema,s=c.root,e=c.baseId)}}}if(r!==void 0&&r!==s.schema)return{schema:r,root:s,baseId:e}}}var dp=ss.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function bn(a,e){if(e===!1)return!1;if(e===void 0||e===!0)return wn(a);if(e)return xn(a)<=e}function wn(a){var e;if(Array.isArray(a)){for(var r=0;r<a.length;r++)if(e=a[r],typeof e=="object"&&!wn(e))return!1}else for(var s in a)if(s=="$ref"||(e=a[s],typeof e=="object"&&!wn(e)))return!1;return!0}function xn(a){var e=0,r;if(Array.isArray(a)){for(var s=0;s<a.length;s++)if(r=a[s],typeof r=="object"&&(e+=xn(r)),e==1/0)return 1/0}else for(var t in a){if(t=="$ref")return 1/0;if(dp[t])e++;else if(r=a[t],typeof r=="object"&&(e+=xn(r)+1),e==1/0)return 1/0}return e}function rs(a,e){e!==!1&&(a=Ft(a));var r=ua.parse(a);return Ri(r)}function Ri(a){return ua.serialize(a).split("#")[0]+"#"}var hp=/#\/?$/;function Ft(a){return a?a.replace(hp,""):""}function as(a,e){return e=Ft(e),ua.resolve(a,e)}function fp(a){var e=Ft(this._getId(a)),r={"":e},s={"":rs(e,!1)},t={},n=this;return lp(a,{allKeys:!0},function(o,i,u,c,h,f,v){if(i!==""){var d=n._getId(o),y=r[c],m=s[c]+"/"+h;if(v!==void 0&&(m+="/"+(typeof v=="number"?v:ss.escapeFragment(v))),typeof d=="string"){d=y=Ft(y?ua.resolve(y,d):d);var g=n._refs[d];if(typeof g=="string"&&(g=n._refs[g]),g&&g.schema){if(!Pi(o,g.schema))throw new Error('id "'+d+'" resolves to more than one schema')}else if(d!=Ft(m))if(d[0]=="#"){if(t[d]&&!Pi(o,t[d]))throw new Error('id "'+d+'" resolves to more than one schema');t[d]=o}else n._refs[d]=m}r[i]=y,s[i]=m}}),t}});var is=M((by,Ci)=>{"use strict";var En=os();Ci.exports={Validation:Ti(pp),MissingRef:Ti(Pn)};function pp(a){this.message="validation failed",this.errors=a,this.ajv=this.validation=!0}Pn.message=function(a,e){return"can't resolve reference "+e+" from id "+a};function Pn(a,e,r){this.message=r||Pn.message(a,e),this.missingRef=En.url(a,e),this.missingSchema=En.normalizeId(En.fullPath(this.missingRef))}function Ti(a){return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a}});var Sn=M((wy,Ii)=>{"use strict";Ii.exports=function(a,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=typeof e.cycles=="boolean"?e.cycles:!1,s=e.cmp&&(function(n){return function(o){return function(i,u){var c={key:i,value:o[i]},h={key:u,value:o[u]};return n(c,h)}}})(e.cmp),t=[];return(function n(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var i,u;if(Array.isArray(o)){for(u="[",i=0;i<o.length;i++)i&&(u+=","),u+=n(o[i])||"null";return u+"]"}if(o===null)return"null";if(t.indexOf(o)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var c=t.push(o)-1,h=Object.keys(o).sort(s&&s(o));for(u="",i=0;i<h.length;i++){var f=h[i],v=n(o[f]);v&&(u&&(u+=","),u+=JSON.stringify(f)+":"+v)}return t.splice(c,1),"{"+u+"}"}})(a)}});var Rn=M((xy,Ai)=>{"use strict";Ai.exports=function(e,r,s){var t="",n=e.schema.$async===!0,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),i=e.self._getId(e.schema);if(e.opts.strictKeywords){var u=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(u){var c="unknown keyword: "+u;if(e.opts.strictKeywords==="log")e.logger.warn(c);else throw new Error(c)}}if(e.isTop&&(t+=" var validate = ",n&&(e.async=!0,t+="async "),t+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",i&&(e.opts.sourceCode||e.opts.processCode)&&(t+=" "+("/*# sourceURL="+i+" */")+" ")),typeof e.schema=="boolean"||!(o||e.schema.$ref)){var r="false schema",h=e.level,f=e.dataLevel,v=e.schema[r],d=e.schemaPath+e.util.getProperty(r),y=e.errSchemaPath+"/"+r,O=!e.opts.allErrors,z,m="data"+(f||""),R="valid"+h;if(e.schema===!1){e.isTop?O=!0:t+=" var "+R+" = false; ";var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(z||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(y)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'boolean schema is false' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),t+=" } "):t+=" {} ";var w=t;t=g.pop(),!e.compositeRule&&O?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n?t+=" return data; ":t+=" validate.errors = null; return true; ":t+=" var "+R+" = true; ";return e.isTop&&(t+=" }; return validate; "),t}if(e.isTop){var S=e.isTop,h=e.level=0,f=e.dataLevel=0,m="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var P="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(P);else throw new Error(P)}t+=" var vErrors = null; ",t+=" var errors = 0;     ",t+=" if (rootData === undefined) rootData = data; "}else{var h=e.level,f=e.dataLevel,m="data"+(f||"");if(i&&(e.baseId=e.resolve.url(e.baseId,i)),n&&!e.async)throw new Error("async schema in sync schema");t+=" var errs_"+h+" = errors;"}var R="valid"+h,O=!e.opts.allErrors,A="",U="",z,$=e.schema.type,V=Array.isArray($);if($&&e.opts.nullable&&e.schema.nullable===!0&&(V?$.indexOf("null")==-1&&($=$.concat("null")):$!="null"&&($=[$,"null"],V=!0)),V&&$.length==1&&($=$[0],V=!1),e.schema.$ref&&o){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(o=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(t+=" "+e.RULES.all.$comment.code(e,"$comment")),$){if(e.opts.coerceTypes)var q=e.util.coerceToTypes(e.opts.coerceTypes,$);var L=e.RULES.types[$];if(q||V||L===!0||L&&!Te(L)){var d=e.schemaPath+".type",y=e.errSchemaPath+"/type",d=e.schemaPath+".type",y=e.errSchemaPath+"/type",I=V?"checkDataTypes":"checkDataType";if(t+=" if ("+e.util[I]($,m,e.opts.strictNumbers,!0)+") { ",q){var k="dataType"+h,F="coerced"+h;t+=" var "+k+" = typeof "+m+"; var "+F+" = undefined; ",e.opts.coerceTypes=="array"&&(t+=" if ("+k+" == 'object' && Array.isArray("+m+") && "+m+".length == 1) { "+m+" = "+m+"[0]; "+k+" = typeof "+m+"; if ("+e.util.checkDataType(e.schema.type,m,e.opts.strictNumbers)+") "+F+" = "+m+"; } "),t+=" if ("+F+" !== undefined) ; ";var ce=q;if(ce)for(var Y,re=-1,K=ce.length-1;re<K;)Y=ce[re+=1],Y=="string"?t+=" else if ("+k+" == 'number' || "+k+" == 'boolean') "+F+" = '' + "+m+"; else if ("+m+" === null) "+F+" = ''; ":Y=="number"||Y=="integer"?(t+=" else if ("+k+" == 'boolean' || "+m+" === null || ("+k+" == 'string' && "+m+" && "+m+" == +"+m+" ",Y=="integer"&&(t+=" && !("+m+" % 1)"),t+=")) "+F+" = +"+m+"; "):Y=="boolean"?t+=" else if ("+m+" === 'false' || "+m+" === 0 || "+m+" === null) "+F+" = false; else if ("+m+" === 'true' || "+m+" === 1) "+F+" = true; ":Y=="null"?t+=" else if ("+m+" === '' || "+m+" === 0 || "+m+" === false) "+F+" = null; ":e.opts.coerceTypes=="array"&&Y=="array"&&(t+=" else if ("+k+" == 'string' || "+k+" == 'number' || "+k+" == 'boolean' || "+m+" == null) "+F+" = ["+m+"]; ");t+=" else {   ";var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(z||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(y)+" , params: { type: '",V?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",V?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),t+=" } "):t+=" {} ";var w=t;t=g.pop(),!e.compositeRule&&O?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } if ("+F+" !== undefined) {  ";var Z=f?"data"+(f-1||""):"parentData",ge=f?e.dataPathArr[f]:"parentDataProperty";t+=" "+m+" = "+F+"; ",f||(t+="if ("+Z+" !== undefined)"),t+=" "+Z+"["+ge+"] = "+F+"; } "}else{var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(z||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(y)+" , params: { type: '",V?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",V?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),t+=" } "):t+=" {} ";var w=t;t=g.pop(),!e.compositeRule&&O?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}t+=" } "}}if(e.schema.$ref&&!o)t+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",O&&(t+=" } if (errors === ",S?t+="0":t+="errs_"+h,t+=") { ",U+="}");else{var Ie=e.RULES;if(Ie){for(var L,De=-1,ne=Ie.length-1;De<ne;)if(L=Ie[De+=1],Te(L)){if(L.type&&(t+=" if ("+e.util.checkDataType(L.type,m,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(L.type=="object"&&e.schema.properties){var v=e.schema.properties,be=Object.keys(v),Re=be;if(Re)for(var Ne,At=-1,yt=Re.length-1;At<yt;){Ne=Re[At+=1];var we=v[Ne];if(we.default!==void 0){var ye=m+e.util.getProperty(Ne);if(e.compositeRule){if(e.opts.strictDefaults){var P="default is ignored for: "+ye;if(e.opts.strictDefaults==="log")e.logger.warn(P);else throw new Error(P)}}else t+=" if ("+ye+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+ye+" === null || "+ye+" === '' "),t+=" ) "+ye+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(we.default)+" ":t+=" "+JSON.stringify(we.default)+" ",t+="; "}}}else if(L.type=="array"&&Array.isArray(e.schema.items)){var Zt=e.schema.items;if(Zt){for(var we,re=-1,Ae=Zt.length-1;re<Ae;)if(we=Zt[re+=1],we.default!==void 0){var ye=m+"["+re+"]";if(e.compositeRule){if(e.opts.strictDefaults){var P="default is ignored for: "+ye;if(e.opts.strictDefaults==="log")e.logger.warn(P);else throw new Error(P)}}else t+=" if ("+ye+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+ye+" === null || "+ye+" === '' "),t+=" ) "+ye+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(we.default)+" ":t+=" "+JSON.stringify(we.default)+" ",t+="; "}}}}var ie=L.rules;if(ie){for(var $t,_t=-1,Bt=ie.length-1;_t<Bt;)if($t=ie[_t+=1],Ge($t)){var Jt=$t.code(e,$t.keyword,L.type);Jt&&(t+=" "+Jt+" ",O&&(A+="}"))}}if(O&&(t+=" "+A+" ",A=""),L.type&&(t+=" } ",$&&$===L.type&&!q)){t+=" else { ";var d=e.schemaPath+".type",y=e.errSchemaPath+"/type",g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(z||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(y)+" , params: { type: '",V?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",V?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),t+=" } "):t+=" {} ";var w=t;t=g.pop(),!e.compositeRule&&O?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } "}O&&(t+=" if (errors === ",S?t+="0":t+="errs_"+h,t+=") { ",U+="}")}}}O&&(t+=" "+U+" "),S?(n?(t+=" if (errors === 0) return data;           ",t+=" else throw new ValidationError(vErrors); "):(t+=" validate.errors = vErrors; ",t+=" return errors === 0;       "),t+=" }; return validate;"):t+=" var "+R+" = errors === errs_"+h+";";function Te(je){for(var ct=je.rules,Be=0;Be<ct.length;Be++)if(Ge(ct[Be]))return!0}function Ge(je){return e.schema[je.keyword]!==void 0||je.implements&&qe(je)}function qe(je){for(var ct=je.implements,Be=0;Be<ct.length;Be++)if(e.schema[ct[Be]]!==void 0)return!0}return t}});var ji=M((Ey,Ni)=>{"use strict";var ls=os(),us=mr(),ki=is(),mp=Sn(),$i=Rn(),vp=us.ucs2length,gp=Xa(),yp=ki.Validation;Ni.exports=On;function On(a,e,r,s){var t=this,n=this._opts,o=[void 0],i={},u=[],c={},h=[],f={},v=[];e=e||{schema:a,refVal:o,refs:i};var d=_p.call(this,a,e,s),y=this._compilations[d.index];if(d.compiling)return y.callValidate=P;var m=this._formats,g=this.RULES;try{var w=R(a,e,r,s);y.validate=w;var S=y.callValidate;return S&&(S.schema=w.schema,S.errors=null,S.refs=w.refs,S.refVal=w.refVal,S.root=w.root,S.$async=w.$async,n.sourceCode&&(S.source=w.source)),w}finally{bp.call(this,a,e,s)}function P(){var I=y.validate,k=I.apply(this,arguments);return P.errors=I.errors,k}function R(I,k,F,ce){var Y=!k||k&&k.schema==I;if(k.schema!=e.schema)return On.call(t,I,k,F,ce);var re=I.$async===!0,K=$i({isTop:!0,schema:I,isRoot:Y,baseId:ce,root:k,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:ki.MissingRef,RULES:g,validate:$i,util:us,resolve:ls,resolveRef:O,usePattern:V,useDefault:q,useCustomRule:L,opts:n,formats:m,logger:t.logger,self:t});K=cs(o,Ep)+cs(u,wp)+cs(h,xp)+cs(v,Pp)+K,n.processCode&&(K=n.processCode(K,I));var Z;try{var ge=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",K);Z=ge(t,g,m,e,o,h,v,gp,vp,yp),o[0]=Z}catch(Ie){throw t.logger.error("Error compiling schema, function code:",K),Ie}return Z.schema=I,Z.errors=null,Z.refs=i,Z.refVal=o,Z.root=Y?Z:k,re&&(Z.$async=!0),n.sourceCode===!0&&(Z.source={code:K,patterns:u,defaults:h}),Z}function O(I,k,F){k=ls.url(I,k);var ce=i[k],Y,re;if(ce!==void 0)return Y=o[ce],re="refVal["+ce+"]",$(Y,re);if(!F&&e.refs){var K=e.refs[k];if(K!==void 0)return Y=e.refVal[K],re=A(k,Y),$(Y,re)}re=A(k);var Z=ls.call(t,R,e,k);if(Z===void 0){var ge=r&&r[k];ge&&(Z=ls.inlineRef(ge,n.inlineRefs)?ge:On.call(t,ge,e,r,I))}if(Z===void 0)U(k);else return z(k,Z),$(Z,re)}function A(I,k){var F=o.length;return o[F]=k,i[I]=F,"refVal"+F}function U(I){delete i[I]}function z(I,k){var F=i[I];o[F]=k}function $(I,k){return typeof I=="object"||typeof I=="boolean"?{code:k,schema:I,inline:!0}:{code:k,$async:I&&!!I.$async}}function V(I){var k=c[I];return k===void 0&&(k=c[I]=u.length,u[k]=I),"pattern"+k}function q(I){switch(typeof I){case"boolean":case"number":return""+I;case"string":return us.toQuotedString(I);case"object":if(I===null)return"null";var k=mp(I),F=f[k];return F===void 0&&(F=f[k]=h.length,h[F]=I),"default"+F}}function L(I,k,F,ce){if(t._opts.validateSchema!==!1){var Y=I.definition.dependencies;if(Y&&!Y.every(function(Re){return Object.prototype.hasOwnProperty.call(F,Re)}))throw new Error("parent schema must have all required keywords: "+Y.join(","));var re=I.definition.validateSchema;if(re){var K=re(k);if(!K){var Z="keyword schema is invalid: "+t.errorsText(re.errors);if(t._opts.validateSchema=="log")t.logger.error(Z);else throw new Error(Z)}}}var ge=I.definition.compile,Ie=I.definition.inline,De=I.definition.macro,ne;if(ge)ne=ge.call(t,k,F,ce);else if(De)ne=De.call(t,k,F,ce),n.validateSchema!==!1&&t.validateSchema(ne,!0);else if(Ie)ne=Ie.call(t,ce,I.keyword,k,F);else if(ne=I.definition.validate,!ne)return;if(ne===void 0)throw new Error('custom keyword "'+I.keyword+'"failed to compile');var be=v.length;return v[be]=ne,{code:"customRule"+be,validate:ne}}}function _p(a,e,r){var s=Di.call(this,a,e,r);return s>=0?{index:s,compiling:!0}:(s=this._compilations.length,this._compilations[s]={schema:a,root:e,baseId:r},{index:s,compiling:!1})}function bp(a,e,r){var s=Di.call(this,a,e,r);s>=0&&this._compilations.splice(s,1)}function Di(a,e,r){for(var s=0;s<this._compilations.length;s++){var t=this._compilations[s];if(t.schema==a&&t.root==e&&t.baseId==r)return s}return-1}function wp(a,e){return"var pattern"+a+" = new RegExp("+us.toQuotedString(e[a])+");"}function xp(a){return"var default"+a+" = defaults["+a+"];"}function Ep(a,e){return e[a]===void 0?"":"var refVal"+a+" = refVal["+a+"];"}function Pp(a){return"var customRule"+a+" = customRules["+a+"];"}function cs(a,e){if(!a.length)return"";for(var r="",s=0;s<a.length;s++)r+=e(s,a);return r}});var Li=M((Py,Mi)=>{"use strict";var ds=Mi.exports=function(){this._cache={}};ds.prototype.put=function(e,r){this._cache[e]=r};ds.prototype.get=function(e){return this._cache[e]};ds.prototype.del=function(e){delete this._cache[e]};ds.prototype.clear=function(){this._cache={}}});var Gi=M((Sy,Wi)=>{"use strict";var Sp=mr(),Rp=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Op=[0,31,28,31,30,31,30,31,31,30,31,30,31],Tp=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,Fi=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,Cp=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Ip=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,qi=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,Ui=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,zi=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,Vi=/^(?:\/(?:[^~/]|~0|~1)*)*$/,Hi=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,Zi=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;Wi.exports=hs;function hs(a){return a=a=="full"?"full":"fast",Sp.copy(hs[a])}hs.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":qi,url:Ui,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:Fi,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:Qi,uuid:zi,"json-pointer":Vi,"json-pointer-uri-fragment":Hi,"relative-json-pointer":Zi};hs.full={date:Bi,time:Ji,"date-time":kp,uri:Np,"uri-reference":Ip,"uri-template":qi,url:Ui,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:Fi,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:Qi,uuid:zi,"json-pointer":Vi,"json-pointer-uri-fragment":Hi,"relative-json-pointer":Zi};function Ap(a){return a%4===0&&(a%100!==0||a%400===0)}function Bi(a){var e=a.match(Rp);if(!e)return!1;var r=+e[1],s=+e[2],t=+e[3];return s>=1&&s<=12&&t>=1&&t<=(s==2&&Ap(r)?29:Op[s])}function Ji(a,e){var r=a.match(Tp);if(!r)return!1;var s=r[1],t=r[2],n=r[3],o=r[5];return(s<=23&&t<=59&&n<=59||s==23&&t==59&&n==60)&&(!e||o)}var $p=/t|\s/i;function kp(a){var e=a.split($p);return e.length==2&&Bi(e[0])&&Ji(e[1],!0)}var Dp=/\/|:/;function Np(a){return Dp.test(a)&&Cp.test(a)}var jp=/[^\\]\\Z/;function Qi(a){if(jp.test(a))return!1;try{return new RegExp(a),!0}catch{return!1}}});var Yi=M((Ry,Ki)=>{"use strict";Ki.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.errSchemaPath+"/"+r,c=!e.opts.allErrors,h="data"+(o||""),f="valid"+n,v,d;if(i=="#"||i=="#/")e.isRoot?(v=e.async,d="validate"):(v=e.root.schema.$async===!0,d="root.refVal[0]");else{var y=e.resolveRef(e.baseId,i,e.isRoot);if(y===void 0){var m=e.MissingRefError.message(e.baseId,i);if(e.opts.missingRefs=="fail"){e.logger.error(m);var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { ref: '"+e.util.escapeQuotes(i)+"' } ",e.opts.messages!==!1&&(t+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(i)+"' "),e.opts.verbose&&(t+=" , schema: "+e.util.toQuotedString(i)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var w=t;t=g.pop(),!e.compositeRule&&c?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(t+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(m),c&&(t+=" if (true) { ");else throw new e.MissingRefError(e.baseId,i,m)}else if(y.inline){var S=e.util.copy(e);S.level++;var P="valid"+S.level;S.schema=y.schema,S.schemaPath="",S.errSchemaPath=i;var R=e.validate(S).replace(/validate\.schema/g,y.code);t+=" "+R+" ",c&&(t+=" if ("+P+") { ")}else v=y.$async===!0||e.async&&y.$async!==!1,d=y.code}if(d){var g=g||[];g.push(t),t="",e.opts.passContext?t+=" "+d+".call(this, ":t+=" "+d+"( ",t+=" "+h+", (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var O=o?"data"+(o-1||""):"parentData",A=o?e.dataPathArr[o]:"parentDataProperty";t+=" , "+O+" , "+A+", rootData)  ";var U=t;if(t=g.pop(),v){if(!e.async)throw new Error("async schema referenced by sync schema");c&&(t+=" var "+f+"; "),t+=" try { await "+U+"; ",c&&(t+=" "+f+" = true; "),t+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",c&&(t+=" "+f+" = false; "),t+=" } ",c&&(t+=" if ("+f+") { ")}else t+=" if (!"+U+") { if (vErrors === null) vErrors = "+d+".errors; else vErrors = vErrors.concat("+d+".errors); errors = vErrors.length; } ",c&&(t+=" else { ")}return t}});var el=M((Oy,Xi)=>{"use strict";Xi.exports=function(e,r,s){var t=" ",n=e.schema[r],o=e.schemaPath+e.util.getProperty(r),i=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,c=e.util.copy(e),h="";c.level++;var f="valid"+c.level,v=c.baseId,d=!0,y=n;if(y)for(var m,g=-1,w=y.length-1;g<w;)m=y[g+=1],(e.opts.strictKeywords?typeof m=="object"&&Object.keys(m).length>0||m===!1:e.util.schemaHasRules(m,e.RULES.all))&&(d=!1,c.schema=m,c.schemaPath=o+"["+g+"]",c.errSchemaPath=i+"/"+g,t+="  "+e.validate(c)+" ",c.baseId=v,u&&(t+=" if ("+f+") { ",h+="}"));return u&&(d?t+=" if (true) { ":t+=" "+h.slice(0,-1)+" "),t}});var rl=M((Ty,tl)=>{"use strict";tl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d="errs__"+n,y=e.util.copy(e),m="";y.level++;var g="valid"+y.level,w=i.every(function(z){return e.opts.strictKeywords?typeof z=="object"&&Object.keys(z).length>0||z===!1:e.util.schemaHasRules(z,e.RULES.all)});if(w){var S=y.baseId;t+=" var "+d+" = errors; var "+v+" = false;  ";var P=e.compositeRule;e.compositeRule=y.compositeRule=!0;var R=i;if(R)for(var O,A=-1,U=R.length-1;A<U;)O=R[A+=1],y.schema=O,y.schemaPath=u+"["+A+"]",y.errSchemaPath=c+"/"+A,t+="  "+e.validate(y)+" ",y.baseId=S,t+=" "+v+" = "+v+" || "+g+"; if (!"+v+") { ",m+="}";e.compositeRule=y.compositeRule=P,t+=" "+m+" if (!"+v+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else h&&(t+=" if (true) { ");return t}});var sl=M((Cy,al)=>{"use strict";al.exports=function(e,r,s){var t=" ",n=e.schema[r],o=e.errSchemaPath+"/"+r,i=!e.opts.allErrors,u=e.util.toQuotedString(n);return e.opts.$comment===!0?t+=" console.log("+u+");":typeof e.opts.$comment=="function"&&(t+=" self._opts.$comment("+u+", "+e.util.toQuotedString(o)+", validate.root.schema);"),t}});var ol=M((Iy,nl)=>{"use strict";nl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d=e.opts.$data&&i&&i.$data,y;d?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",y="schema"+n):y=i,d||(t+=" var schema"+n+" = validate.schema"+u+";"),t+="var "+v+" = equal("+f+", schema"+n+"); if (!"+v+") {   ";var m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValue: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to constant' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var g=t;return t=m.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+g+"]); ":t+=" validate.errors = ["+g+"]; return false; ":t+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",h&&(t+=" else { "),t}});var ll=M((Ay,il)=>{"use strict";il.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d="errs__"+n,y=e.util.copy(e),m="";y.level++;var g="valid"+y.level,w="i"+n,S=y.dataLevel=e.dataLevel+1,P="data"+S,R=e.baseId,O=e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all);if(t+="var "+d+" = errors;var "+v+";",O){var A=e.compositeRule;e.compositeRule=y.compositeRule=!0,y.schema=i,y.schemaPath=u,y.errSchemaPath=c,t+=" var "+g+" = false; for (var "+w+" = 0; "+w+" < "+f+".length; "+w+"++) { ",y.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var U=f+"["+w+"]";y.dataPathArr[S]=w;var z=e.validate(y);y.baseId=R,e.util.varOccurences(z,P)<2?t+=" "+e.util.varReplace(z,P,U)+" ":t+=" var "+P+" = "+U+"; "+z+" ",t+=" if ("+g+") break; }  ",e.compositeRule=y.compositeRule=A,t+=" "+m+" if (!"+g+") {"}else t+=" if ("+f+".length == 0) {";var $=$||[];$.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should contain a valid item' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var V=t;return t=$.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+V+"]); ":t+=" validate.errors = ["+V+"]; return false; ":t+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { ",O&&(t+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(t+=" } "),t}});var ul=M(($y,cl)=>{"use strict";cl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="errs__"+n,d=e.util.copy(e),y="";d.level++;var m="valid"+d.level,g={},w={},S=e.opts.ownProperties;for(A in i)if(A!="__proto__"){var P=i[A],R=Array.isArray(P)?w:g;R[A]=P}t+="var "+v+" = errors;";var O=e.errorPath;t+="var missing"+n+";";for(var A in w)if(R=w[A],R.length){if(t+=" if ( "+f+e.util.getProperty(A)+" !== undefined ",S&&(t+=" && Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(A)+"') "),h){t+=" && ( ";var U=R;if(U)for(var z,$=-1,V=U.length-1;$<V;){z=U[$+=1],$&&(t+=" || ");var q=e.util.getProperty(z),L=f+q;t+=" ( ( "+L+" === undefined ",S&&(t+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(z)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?z:q)+") ) "}t+=")) {  ";var I="missing"+n,k="' + "+I+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(O,I,!0):O+" + "+I);var F=F||[];F.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(A)+"', missingProperty: '"+k+"', depsCount: "+R.length+", deps: '"+e.util.escapeQuotes(R.length==1?R[0]:R.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",R.length==1?t+="property "+e.util.escapeQuotes(R[0]):t+="properties "+e.util.escapeQuotes(R.join(", ")),t+=" when property "+e.util.escapeQuotes(A)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var ce=t;t=F.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+ce+"]); ":t+=" validate.errors = ["+ce+"]; return false; ":t+=" var err = "+ce+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{t+=" ) { ";var Y=R;if(Y)for(var z,re=-1,K=Y.length-1;re<K;){z=Y[re+=1];var q=e.util.getProperty(z),k=e.util.escapeQuotes(z),L=f+q;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(O,z,e.opts.jsonPointers)),t+=" if ( "+L+" === undefined ",S&&(t+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(z)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(A)+"', missingProperty: '"+k+"', depsCount: "+R.length+", deps: '"+e.util.escapeQuotes(R.length==1?R[0]:R.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",R.length==1?t+="property "+e.util.escapeQuotes(R[0]):t+="properties "+e.util.escapeQuotes(R.join(", ")),t+=" when property "+e.util.escapeQuotes(A)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}t+=" }   ",h&&(y+="}",t+=" else { ")}e.errorPath=O;var Z=d.baseId;for(var A in g){var P=g[A];(e.opts.strictKeywords?typeof P=="object"&&Object.keys(P).length>0||P===!1:e.util.schemaHasRules(P,e.RULES.all))&&(t+=" "+m+" = true; if ( "+f+e.util.getProperty(A)+" !== undefined ",S&&(t+=" && Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(A)+"') "),t+=") { ",d.schema=P,d.schemaPath=u+e.util.getProperty(A),d.errSchemaPath=c+"/"+e.util.escapeFragment(A),t+="  "+e.validate(d)+" ",d.baseId=Z,t+=" }  ",h&&(t+=" if ("+m+") { ",y+="}"))}return h&&(t+="   "+y+" if ("+v+" == errors) {"),t}});var hl=M((ky,dl)=>{"use strict";dl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d=e.opts.$data&&i&&i.$data,y;d?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",y="schema"+n):y=i;var m="i"+n,g="schema"+n;d||(t+=" var "+g+" = validate.schema"+u+";"),t+="var "+v+";",d&&(t+=" if (schema"+n+" === undefined) "+v+" = true; else if (!Array.isArray(schema"+n+")) "+v+" = false; else {"),t+=""+v+" = false;for (var "+m+"=0; "+m+"<"+g+".length; "+m+"++) if (equal("+f+", "+g+"["+m+"])) { "+v+" = true; break; }",d&&(t+="  }  "),t+=" if (!"+v+") {   ";var w=w||[];w.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValues: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var S=t;return t=w.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+S+"]); ":t+=" validate.errors = ["+S+"]; return false; ":t+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",h&&(t+=" else { "),t}});var pl=M((Dy,fl)=>{"use strict";fl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||"");if(e.opts.format===!1)return h&&(t+=" if (true) { "),t;var v=e.opts.$data&&i&&i.$data,d;v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=i;var y=e.opts.unknownFormats,m=Array.isArray(y);if(v){var g="format"+n,w="isObject"+n,S="formatType"+n;t+=" var "+g+" = formats["+d+"]; var "+w+" = typeof "+g+" == 'object' && !("+g+" instanceof RegExp) && "+g+".validate; var "+S+" = "+w+" && "+g+".type || 'string'; if ("+w+") { ",e.async&&(t+=" var async"+n+" = "+g+".async; "),t+=" "+g+" = "+g+".validate; } if (  ",v&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),t+=" (",y!="ignore"&&(t+=" ("+d+" && !"+g+" ",m&&(t+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),t+=") || "),t+=" ("+g+" && "+S+" == '"+s+"' && !(typeof "+g+" == 'function' ? ",e.async?t+=" (async"+n+" ? await "+g+"("+f+") : "+g+"("+f+")) ":t+=" "+g+"("+f+") ",t+=" : "+g+".test("+f+"))))) {"}else{var g=e.formats[i];if(!g){if(y=="ignore")return e.logger.warn('unknown format "'+i+'" ignored in schema at path "'+e.errSchemaPath+'"'),h&&(t+=" if (true) { "),t;if(m&&y.indexOf(i)>=0)return h&&(t+=" if (true) { "),t;throw new Error('unknown format "'+i+'" is used in schema at path "'+e.errSchemaPath+'"')}var w=typeof g=="object"&&!(g instanceof RegExp)&&g.validate,S=w&&g.type||"string";if(w){var P=g.async===!0;g=g.validate}if(S!=s)return h&&(t+=" if (true) { "),t;if(P){if(!e.async)throw new Error("async format in sync schema");var R="formats"+e.util.getProperty(i)+".validate";t+=" if (!(await "+R+"("+f+"))) { "}else{t+=" if (! ";var R="formats"+e.util.getProperty(i);w&&(R+=".validate"),typeof g=="function"?t+=" "+R+"("+f+") ":t+=" "+R+".test("+f+") ",t+=") { "}}var O=O||[];O.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { format:  ",v?t+=""+d:t+=""+e.util.toQuotedString(i),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match format "`,v?t+="' + "+d+" + '":t+=""+e.util.escapeQuotes(i),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+u:t+=""+e.util.toQuotedString(i),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var A=t;return t=O.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+A+"]); ":t+=" validate.errors = ["+A+"]; return false; ":t+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { "),t}});var vl=M((Ny,ml)=>{"use strict";ml.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d="errs__"+n,y=e.util.copy(e);y.level++;var m="valid"+y.level,g=e.schema.then,w=e.schema.else,S=g!==void 0&&(e.opts.strictKeywords?typeof g=="object"&&Object.keys(g).length>0||g===!1:e.util.schemaHasRules(g,e.RULES.all)),P=w!==void 0&&(e.opts.strictKeywords?typeof w=="object"&&Object.keys(w).length>0||w===!1:e.util.schemaHasRules(w,e.RULES.all)),R=y.baseId;if(S||P){var O;y.createErrors=!1,y.schema=i,y.schemaPath=u,y.errSchemaPath=c,t+=" var "+d+" = errors; var "+v+" = true;  ";var A=e.compositeRule;e.compositeRule=y.compositeRule=!0,t+="  "+e.validate(y)+" ",y.baseId=R,y.createErrors=!0,t+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=y.compositeRule=A,S?(t+=" if ("+m+") {  ",y.schema=e.schema.then,y.schemaPath=e.schemaPath+".then",y.errSchemaPath=e.errSchemaPath+"/then",t+="  "+e.validate(y)+" ",y.baseId=R,t+=" "+v+" = "+m+"; ",S&&P?(O="ifClause"+n,t+=" var "+O+" = 'then'; "):O="'then'",t+=" } ",P&&(t+=" else { ")):t+=" if (!"+m+") { ",P&&(y.schema=e.schema.else,y.schemaPath=e.schemaPath+".else",y.errSchemaPath=e.errSchemaPath+"/else",t+="  "+e.validate(y)+" ",y.baseId=R,t+=" "+v+" = "+m+"; ",S&&P?(O="ifClause"+n,t+=" var "+O+" = 'else'; "):O="'else'",t+=" } "),t+=" if (!"+v+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { failingKeyword: "+O+" } ",e.opts.messages!==!1&&(t+=` , message: 'should match "' + `+O+` + '" schema' `),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" }   ",h&&(t+=" else { ")}else h&&(t+=" if (true) { ");return t}});var yl=M((jy,gl)=>{"use strict";gl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d="errs__"+n,y=e.util.copy(e),m="";y.level++;var g="valid"+y.level,w="i"+n,S=y.dataLevel=e.dataLevel+1,P="data"+S,R=e.baseId;if(t+="var "+d+" = errors;var "+v+";",Array.isArray(i)){var O=e.schema.additionalItems;if(O===!1){t+=" "+v+" = "+f+".length <= "+i.length+"; ";var A=c;c=e.errSchemaPath+"/additionalItems",t+="  if (!"+v+") {   ";var U=U||[];U.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+i.length+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have more than "+i.length+" items' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var z=t;t=U.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+z+"]); ":t+=" validate.errors = ["+z+"]; return false; ":t+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",c=A,h&&(m+="}",t+=" else { ")}var $=i;if($){for(var V,q=-1,L=$.length-1;q<L;)if(V=$[q+=1],e.opts.strictKeywords?typeof V=="object"&&Object.keys(V).length>0||V===!1:e.util.schemaHasRules(V,e.RULES.all)){t+=" "+g+" = true; if ("+f+".length > "+q+") { ";var I=f+"["+q+"]";y.schema=V,y.schemaPath=u+"["+q+"]",y.errSchemaPath=c+"/"+q,y.errorPath=e.util.getPathExpr(e.errorPath,q,e.opts.jsonPointers,!0),y.dataPathArr[S]=q;var k=e.validate(y);y.baseId=R,e.util.varOccurences(k,P)<2?t+=" "+e.util.varReplace(k,P,I)+" ":t+=" var "+P+" = "+I+"; "+k+" ",t+=" }  ",h&&(t+=" if ("+g+") { ",m+="}")}}if(typeof O=="object"&&(e.opts.strictKeywords?typeof O=="object"&&Object.keys(O).length>0||O===!1:e.util.schemaHasRules(O,e.RULES.all))){y.schema=O,y.schemaPath=e.schemaPath+".additionalItems",y.errSchemaPath=e.errSchemaPath+"/additionalItems",t+=" "+g+" = true; if ("+f+".length > "+i.length+") {  for (var "+w+" = "+i.length+"; "+w+" < "+f+".length; "+w+"++) { ",y.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var I=f+"["+w+"]";y.dataPathArr[S]=w;var k=e.validate(y);y.baseId=R,e.util.varOccurences(k,P)<2?t+=" "+e.util.varReplace(k,P,I)+" ":t+=" var "+P+" = "+I+"; "+k+" ",h&&(t+=" if (!"+g+") break; "),t+=" } }  ",h&&(t+=" if ("+g+") { ",m+="}")}}else if(e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){y.schema=i,y.schemaPath=u,y.errSchemaPath=c,t+="  for (var "+w+" = 0; "+w+" < "+f+".length; "+w+"++) { ",y.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var I=f+"["+w+"]";y.dataPathArr[S]=w;var k=e.validate(y);y.baseId=R,e.util.varOccurences(k,P)<2?t+=" "+e.util.varReplace(k,P,I)+" ":t+=" var "+P+" = "+I+"; "+k+" ",h&&(t+=" if (!"+g+") break; "),t+=" }"}return h&&(t+=" "+m+" if ("+d+" == errors) {"),t}});var Tn=M((My,_l)=>{"use strict";_l.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,R,f="data"+(o||""),v=e.opts.$data&&i&&i.$data,d;v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=i;var y=r=="maximum",m=y?"exclusiveMaximum":"exclusiveMinimum",g=e.schema[m],w=e.opts.$data&&g&&g.$data,S=y?"<":">",P=y?">":"<",R=void 0;if(!(v||typeof i=="number"||i===void 0))throw new Error(r+" must be number");if(!(w||g===void 0||typeof g=="number"||typeof g=="boolean"))throw new Error(m+" must be number or boolean");if(w){var O=e.util.getData(g.$data,o,e.dataPathArr),A="exclusive"+n,U="exclType"+n,z="exclIsNumber"+n,$="op"+n,V="' + "+$+" + '";t+=" var schemaExcl"+n+" = "+O+"; ",O="schemaExcl"+n,t+=" var "+A+"; var "+U+" = typeof "+O+"; if ("+U+" != 'boolean' && "+U+" != 'undefined' && "+U+" != 'number') { ";var R=m,q=q||[];q.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(R||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: '"+m+" should be boolean' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var L=t;t=q.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+L+"]); ":t+=" validate.errors = ["+L+"]; return false; ":t+=" var err = "+L+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else if ( ",v&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" "+U+" == 'number' ? ( ("+A+" = "+d+" === undefined || "+O+" "+S+"= "+d+") ? "+f+" "+P+"= "+O+" : "+f+" "+P+" "+d+" ) : ( ("+A+" = "+O+" === true) ? "+f+" "+P+"= "+d+" : "+f+" "+P+" "+d+" ) || "+f+" !== "+f+") { var op"+n+" = "+A+" ? '"+S+"' : '"+S+"='; ",i===void 0&&(R=m,c=e.errSchemaPath+"/"+m,d=O,v=w)}else{var z=typeof g=="number",V=S;if(z&&v){var $="'"+V+"'";t+=" if ( ",v&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" ( "+d+" === undefined || "+g+" "+S+"= "+d+" ? "+f+" "+P+"= "+g+" : "+f+" "+P+" "+d+" ) || "+f+" !== "+f+") { "}else{z&&i===void 0?(A=!0,R=m,c=e.errSchemaPath+"/"+m,d=g,P+="="):(z&&(d=Math[y?"min":"max"](g,i)),g===(z?d:!0)?(A=!0,R=m,c=e.errSchemaPath+"/"+m,P+="="):(A=!1,V+="="));var $="'"+V+"'";t+=" if ( ",v&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" "+f+" "+P+" "+d+" || "+f+" !== "+f+") { "}}R=R||r;var q=q||[];q.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(R||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+$+", limit: "+d+", exclusive: "+A+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be "+V+" ",v?t+="' + "+d:t+=""+d+"'"),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+u:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var L=t;return t=q.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+L+"]); ":t+=" validate.errors = ["+L+"]; return false; ":t+=" var err = "+L+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { "),t}});var Cn=M((Ly,bl)=>{"use strict";bl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,m,f="data"+(o||""),v=e.opts.$data&&i&&i.$data,d;if(v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=i,!(v||typeof i=="number"))throw new Error(r+" must be number");var y=r=="maxItems"?">":"<";t+="if ( ",v&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" "+f+".length "+y+" "+d+") { ";var m=r,g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(m||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxItems"?t+="more":t+="fewer",t+=" than ",v?t+="' + "+d+" + '":t+=""+i,t+=" items' "),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+u:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var w=t;return t=g.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}});var In=M((Fy,wl)=>{"use strict";wl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,m,f="data"+(o||""),v=e.opts.$data&&i&&i.$data,d;if(v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=i,!(v||typeof i=="number"))throw new Error(r+" must be number");var y=r=="maxLength"?">":"<";t+="if ( ",v&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),e.opts.unicode===!1?t+=" "+f+".length ":t+=" ucs2length("+f+") ",t+=" "+y+" "+d+") { ";var m=r,g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(m||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be ",r=="maxLength"?t+="longer":t+="shorter",t+=" than ",v?t+="' + "+d+" + '":t+=""+i,t+=" characters' "),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+u:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var w=t;return t=g.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}});var An=M((qy,xl)=>{"use strict";xl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,m,f="data"+(o||""),v=e.opts.$data&&i&&i.$data,d;if(v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=i,!(v||typeof i=="number"))throw new Error(r+" must be number");var y=r=="maxProperties"?">":"<";t+="if ( ",v&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),t+=" Object.keys("+f+").length "+y+" "+d+") { ";var m=r,g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(m||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxProperties"?t+="more":t+="fewer",t+=" than ",v?t+="' + "+d+" + '":t+=""+i,t+=" properties' "),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+u:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var w=t;return t=g.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}});var Pl=M((Uy,El)=>{"use strict";El.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v=e.opts.$data&&i&&i.$data,d;if(v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=i,!(v||typeof i=="number"))throw new Error(r+" must be number");t+="var division"+n+";if (",v&&(t+=" "+d+" !== undefined && ( typeof "+d+" != 'number' || "),t+=" (division"+n+" = "+f+" / "+d+", ",e.opts.multipleOfPrecision?t+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":t+=" division"+n+" !== parseInt(division"+n+") ",t+=" ) ",v&&(t+="  )  "),t+=" ) {   ";var y=y||[];y.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+d+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be multiple of ",v?t+="' + "+d:t+=""+d+"'"),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+u:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var m=t;return t=y.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+m+"]); ":t+=" validate.errors = ["+m+"]; return false; ":t+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}});var Rl=M((zy,Sl)=>{"use strict";Sl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="errs__"+n,d=e.util.copy(e);d.level++;var y="valid"+d.level;if(e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){d.schema=i,d.schemaPath=u,d.errSchemaPath=c,t+=" var "+v+" = errors;  ";var m=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1;var g;d.opts.allErrors&&(g=d.opts.allErrors,d.opts.allErrors=!1),t+=" "+e.validate(d)+" ",d.createErrors=!0,g&&(d.opts.allErrors=g),e.compositeRule=d.compositeRule=m,t+=" if ("+y+") {   ";var w=w||[];w.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var S=t;t=w.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+S+"]); ":t+=" validate.errors = ["+S+"]; return false; ":t+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else {  errors = "+v+"; if (vErrors !== null) { if ("+v+") vErrors.length = "+v+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else t+="  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",h&&(t+=" if (false) { ");return t}});var Tl=M((Vy,Ol)=>{"use strict";Ol.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d="errs__"+n,y=e.util.copy(e),m="";y.level++;var g="valid"+y.level,w=y.baseId,S="prevValid"+n,P="passingSchemas"+n;t+="var "+d+" = errors , "+S+" = false , "+v+" = false , "+P+" = null; ";var R=e.compositeRule;e.compositeRule=y.compositeRule=!0;var O=i;if(O)for(var A,U=-1,z=O.length-1;U<z;)A=O[U+=1],(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))?(y.schema=A,y.schemaPath=u+"["+U+"]",y.errSchemaPath=c+"/"+U,t+="  "+e.validate(y)+" ",y.baseId=w):t+=" var "+g+" = true; ",U&&(t+=" if ("+g+" && "+S+") { "+v+" = false; "+P+" = ["+P+", "+U+"]; } else { ",m+="}"),t+=" if ("+g+") { "+v+" = "+S+" = true; "+P+" = "+U+"; }";return e.compositeRule=y.compositeRule=R,t+=""+m+"if (!"+v+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { passingSchemas: "+P+" } ",e.opts.messages!==!1&&(t+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(t+=" } "),t}});var Il=M((Hy,Cl)=>{"use strict";Cl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v=e.opts.$data&&i&&i.$data,d;v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=i;var y=v?"(new RegExp("+d+"))":e.usePattern(i);t+="if ( ",v&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),t+=" !"+y+".test("+f+") ) {   ";var m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",v?t+=""+d:t+=""+e.util.toQuotedString(i),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match pattern "`,v?t+="' + "+d+" + '":t+=""+e.util.escapeQuotes(i),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+u:t+=""+e.util.toQuotedString(i),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var g=t;return t=m.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+g+"]); ":t+=" validate.errors = ["+g+"]; return false; ":t+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}});var $l=M((Zy,Al)=>{"use strict";Al.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="errs__"+n,d=e.util.copy(e),y="";d.level++;var m="valid"+d.level,g="key"+n,w="idx"+n,S=d.dataLevel=e.dataLevel+1,P="data"+S,R="dataProperties"+n,O=Object.keys(i||{}).filter(re),A=e.schema.patternProperties||{},U=Object.keys(A).filter(re),z=e.schema.additionalProperties,$=O.length||U.length,V=z===!1,q=typeof z=="object"&&Object.keys(z).length,L=e.opts.removeAdditional,I=V||q||L,k=e.opts.ownProperties,F=e.baseId,ce=e.schema.required;if(ce&&!(e.opts.$data&&ce.$data)&&ce.length<e.opts.loopRequired)var Y=e.util.toHash(ce);function re(st){return st!=="__proto__"}if(t+="var "+v+" = errors;var "+m+" = true;",k&&(t+=" var "+R+" = undefined;"),I){if(k?t+=" "+R+" = "+R+" || Object.keys("+f+"); for (var "+w+"=0; "+w+"<"+R+".length; "+w+"++) { var "+g+" = "+R+"["+w+"]; ":t+=" for (var "+g+" in "+f+") { ",$){if(t+=" var isAdditional"+n+" = !(false ",O.length)if(O.length>8)t+=" || validate.schema"+u+".hasOwnProperty("+g+") ";else{var K=O;if(K)for(var Z,ge=-1,Ie=K.length-1;ge<Ie;)Z=K[ge+=1],t+=" || "+g+" == "+e.util.toQuotedString(Z)+" "}if(U.length){var De=U;if(De)for(var ne,be=-1,Re=De.length-1;be<Re;)ne=De[be+=1],t+=" || "+e.usePattern(ne)+".test("+g+") "}t+=" ); if (isAdditional"+n+") { "}if(L=="all")t+=" delete "+f+"["+g+"]; ";else{var Ne=e.errorPath,At="' + "+g+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers)),V)if(L)t+=" delete "+f+"["+g+"]; ";else{t+=" "+m+" = false; ";var yt=c;c=e.errSchemaPath+"/additionalProperties";var we=we||[];we.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { additionalProperty: '"+At+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is an invalid additional property":t+="should NOT have additional properties",t+="' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var ye=t;t=we.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+ye+"]); ":t+=" validate.errors = ["+ye+"]; return false; ":t+=" var err = "+ye+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=yt,h&&(t+=" break; ")}else if(q)if(L=="failing"){t+=" var "+v+" = errors;  ";var Zt=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=z,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Ae=f+"["+g+"]";d.dataPathArr[S]=g;var ie=e.validate(d);d.baseId=F,e.util.varOccurences(ie,P)<2?t+=" "+e.util.varReplace(ie,P,Ae)+" ":t+=" var "+P+" = "+Ae+"; "+ie+" ",t+=" if (!"+m+") { errors = "+v+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+f+"["+g+"]; }  ",e.compositeRule=d.compositeRule=Zt}else{d.schema=z,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Ae=f+"["+g+"]";d.dataPathArr[S]=g;var ie=e.validate(d);d.baseId=F,e.util.varOccurences(ie,P)<2?t+=" "+e.util.varReplace(ie,P,Ae)+" ":t+=" var "+P+" = "+Ae+"; "+ie+" ",h&&(t+=" if (!"+m+") break; ")}e.errorPath=Ne}$&&(t+=" } "),t+=" }  ",h&&(t+=" if ("+m+") { ",y+="}")}var $t=e.opts.useDefaults&&!e.compositeRule;if(O.length){var _t=O;if(_t)for(var Z,Bt=-1,Jt=_t.length-1;Bt<Jt;){Z=_t[Bt+=1];var Te=i[Z];if(e.opts.strictKeywords?typeof Te=="object"&&Object.keys(Te).length>0||Te===!1:e.util.schemaHasRules(Te,e.RULES.all)){var Ge=e.util.getProperty(Z),Ae=f+Ge,qe=$t&&Te.default!==void 0;d.schema=Te,d.schemaPath=u+Ge,d.errSchemaPath=c+"/"+e.util.escapeFragment(Z),d.errorPath=e.util.getPath(e.errorPath,Z,e.opts.jsonPointers),d.dataPathArr[S]=e.util.toQuotedString(Z);var ie=e.validate(d);if(d.baseId=F,e.util.varOccurences(ie,P)<2){ie=e.util.varReplace(ie,P,Ae);var je=Ae}else{var je=P;t+=" var "+P+" = "+Ae+"; "}if(qe)t+=" "+ie+" ";else{if(Y&&Y[Z]){t+=" if ( "+je+" === undefined ",k&&(t+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(Z)+"') "),t+=") { "+m+" = false; ";var Ne=e.errorPath,yt=c,ct=e.util.escapeQuotes(Z);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(Ne,Z,e.opts.jsonPointers)),c=e.errSchemaPath+"/required";var we=we||[];we.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+ct+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+ct+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var ye=t;t=we.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+ye+"]); ":t+=" validate.errors = ["+ye+"]; return false; ":t+=" var err = "+ye+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=yt,e.errorPath=Ne,t+=" } else { "}else h?(t+=" if ( "+je+" === undefined ",k&&(t+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(Z)+"') "),t+=") { "+m+" = true; } else { "):(t+=" if ("+je+" !== undefined ",k&&(t+=" &&   Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(Z)+"') "),t+=" ) { ");t+=" "+ie+" } "}}h&&(t+=" if ("+m+") { ",y+="}")}}if(U.length){var Be=U;if(Be)for(var ne,ka=-1,Fs=Be.length-1;ka<Fs;){ne=Be[ka+=1];var Te=A[ne];if(e.opts.strictKeywords?typeof Te=="object"&&Object.keys(Te).length>0||Te===!1:e.util.schemaHasRules(Te,e.RULES.all)){d.schema=Te,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ne),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ne),k?t+=" "+R+" = "+R+" || Object.keys("+f+"); for (var "+w+"=0; "+w+"<"+R+".length; "+w+"++) { var "+g+" = "+R+"["+w+"]; ":t+=" for (var "+g+" in "+f+") { ",t+=" if ("+e.usePattern(ne)+".test("+g+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Ae=f+"["+g+"]";d.dataPathArr[S]=g;var ie=e.validate(d);d.baseId=F,e.util.varOccurences(ie,P)<2?t+=" "+e.util.varReplace(ie,P,Ae)+" ":t+=" var "+P+" = "+Ae+"; "+ie+" ",h&&(t+=" if (!"+m+") break; "),t+=" } ",h&&(t+=" else "+m+" = true; "),t+=" }  ",h&&(t+=" if ("+m+") { ",y+="}")}}}return h&&(t+=" "+y+" if ("+v+" == errors) {"),t}});var Dl=M((By,kl)=>{"use strict";kl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="errs__"+n,d=e.util.copy(e),y="";d.level++;var m="valid"+d.level;if(t+="var "+v+" = errors;",e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){d.schema=i,d.schemaPath=u,d.errSchemaPath=c;var g="key"+n,w="idx"+n,S="i"+n,P="' + "+g+" + '",R=d.dataLevel=e.dataLevel+1,O="data"+R,A="dataProperties"+n,U=e.opts.ownProperties,z=e.baseId;U&&(t+=" var "+A+" = undefined; "),U?t+=" "+A+" = "+A+" || Object.keys("+f+"); for (var "+w+"=0; "+w+"<"+A+".length; "+w+"++) { var "+g+" = "+A+"["+w+"]; ":t+=" for (var "+g+" in "+f+") { ",t+=" var startErrs"+n+" = errors; ";var $=g,V=e.compositeRule;e.compositeRule=d.compositeRule=!0;var q=e.validate(d);d.baseId=z,e.util.varOccurences(q,O)<2?t+=" "+e.util.varReplace(q,O,$)+" ":t+=" var "+O+" = "+$+"; "+q+" ",e.compositeRule=d.compositeRule=V,t+=" if (!"+m+") { for (var "+S+"=startErrs"+n+"; "+S+"<errors; "+S+"++) { vErrors["+S+"].propertyName = "+g+"; }   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { propertyName: '"+P+"' } ",e.opts.messages!==!1&&(t+=" , message: 'property name \\'"+P+"\\' is invalid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),h&&(t+=" break; "),t+=" } }"}return h&&(t+=" "+y+" if ("+v+" == errors) {"),t}});var jl=M((Jy,Nl)=>{"use strict";Nl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d=e.opts.$data&&i&&i.$data,y;d?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",y="schema"+n):y=i;var m="schema"+n;if(!d)if(i.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var g=[],w=i;if(w)for(var S,P=-1,R=w.length-1;P<R;){S=w[P+=1];var O=e.schema.properties[S];O&&(e.opts.strictKeywords?typeof O=="object"&&Object.keys(O).length>0||O===!1:e.util.schemaHasRules(O,e.RULES.all))||(g[g.length]=S)}}else var g=i;if(d||g.length){var A=e.errorPath,U=d||g.length>=e.opts.loopRequired,z=e.opts.ownProperties;if(h)if(t+=" var missing"+n+"; ",U){d||(t+=" var "+m+" = validate.schema"+u+"; ");var $="i"+n,V="schema"+n+"["+$+"]",q="' + "+V+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(A,V,e.opts.jsonPointers)),t+=" var "+v+" = true; ",d&&(t+=" if (schema"+n+" === undefined) "+v+" = true; else if (!Array.isArray(schema"+n+")) "+v+" = false; else {"),t+=" for (var "+$+" = 0; "+$+" < "+m+".length; "+$+"++) { "+v+" = "+f+"["+m+"["+$+"]] !== undefined ",z&&(t+=" &&   Object.prototype.hasOwnProperty.call("+f+", "+m+"["+$+"]) "),t+="; if (!"+v+") break; } ",d&&(t+="  }  "),t+="  if (!"+v+") {   ";var L=L||[];L.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+q+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+q+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var I=t;t=L.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+I+"]); ":t+=" validate.errors = ["+I+"]; return false; ":t+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else{t+=" if ( ";var k=g;if(k)for(var F,$=-1,ce=k.length-1;$<ce;){F=k[$+=1],$&&(t+=" || ");var Y=e.util.getProperty(F),re=f+Y;t+=" ( ( "+re+" === undefined ",z&&(t+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(F)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?F:Y)+") ) "}t+=") {  ";var V="missing"+n,q="' + "+V+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(A,V,!0):A+" + "+V);var L=L||[];L.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+q+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+q+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var I=t;t=L.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+I+"]); ":t+=" validate.errors = ["+I+"]; return false; ":t+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else if(U){d||(t+=" var "+m+" = validate.schema"+u+"; ");var $="i"+n,V="schema"+n+"["+$+"]",q="' + "+V+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(A,V,e.opts.jsonPointers)),d&&(t+=" if ("+m+" && !Array.isArray("+m+")) {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+q+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+q+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+m+" !== undefined) { "),t+=" for (var "+$+" = 0; "+$+" < "+m+".length; "+$+"++) { if ("+f+"["+m+"["+$+"]] === undefined ",z&&(t+=" || ! Object.prototype.hasOwnProperty.call("+f+", "+m+"["+$+"]) "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+q+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+q+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(t+="  }  ")}else{var K=g;if(K)for(var F,Z=-1,ge=K.length-1;Z<ge;){F=K[Z+=1];var Y=e.util.getProperty(F),q=e.util.escapeQuotes(F),re=f+Y;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(A,F,e.opts.jsonPointers)),t+=" if ( "+re+" === undefined ",z&&(t+=" || ! Object.prototype.hasOwnProperty.call("+f+", '"+e.util.escapeQuotes(F)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+q+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+q+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=A}else h&&(t+=" if (true) {");return t}});var Ll=M((Qy,Ml)=>{"use strict";Ml.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f="data"+(o||""),v="valid"+n,d=e.opts.$data&&i&&i.$data,y;if(d?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",y="schema"+n):y=i,(i||d)&&e.opts.uniqueItems!==!1){d&&(t+=" var "+v+"; if ("+y+" === false || "+y+" === undefined) "+v+" = true; else if (typeof "+y+" != 'boolean') "+v+" = false; else { "),t+=" var i = "+f+".length , "+v+" = true , j; if (i > 1) { ";var m=e.schema.items&&e.schema.items.type,g=Array.isArray(m);if(!m||m=="object"||m=="array"||g&&(m.indexOf("object")>=0||m.indexOf("array")>=0))t+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+f+"[i], "+f+"[j])) { "+v+" = false; break outer; } } } ";else{t+=" var itemIndices = {}, item; for (;i--;) { var item = "+f+"[i]; ";var w="checkDataType"+(g?"s":"");t+=" if ("+e.util[w](m,"item",e.opts.strictNumbers,!0)+") continue; ",g&&(t+=` if (typeof item == 'string') item = '"' + item; `),t+=" if (typeof itemIndices[item] == 'number') { "+v+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}t+=" } ",d&&(t+="  }  "),t+=" if (!"+v+") {   ";var S=S||[];S.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(t+=" , schema:  ",d?t+="validate.schema"+u:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),t+=" } "):t+=" {} ";var P=t;t=S.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+P+"]); ":t+=" validate.errors = ["+P+"]; return false; ":t+=" var err = "+P+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { ")}else h&&(t+=" if (true) { ");return t}});var ql=M((Wy,Fl)=>{"use strict";Fl.exports={$ref:Yi(),allOf:el(),anyOf:rl(),$comment:sl(),const:ol(),contains:ll(),dependencies:ul(),enum:hl(),format:pl(),if:vl(),items:yl(),maximum:Tn(),minimum:Tn(),maxItems:Cn(),minItems:Cn(),maxLength:In(),minLength:In(),maxProperties:An(),minProperties:An(),multipleOf:Pl(),not:Rl(),oneOf:Tl(),pattern:Il(),properties:$l(),propertyNames:Dl(),required:jl(),uniqueItems:Ll(),validate:Rn()}});var Vl=M((Gy,zl)=>{"use strict";var Ul=ql(),$n=mr().toHash;zl.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],r=["type","$comment"],s=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],t=["number","integer","string","array","object","boolean","null"];return e.all=$n(r),e.types=$n(t),e.forEach(function(n){n.rules=n.rules.map(function(o){var i;if(typeof o=="object"){var u=Object.keys(o)[0];i=o[u],o=u,i.forEach(function(h){r.push(h),e.all[h]=!0})}r.push(o);var c=e.all[o]={keyword:o,code:Ul[o],implements:i};return c}),e.all.$comment={keyword:"$comment",code:Ul.$comment},n.type&&(e.types[n.type]=n)}),e.keywords=$n(r.concat(s)),e.custom={},e}});var Bl=M((Ky,Zl)=>{"use strict";var Hl=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];Zl.exports=function(a,e){for(var r=0;r<e.length;r++){a=JSON.parse(JSON.stringify(a));var s=e[r].split("/"),t=a,n;for(n=1;n<s.length;n++)t=t[s[n]];for(n=0;n<Hl.length;n++){var o=Hl[n],i=t[o];i&&(t[o]={anyOf:[i,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return a}});var Wl=M((Yy,Ql)=>{"use strict";var Mp=is().MissingRef;Ql.exports=Jl;function Jl(a,e,r){var s=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof e=="function"&&(r=e,e=void 0);var t=n(a).then(function(){var i=s._addSchema(a,void 0,e);return i.validate||o(i)});return r&&t.then(function(i){r(null,i)},r),t;function n(i){var u=i.$schema;return u&&!s.getSchema(u)?Jl.call(s,{$ref:u},!0):Promise.resolve()}function o(i){try{return s._compile(i)}catch(c){if(c instanceof Mp)return u(c);throw c}function u(c){var h=c.missingSchema;if(d(h))throw new Error("Schema "+h+" is loaded but "+c.missingRef+" cannot be resolved");var f=s._loadingSchemas[h];return f||(f=s._loadingSchemas[h]=s._opts.loadSchema(h),f.then(v,v)),f.then(function(y){if(!d(h))return n(y).then(function(){d(h)||s.addSchema(y,h,void 0,e)})}).then(function(){return o(i)});function v(){delete s._loadingSchemas[h]}function d(y){return s._refs[y]||s._schemas[y]}}}}});var Kl=M((Xy,Gl)=>{"use strict";Gl.exports=function(e,r,s){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],u=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,f,v="data"+(o||""),d="valid"+n,y="errs__"+n,m=e.opts.$data&&i&&i.$data,g;m?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",g="schema"+n):g=i;var w=this,S="definition"+n,P=w.definition,R="",O,A,U,z,$;if(m&&P.$data){$="keywordValidate"+n;var V=P.validateSchema;t+=" var "+S+" = RULES.custom['"+r+"'].definition; var "+$+" = "+S+".validate;"}else{if(z=e.useCustomRule(w,i,e.schema,e),!z)return;g="validate.schema"+u,$=z.code,O=P.compile,A=P.inline,U=P.macro}var q=$+".errors",L="i"+n,I="ruleErr"+n,k=P.async;if(k&&!e.async)throw new Error("async keyword in sync schema");if(A||U||(t+=""+q+" = null;"),t+="var "+y+" = errors;var "+d+";",m&&P.$data&&(R+="}",t+=" if ("+g+" === undefined) { "+d+" = true; } else { ",V&&(R+="}",t+=" "+d+" = "+S+".validateSchema("+g+"); if ("+d+") { ")),A)P.statements?t+=" "+z.validate+" ":t+=" "+d+" = "+z.validate+"; ";else if(U){var F=e.util.copy(e),R="";F.level++;var ce="valid"+F.level;F.schema=z.validate,F.schemaPath="";var Y=e.compositeRule;e.compositeRule=F.compositeRule=!0;var re=e.validate(F).replace(/validate\.schema/g,$);e.compositeRule=F.compositeRule=Y,t+=" "+re}else{var K=K||[];K.push(t),t="",t+="  "+$+".call( ",e.opts.passContext?t+="this":t+="self",O||P.schema===!1?t+=" , "+v+" ":t+=" , "+g+" , "+v+" , validate.schema"+e.schemaPath+" ",t+=" , (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var Z=o?"data"+(o-1||""):"parentData",ge=o?e.dataPathArr[o]:"parentDataProperty";t+=" , "+Z+" , "+ge+" , rootData )  ";var Ie=t;t=K.pop(),P.errors===!1?(t+=" "+d+" = ",k&&(t+="await "),t+=""+Ie+"; "):k?(q="customErrors"+n,t+=" var "+q+" = null; try { "+d+" = await "+Ie+"; } catch (e) { "+d+" = false; if (e instanceof ValidationError) "+q+" = e.errors; else throw e; } "):t+=" "+q+" = null; "+d+" = "+Ie+"; "}if(P.modifying&&(t+=" if ("+Z+") "+v+" = "+Z+"["+ge+"];"),t+=""+R,P.valid)h&&(t+=" if (true) { ");else{t+=" if ( ",P.valid===void 0?(t+=" !",U?t+=""+ce:t+=""+d):t+=" "+!P.valid+" ",t+=") { ",f=w.keyword;var K=K||[];K.push(t),t="";var K=K||[];K.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(f||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+w.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+w.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+v+" "),t+=" } "):t+=" {} ";var De=t;t=K.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+De+"]); ":t+=" validate.errors = ["+De+"]; return false; ":t+=" var err = "+De+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var ne=t;t=K.pop(),A?P.errors?P.errors!="full"&&(t+="  for (var "+L+"="+y+"; "+L+"<errors; "+L+"++) { var "+I+" = vErrors["+L+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(t+=" "+I+".schema = "+g+"; "+I+".data = "+v+"; "),t+=" } "):P.errors===!1?t+=" "+ne+" ":(t+=" if ("+y+" == errors) { "+ne+" } else {  for (var "+L+"="+y+"; "+L+"<errors; "+L+"++) { var "+I+" = vErrors["+L+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(t+=" "+I+".schema = "+g+"; "+I+".data = "+v+"; "),t+=" } } "):U?(t+="   var err =   ",e.createErrors!==!1?(t+=" { keyword: '"+(f||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+w.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+w.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+v+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; ")):P.errors===!1?t+=" "+ne+" ":(t+=" if (Array.isArray("+q+")) { if (vErrors === null) vErrors = "+q+"; else vErrors = vErrors.concat("+q+"); errors = vErrors.length;  for (var "+L+"="+y+"; "+L+"<errors; "+L+"++) { var "+I+" = vErrors["+L+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+";  "+I+'.schemaPath = "'+c+'";  ',e.opts.verbose&&(t+=" "+I+".schema = "+g+"; "+I+".data = "+v+"; "),t+=" } } else { "+ne+" } "),t+=" } ",h&&(t+=" else { ")}return t}});var kn=M((e_,Lp)=>{Lp.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var ec=M((t_,Xl)=>{"use strict";var Yl=kn();Xl.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:Yl.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:Yl.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}});var rc=M((r_,tc)=>{"use strict";var Fp=/^[a-z_$][a-z0-9_$-]*$/i,qp=Kl(),Up=ec();tc.exports={add:zp,get:Vp,remove:Hp,validate:Dn};function zp(a,e){var r=this.RULES;if(r.keywords[a])throw new Error("Keyword "+a+" is already defined");if(!Fp.test(a))throw new Error("Keyword "+a+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var s=e.type;if(Array.isArray(s))for(var t=0;t<s.length;t++)o(a,s[t],e);else o(a,s,e);var n=e.metaSchema;n&&(e.$data&&this._opts.$data&&(n={anyOf:[n,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(n,!0))}r.keywords[a]=r.all[a]=!0;function o(i,u,c){for(var h,f=0;f<r.length;f++){var v=r[f];if(v.type==u){h=v;break}}h||(h={type:u,rules:[]},r.push(h));var d={keyword:i,definition:c,custom:!0,code:qp,implements:c.implements};h.rules.push(d),r.custom[i]=d}return this}function Vp(a){var e=this.RULES.custom[a];return e?e.definition:this.RULES.keywords[a]||!1}function Hp(a){var e=this.RULES;delete e.keywords[a],delete e.all[a],delete e.custom[a];for(var r=0;r<e.length;r++)for(var s=e[r].rules,t=0;t<s.length;t++)if(s[t].keyword==a){s.splice(t,1);break}return this}function Dn(a,e){Dn.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(Up,!0);if(r(a))return!0;if(Dn.errors=r.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}});var ac=M((a_,Zp)=>{Zp.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var jn=M((s_,hc)=>{"use strict";var nc=ji(),vr=os(),Bp=Li(),oc=_n(),Jp=Sn(),Qp=Gi(),Wp=Vl(),ic=Bl(),lc=mr();hc.exports=_e;_e.prototype.validate=Kp;_e.prototype.compile=Yp;_e.prototype.addSchema=Xp;_e.prototype.addMetaSchema=em;_e.prototype.validateSchema=tm;_e.prototype.getSchema=am;_e.prototype.removeSchema=nm;_e.prototype.addFormat=fm;_e.prototype.errorsText=hm;_e.prototype._addSchema=om;_e.prototype._compile=im;_e.prototype.compileAsync=Wl();var ms=rc();_e.prototype.addKeyword=ms.add;_e.prototype.getKeyword=ms.get;_e.prototype.removeKeyword=ms.remove;_e.prototype.validateKeyword=ms.validate;var cc=is();_e.ValidationError=cc.Validation;_e.MissingRefError=cc.MissingRef;_e.$dataMetaSchema=ic;var ps="http://json-schema.org/draft-07/schema",sc=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],Gp=["/properties"];function _e(a){if(!(this instanceof _e))return new _e(a);a=this._opts=lc.copy(a)||{},_m(this),this._schemas={},this._refs={},this._fragments={},this._formats=Qp(a.format),this._cache=a.cache||new Bp,this._loadingSchemas={},this._compilations=[],this.RULES=Wp(),this._getId=lm(a),a.loopRequired=a.loopRequired||1/0,a.errorDataPath=="property"&&(a._errorDataPathProperty=!0),a.serialize===void 0&&(a.serialize=Jp),this._metaOpts=ym(this),a.formats&&vm(this),a.keywords&&gm(this),pm(this),typeof a.meta=="object"&&this.addMetaSchema(a.meta),a.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),mm(this)}function Kp(a,e){var r;if(typeof a=="string"){if(r=this.getSchema(a),!r)throw new Error('no schema with key or ref "'+a+'"')}else{var s=this._addSchema(a);r=s.validate||this._compile(s)}var t=r(e);return r.$async!==!0&&(this.errors=r.errors),t}function Yp(a,e){var r=this._addSchema(a,void 0,e);return r.validate||this._compile(r)}function Xp(a,e,r,s){if(Array.isArray(a)){for(var t=0;t<a.length;t++)this.addSchema(a[t],void 0,r,s);return this}var n=this._getId(a);if(n!==void 0&&typeof n!="string")throw new Error("schema id must be string");return e=vr.normalizeId(e||n),dc(this,e),this._schemas[e]=this._addSchema(a,r,s,!0),this}function em(a,e,r){return this.addSchema(a,e,r,!0),this}function tm(a,e){var r=a.$schema;if(r!==void 0&&typeof r!="string")throw new Error("$schema must be a string");if(r=r||this._opts.defaultMeta||rm(this),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var s=this.validate(r,a);if(!s&&e){var t="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(t);else throw new Error(t)}return s}function rm(a){var e=a._opts.meta;return a._opts.defaultMeta=typeof e=="object"?a._getId(e)||e:a.getSchema(ps)?ps:void 0,a._opts.defaultMeta}function am(a){var e=uc(this,a);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return sm(this,a)}}function sm(a,e){var r=vr.schema.call(a,{schema:{}},e);if(r){var s=r.schema,t=r.root,n=r.baseId,o=nc.call(a,s,t,void 0,n);return a._fragments[e]=new oc({ref:e,fragment:!0,schema:s,root:t,baseId:n,validate:o}),o}}function uc(a,e){return e=vr.normalizeId(e),a._schemas[e]||a._refs[e]||a._fragments[e]}function nm(a){if(a instanceof RegExp)return fs(this,this._schemas,a),fs(this,this._refs,a),this;switch(typeof a){case"undefined":return fs(this,this._schemas),fs(this,this._refs),this._cache.clear(),this;case"string":var e=uc(this,a);return e&&this._cache.del(e.cacheKey),delete this._schemas[a],delete this._refs[a],this;case"object":var r=this._opts.serialize,s=r?r(a):a;this._cache.del(s);var t=this._getId(a);t&&(t=vr.normalizeId(t),delete this._schemas[t],delete this._refs[t])}return this}function fs(a,e,r){for(var s in e){var t=e[s];!t.meta&&(!r||r.test(s))&&(a._cache.del(t.cacheKey),delete e[s])}}function om(a,e,r,s){if(typeof a!="object"&&typeof a!="boolean")throw new Error("schema should be object or boolean");var t=this._opts.serialize,n=t?t(a):a,o=this._cache.get(n);if(o)return o;s=s||this._opts.addUsedSchema!==!1;var i=vr.normalizeId(this._getId(a));i&&s&&dc(this,i);var u=this._opts.validateSchema!==!1&&!e,c;u&&!(c=i&&i==vr.normalizeId(a.$schema))&&this.validateSchema(a,!0);var h=vr.ids.call(this,a),f=new oc({id:i,schema:a,localRefs:h,cacheKey:n,meta:r});return i[0]!="#"&&s&&(this._refs[i]=f),this._cache.put(n,f),u&&c&&this.validateSchema(a,!0),f}function im(a,e){if(a.compiling)return a.validate=t,t.schema=a.schema,t.errors=null,t.root=e||t,a.schema.$async===!0&&(t.$async=!0),t;a.compiling=!0;var r;a.meta&&(r=this._opts,this._opts=this._metaOpts);var s;try{s=nc.call(this,a.schema,e,a.localRefs)}catch(n){throw delete a.validate,n}finally{a.compiling=!1,a.meta&&(this._opts=r)}return a.validate=s,a.refs=s.refs,a.refVal=s.refVal,a.root=s.root,s;function t(){var n=a.validate,o=n.apply(this,arguments);return t.errors=n.errors,o}}function lm(a){switch(a.schemaId){case"auto":return dm;case"id":return cm;default:return um}}function cm(a){return a.$id&&this.logger.warn("schema $id ignored",a.$id),a.id}function um(a){return a.id&&this.logger.warn("schema id ignored",a.id),a.$id}function dm(a){if(a.$id&&a.id&&a.$id!=a.id)throw new Error("schema $id is different from id");return a.$id||a.id}function hm(a,e){if(a=a||this.errors,!a)return"No errors";e=e||{};for(var r=e.separator===void 0?", ":e.separator,s=e.dataVar===void 0?"data":e.dataVar,t="",n=0;n<a.length;n++){var o=a[n];o&&(t+=s+o.dataPath+" "+o.message+r)}return t.slice(0,-r.length)}function fm(a,e){return typeof e=="string"&&(e=new RegExp(e)),this._formats[a]=e,this}function pm(a){var e;if(a._opts.$data&&(e=ac(),a.addMetaSchema(e,e.$id,!0)),a._opts.meta!==!1){var r=kn();a._opts.$data&&(r=ic(r,Gp)),a.addMetaSchema(r,ps,!0),a._refs["http://json-schema.org/schema"]=ps}}function mm(a){var e=a._opts.schemas;if(e)if(Array.isArray(e))a.addSchema(e);else for(var r in e)a.addSchema(e[r],r)}function vm(a){for(var e in a._opts.formats){var r=a._opts.formats[e];a.addFormat(e,r)}}function gm(a){for(var e in a._opts.keywords){var r=a._opts.keywords[e];a.addKeyword(e,r)}}function dc(a,e){if(a._schemas[e]||a._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}function ym(a){for(var e=lc.copy(a._opts),r=0;r<sc.length;r++)delete e[sc[r]];return e}function _m(a){var e=a._opts.logger;if(e===!1)a.logger={log:Nn,warn:Nn,error:Nn};else{if(e===void 0&&(e=console),!(typeof e=="object"&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");a.logger=e}}function Nn(){}});var kc=M(($_,Ps)=>{"use strict";Ps.exports=Jm;Ps.exports.format=Ac;Ps.exports.parse=$c;var Hm=/\B(?=(\d{3})+(?!\d))/g,Zm=/(?:\.0*|(\.[^0]+)0+)$/,Vt={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},Bm=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function Jm(a,e){return typeof a=="string"?$c(a):typeof a=="number"?Ac(a,e):null}function Ac(a,e){if(!Number.isFinite(a))return null;var r=Math.abs(a),s=e&&e.thousandsSeparator||"",t=e&&e.unitSeparator||"",n=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=!!(e&&e.fixedDecimals),i=e&&e.unit||"";(!i||!Vt[i.toLowerCase()])&&(r>=Vt.pb?i="PB":r>=Vt.tb?i="TB":r>=Vt.gb?i="GB":r>=Vt.mb?i="MB":r>=Vt.kb?i="KB":i="B");var u=a/Vt[i.toLowerCase()],c=u.toFixed(n);return o||(c=c.replace(Zm,"$1")),s&&(c=c.split(".").map(function(h,f){return f===0?h.replace(Hm,s):h}).join(".")),c+t+i}function $c(a){if(typeof a=="number"&&!isNaN(a))return a;if(typeof a!="string")return null;var e=Bm.exec(a),r,s="b";return e?(r=parseFloat(e[1]),s=e[4].toLowerCase()):(r=parseInt(a,10),s="b"),isNaN(r)?null:Math.floor(Vt[s]*r)}});var ro=M(to=>{"use strict";var Nc=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,Qm=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,jc=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,Wm=/\\([\u000b\u0020-\u00ff])/g,Gm=/([\\"])/g,Mc=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;to.format=Km;to.parse=Ym;function Km(a){if(!a||typeof a!="object")throw new TypeError("argument obj is required");var e=a.parameters,r=a.type;if(!r||!Mc.test(r))throw new TypeError("invalid type");var s=r;if(e&&typeof e=="object")for(var t,n=Object.keys(e).sort(),o=0;o<n.length;o++){if(t=n[o],!jc.test(t))throw new TypeError("invalid parameter name");s+="; "+t+"="+ev(e[t])}return s}function Ym(a){if(!a)throw new TypeError("argument string is required");var e=typeof a=="object"?Xm(a):a;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var r=e.indexOf(";"),s=r!==-1?e.slice(0,r).trim():e.trim();if(!Mc.test(s))throw new TypeError("invalid media type");var t=new tv(s.toLowerCase());if(r!==-1){var n,o,i;for(Nc.lastIndex=r;o=Nc.exec(e);){if(o.index!==r)throw new TypeError("invalid parameter format");r+=o[0].length,n=o[1].toLowerCase(),i=o[2],i.charCodeAt(0)===34&&(i=i.slice(1,-1),i.indexOf("\\")!==-1&&(i=i.replace(Wm,"$1"))),t.parameters[n]=i}if(r!==e.length)throw new TypeError("invalid parameter format")}return t}function Xm(a){var e;if(typeof a.getHeader=="function"?e=a.getHeader("content-type"):typeof a.headers=="object"&&(e=a.headers&&a.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function ev(a){var e=String(a);if(jc.test(e))return e;if(e.length>0&&!Qm.test(e))throw new TypeError("invalid parameter value");return'"'+e.replace(Gm,"\\$1")+'"'}function tv(a){this.parameters=Object.create(null),this.type=a}});var Zc=M((L_,Hc)=>{Hc.exports=Vc;Vc.sync=sv;var Uc=require("fs");function av(a,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var s=0;s<r.length;s++){var t=r[s].toLowerCase();if(t&&a.substr(-t.length).toLowerCase()===t)return!0}return!1}function zc(a,e,r){return!a.isSymbolicLink()&&!a.isFile()?!1:av(e,r)}function Vc(a,e,r){Uc.stat(a,function(s,t){r(s,s?!1:zc(t,a,e))})}function sv(a,e){return zc(Uc.statSync(a),a,e)}});var Gc=M((F_,Wc)=>{Wc.exports=Jc;Jc.sync=nv;var Bc=require("fs");function Jc(a,e,r){Bc.stat(a,function(s,t){r(s,s?!1:Qc(t,e))})}function nv(a,e){return Qc(Bc.statSync(a),e)}function Qc(a,e){return a.isFile()&&ov(a,e)}function ov(a,e){var r=a.mode,s=a.uid,t=a.gid,n=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),o=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),i=parseInt("100",8),u=parseInt("010",8),c=parseInt("001",8),h=i|u,f=r&c||r&u&&t===o||r&i&&s===n||r&h&&n===0;return f}});var Yc=M((U_,Kc)=>{var q_=require("fs"),Rs;process.platform==="win32"||global.TESTING_WINDOWS?Rs=Zc():Rs=Gc();Kc.exports=ao;ao.sync=iv;function ao(a,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(s,t){ao(a,e||{},function(n,o){n?t(n):s(o)})})}Rs(a,e||{},function(s,t){s&&(s.code==="EACCES"||e&&e.ignoreErrors)&&(s=null,t=!1),r(s,t)})}function iv(a,e){try{return Rs.sync(a,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var nu=M((z_,su)=>{var Br=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Xc=require("path"),lv=Br?";":":",eu=Yc(),tu=a=>Object.assign(new Error(`not found: ${a}`),{code:"ENOENT"}),ru=(a,e)=>{let r=e.colon||lv,s=a.match(/\//)||Br&&a.match(/\\/)?[""]:[...Br?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],t=Br?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",n=Br?t.split(r):[""];return Br&&a.indexOf(".")!==-1&&n[0]!==""&&n.unshift(""),{pathEnv:s,pathExt:n,pathExtExe:t}},au=(a,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:s,pathExt:t,pathExtExe:n}=ru(a,e),o=[],i=c=>new Promise((h,f)=>{if(c===s.length)return e.all&&o.length?h(o):f(tu(a));let v=s[c],d=/^".*"$/.test(v)?v.slice(1,-1):v,y=Xc.join(d,a),m=!d&&/^\.[\\\/]/.test(a)?a.slice(0,2)+y:y;h(u(m,c,0))}),u=(c,h,f)=>new Promise((v,d)=>{if(f===t.length)return v(i(h+1));let y=t[f];eu(c+y,{pathExt:n},(m,g)=>{if(!m&&g)if(e.all)o.push(c+y);else return v(c+y);return v(u(c,h,f+1))})});return r?i(0).then(c=>r(null,c),r):i(0)},cv=(a,e)=>{e=e||{};let{pathEnv:r,pathExt:s,pathExtExe:t}=ru(a,e),n=[];for(let o=0;o<r.length;o++){let i=r[o],u=/^".*"$/.test(i)?i.slice(1,-1):i,c=Xc.join(u,a),h=!u&&/^\.[\\\/]/.test(a)?a.slice(0,2)+c:c;for(let f=0;f<s.length;f++){let v=h+s[f];try{if(eu.sync(v,{pathExt:t}))if(e.all)n.push(v);else return v}catch{}}}if(e.all&&n.length)return n;if(e.nothrow)return null;throw tu(a)};su.exports=au;au.sync=cv});var iu=M((V_,so)=>{"use strict";var ou=(a={})=>{let e=a.env||process.env;return(a.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(s=>s.toUpperCase()==="PATH")||"Path"};so.exports=ou;so.exports.default=ou});var du=M((H_,uu)=>{"use strict";var lu=require("path"),uv=nu(),dv=iu();function cu(a,e){let r=a.options.env||process.env,s=process.cwd(),t=a.options.cwd!=null,n=t&&process.chdir!==void 0&&!process.chdir.disabled;if(n)try{process.chdir(a.options.cwd)}catch{}let o;try{o=uv.sync(a.command,{path:r[dv({env:r})],pathExt:e?lu.delimiter:void 0})}catch{}finally{n&&process.chdir(s)}return o&&(o=lu.resolve(t?a.options.cwd:"",o)),o}function hv(a){return cu(a)||cu(a,!0)}uu.exports=hv});var hu=M((Z_,oo)=>{"use strict";var no=/([()\][%!^"`<>&|;, *?])/g;function fv(a){return a=a.replace(no,"^$1"),a}function pv(a,e){return a=`${a}`,a=a.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),a=a.replace(/(?=(\\+?)?)\1$/,"$1$1"),a=`"${a}"`,a=a.replace(no,"^$1"),e&&(a=a.replace(no,"^$1")),a}oo.exports.command=fv;oo.exports.argument=pv});var pu=M((B_,fu)=>{"use strict";fu.exports=/^#!(.*)/});var vu=M((J_,mu)=>{"use strict";var mv=pu();mu.exports=(a="")=>{let e=a.match(mv);if(!e)return null;let[r,s]=e[0].replace(/#! ?/,"").split(" "),t=r.split("/").pop();return t==="env"?s:s?`${t} ${s}`:t}});var yu=M((Q_,gu)=>{"use strict";var io=require("fs"),vv=vu();function gv(a){let r=Buffer.alloc(150),s;try{s=io.openSync(a,"r"),io.readSync(s,r,0,150,0),io.closeSync(s)}catch{}return vv(r.toString())}gu.exports=gv});var xu=M((W_,wu)=>{"use strict";var yv=require("path"),_u=du(),bu=hu(),_v=yu(),bv=process.platform==="win32",wv=/\.(?:com|exe)$/i,xv=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function Ev(a){a.file=_u(a);let e=a.file&&_v(a.file);return e?(a.args.unshift(a.file),a.command=e,_u(a)):a.file}function Pv(a){if(!bv)return a;let e=Ev(a),r=!wv.test(e);if(a.options.forceShell||r){let s=xv.test(e);a.command=yv.normalize(a.command),a.command=bu.command(a.command),a.args=a.args.map(n=>bu.argument(n,s));let t=[a.command].concat(a.args).join(" ");a.args=["/d","/s","/c",`"${t}"`],a.command=process.env.comspec||"cmd.exe",a.options.windowsVerbatimArguments=!0}return a}function Sv(a,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let s={command:a,args:e,options:r,file:void 0,original:{command:a,args:e}};return r.shell?s:Pv(s)}wu.exports=Sv});var Su=M((G_,Pu)=>{"use strict";var lo=process.platform==="win32";function co(a,e){return Object.assign(new Error(`${e} ${a.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${a.command}`,path:a.command,spawnargs:a.args})}function Rv(a,e){if(!lo)return;let r=a.emit;a.emit=function(s,t){if(s==="exit"){let n=Eu(t,e);if(n)return r.call(a,"error",n)}return r.apply(a,arguments)}}function Eu(a,e){return lo&&a===1&&!e.file?co(e.original,"spawn"):null}function Ov(a,e){return lo&&a===1&&!e.file?co(e.original,"spawnSync"):null}Pu.exports={hookChildProcess:Rv,verifyENOENT:Eu,verifyENOENTSync:Ov,notFoundError:co}});var Tu=M((K_,Jr)=>{"use strict";var Ru=require("child_process"),uo=xu(),ho=Su();function Ou(a,e,r){let s=uo(a,e,r),t=Ru.spawn(s.command,s.args,s.options);return ho.hookChildProcess(t,s),t}function Tv(a,e,r){let s=uo(a,e,r),t=Ru.spawnSync(s.command,s.args,s.options);return t.error=t.error||ho.verifyENOENTSync(t.status,s),t}Jr.exports=Ou;Jr.exports.spawn=Ou;Jr.exports.sync=Tv;Jr.exports._parse=uo;Jr.exports._enoent=ho});var mo=M(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.OpenAI=void 0;var po=class{constructor(){Me(this,"name","openai");Me(this,"systemPrompt",qv);Me(this,"_endpoint")}async endpoint(){return this._endpoint||(this._endpoint=await this.connect()),this._endpoint}async connect(){return{model:"gpt-4.1",baseUrl:"https://api.openai.com/v1",apiKey:process.env.OPENAI_API_KEY,headers:{}}}async complete(e){var f,v,d,y;let r=Mv(e.messages),s=e.tools.map(Lv),t=await this.endpoint(),n=await Nv({model:t.model,messages:r,tools:s,tool_choice:e.tools.length>0?"auto":void 0},t),o=n.choices[0].message,u=(o.tool_calls||[]).map(Fv),c={role:"assistant",content:o.content||"",toolCalls:u},h={input:(v=(f=n.usage)==null?void 0:f.prompt_tokens)!=null?v:0,output:(y=(d=n.usage)==null?void 0:d.completion_tokens)!=null?y:0};return{result:c,usage:h}}};ks.OpenAI=po;async function Nv(a,e){let r={"Content-Type":"application/json",Authorization:`Bearer ${e.apiKey}`,"Copilot-Vision-Request":"true",...e.headers},s=await fetch(`${e.baseUrl}/chat/completions`,{method:"POST",headers:r,body:JSON.stringify(a)});if(!s.ok)throw new Error(`API error: ${s.status} ${s.statusText} ${await s.text()}`);return await s.json()}function jv(a){if(a.type==="text")return{type:"text",text:a.text};if(a.type==="image")return{type:"image_url",image_url:{url:`data:${a.mimeType};base64,${a.data}`}};throw new Error(`Cannot convert content part of type ${a.type} to text content part`)}function Mv(a){let e=[];for(let r of a){if(r.role==="system"){e.push({role:"system",content:r.content});continue}if(r.role==="user"){e.push({role:"user",content:r.content});continue}if(r.role==="assistant"){let s=[];if(r.toolCalls)for(let n of r.toolCalls)s.push({id:n.id,type:"function",function:{name:n.name,arguments:JSON.stringify(n.arguments)}});let t={role:"assistant"};r.content&&(t.content=r.content),s.length>0&&(t.tool_calls=s),e.push(t);continue}if(r.role==="tool"){e.push({role:"tool",tool_call_id:r.toolCallId,content:r.result.content.map(jv)});continue}}return e}function Lv(a){return{type:"function",function:{name:a.name,description:a.description,parameters:a.inputSchema}}}function Fv(a){return{name:a.type==="function"?a.function.name:a.custom.name,arguments:JSON.parse(a.type==="function"?a.function.arguments:a.custom.input),id:a.id}}var qv=`
- Make sure every message contains a tool call.
- When you use a tool, you may provide a brief thought or explanation in the content field
  immediately before the tool_call. Do not split this into separate messages.
- Every reply must include a tool call.
`});var ku=M(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.Copilot=Ht.kEditorHeaders=void 0;var Uv=mo();Ht.kEditorHeaders={"Editor-Version":"vscode/1.96.0","Editor-Plugin-Version":"copilot-chat/0.24.0","User-Agent":"GitHubCopilotChat/0.24.0",Accept:"application/json","Content-Type":"application/json"};var vo=class extends Uv.OpenAI{constructor(){super(...arguments);Me(this,"name","copilot");Me(this,"systemPrompt",Vv)}async connect(){return{model:"claude-sonnet-4.5",baseUrl:"https://api.githubcopilot.com",apiKey:await zv(),headers:Ht.kEditorHeaders}}async complete(r){var t,n;let s=await super.complete(r);if(!s.result.content){let o=[];for(let i of s.result.toolCalls)o.push((n=(t=i.arguments)==null?void 0:t._intent)!=null?n:""),delete i.arguments._intent;s.result.content=o.join(" ")}return s}wrapTool(r){let s=r.inputSchema||{type:"object",properties:{}};return s.properties={_intent:{type:"string",description:"Describe the intent of this tool call"},...s.properties||{}},{...r,inputSchema:s}}};Ht.Copilot=vo;async function zv(){let e=await(await fetch("https://api.github.com/copilot_internal/v2/token",{method:"GET",headers:{Authorization:`token ${process.env.COPILOT_API_KEY}`,...Ht.kEditorHeaders}})).json();if(e.token)return e.token;throw new Error("Failed to get Copilot token")}var Vv=`
  - Your reply MUST be a tool call and nothing but the tool call.
  - NEVER respond with text content, only tool calls.
  - Do NOT describe your plan, do NOT explain what you are doing, do NOT describe what you see, call tools.
  - Provide thoughts in the '_intent' property of the tool calls instead.
`});var Du=M(gt=>{"use strict";var Hv=gt&&gt.__createBinding||(Object.create?(function(a,e,r,s){s===void 0&&(s=r);var t=Object.getOwnPropertyDescriptor(e,r);(!t||("get"in t?!e.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(a,s,t)}):(function(a,e,r,s){s===void 0&&(s=r),a[s]=e[r]})),Zv=gt&&gt.__setModuleDefault||(Object.create?(function(a,e){Object.defineProperty(a,"default",{enumerable:!0,value:e})}):function(a,e){a.default=e}),Bv=gt&&gt.__importStar||(function(){var a=function(e){return a=Object.getOwnPropertyNames||function(r){var s=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(s[s.length]=t);return s},a(e)};return function(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var s=a(e),t=0;t<s.length;t++)s[t]!=="default"&&Hv(r,e,s[t]);return Zv(r,e),r}})();Object.defineProperty(gt,"__esModule",{value:!0});gt.Claude=void 0;var Jv="claude-sonnet-4-5",go=class{constructor(){Me(this,"name","claude");Me(this,"systemPrompt",Yv);Me(this,"_anthropic")}async anthropic(){if(!this._anthropic){let e=await Promise.resolve().then(()=>Bv(require("@anthropic-ai/sdk")));this._anthropic=new e.Anthropic}return this._anthropic}async complete(e){let s=await(await this.anthropic()).messages.create({model:Jv,max_tokens:1e4,messages:Kv(e.messages),tools:e.tools.map(Qv)}),t=s.content.filter(u=>u.type==="text").map(u=>u.text).join(""),n=s.content.filter(u=>u.type==="tool_use").map(Wv),o={role:"assistant",content:t,toolCalls:n},i={input:s.usage.input_tokens,output:s.usage.output_tokens};return{result:o,usage:i}}};gt.Claude=go;function Qv(a){return{name:a.name,description:a.description,input_schema:a.inputSchema}}function Wv(a){return{name:a.name,arguments:a.input,id:a.id}}function Gv(a){if(a.type==="text")return{type:"text",text:a.text,citations:[]};if(a.type==="image")return{type:"image",source:{type:"base64",data:a.data,media_type:a.mimeType}};throw new Error(`Unsupported content part type: ${a.type}`)}function Kv(a){let e=[];for(let r of a){if(r.role==="user"||r.role==="system"){e.push({role:"user",content:r.content});continue}if(r.role==="assistant"){let s=[];if(r.content&&s.push({type:"text",text:r.content,citations:[]}),r.toolCalls)for(let t of r.toolCalls)s.push({type:"tool_use",id:t.id,name:t.name,input:t.arguments});e.push({role:"assistant",content:s});continue}if(r.role==="tool"){let s=e[e.length-1],t={type:"tool_result",tool_use_id:r.toolCallId,content:r.result.content.map(Gv),is_error:r.result.isError};s&&s.role==="user"&&Array.isArray(s.content)?s.content.push(t):e.push({role:"user",content:[t]});continue}}return e}var Yv=`
- Make sure every message contains a tool call.
- When you use a tool, you may provide a brief thought or explanation in the content field
  immediately before the tool_call. Do not split this into separate messages.
- Every reply must include a tool call.
`});var Nu=M(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.getProvider=rg;var Xv=mo(),eg=ku(),tg=Du();function rg(a){if(a==="openai")return new Xv.OpenAI;if(a==="copilot")return new eg.Copilot;if(a==="claude")return new tg.Claude;throw new Error(`Unknown loop LLM: ${a}`)}});var Lu=M(Aa=>{"use strict";var ag=Aa&&Aa.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.cachedComplete=ng;var sg=ag(require("crypto"));function ng(a,e,r){return async s=>{var i;let t=ju(s,r),n=og(JSON.stringify(t));if(e.before[n])return e.after[n]=e.before[n],Mu((i=e.before[n])!=null?i:e.after[n],r);if(e.after[n])return Mu(e.after[n],r);let o=await a.complete(s);return e.after[n]=ju(o,r),o}}function ju(a,e){let r=JSON.stringify(a);for(let[s,t]of Object.entries(e))r=r.replaceAll(t,`<${s}>`);return JSON.parse(r)}function Mu(a,e){let r=JSON.stringify(a);for(let[s,t]of Object.entries(e))r=r.replaceAll(`<${s}>`,t);return JSON.parse(r)}function og(a){let e=sg.default.createHash("sha1");return e.update(a),e.digest("hex")}});var Fu=M(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.prune=ig;function ig(a){for(let e of a.messages)e.role==="tool"&&(e.result.content=e.result.content.map(r=>r.type==="image"?{type:"text",text:"<pruned>"}:r))}});var qu=M(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.Loop=void 0;var lg=Nu(),cg=Lu(),ug=Fu(),bo=class{constructor(e,r){Me(this,"_provider");Me(this,"_complete");Me(this,"_logger");var s;this._provider=(0,lg.getProvider)(e),this._complete=r!=null&&r.caches?(0,cg.cachedComplete)(this._provider,r.caches,(s=r.secrets)!=null?s:{}):this._provider.complete.bind(this._provider),this._logger=r==null?void 0:r.logger}async run(e,r={}){var i,u,c,h;let s=[...((i=r.tools)!=null?i:[]).map(f=>{var v,d,y;return(y=(d=(v=this._provider).wrapTool)==null?void 0:d.call(v,f))!=null?y:f}),{name:"report_result",description:"Report the result of the task.",inputSchema:(u=r.resultSchema)!=null?u:dg}],t={messages:[{role:"system",content:hg+`
`+this._provider.systemPrompt},{role:"user",content:e}],tools:s},n=(h=(c=r.logger)!=null?c:this._logger)!=null?h:(()=>{});n("loop:loop",`Starting ${this._provider.name} loop`,e);let o=r.maxTurns||100;for(let f=0;f<o;++f){n("loop:turn",`${f+1} of (max ${o})`);let{result:v,usage:d}=await this._complete(t);(0,ug.prune)(t),t.messages.push(v);let{content:y,toolCalls:m}=v;if(n("loop:usage",`input: ${d.input}, output: ${d.output}`),n("loop:assistant",y,JSON.stringify(m,null,2)),m.length===0){t.messages.push({role:"user",content:'Tool call expected. Call the "report_result" tool when the task is complete.'});continue}let g=[];for(let w of m){let{name:S,arguments:P,id:R}=w;if(n("loop:call-tool",S,JSON.stringify(P,null,2)),S==="report_result")return P;try{let O=await r.callTool({name:S,arguments:P}),A=O.content.filter(U=>U.type==="text").map(U=>U.text).join(`
`);n("loop:tool-result",A,JSON.stringify(O,null,2)),g.push({toolCallId:R,result:O})}catch(O){let A=`Error while executing tool "${S}": ${O instanceof Error?O.message:String(O)}

Please try to recover and complete the task.`;n("loop:tool-error",A,String(O)),g.push({toolCallId:R,result:{content:[{type:"text",text:A}],isError:!0}});for(let U of m.slice(m.indexOf(w)+1))g.push({toolCallId:U.id,result:{content:[{type:"text",text:"This tool call is skipped due to previous error."}],isError:!0}});break}}for(let w of g)t.messages.push({role:"tool",...w})}throw new Error("Failed to perform step, max attempts reached")}};Ds.Loop=bo;var dg={type:"object",properties:{result:{type:"string"}},required:["result"]},hg=`
You are an autonomous agent designed to complete tasks by interacting with tools. Perform the user task.
`});var wg={};Lo(wg,{CallToolRequestSchema:()=>sn,Client:()=>vs,ListRootsRequestSchema:()=>un,ListToolsRequestSchema:()=>rn,Loop:()=>Wr.Loop,PingRequestSchema:()=>Lr,ProgressNotificationSchema:()=>Fr,SSEClientTransport:()=>Es,SSEServerTransport:()=>Ss,Server:()=>gs,StdioClientTransport:()=>Ts,StdioServerTransport:()=>Cs,StreamableHTTPClientTransport:()=>$s,StreamableHTTPServerTransport:()=>Is,z:()=>l,zodToJsonSchema:()=>So});module.exports=Hd(wg);var l={};Lo(l,{BRAND:()=>vh,DIRTY:()=>Kt,EMPTY_PATH:()=>Qd,INVALID:()=>B,NEVER:()=>ef,OK:()=>$e,ParseStatus:()=>Ce,Schema:()=>G,ZodAny:()=>Nt,ZodArray:()=>Rt,ZodBigInt:()=>Xt,ZodBoolean:()=>er,ZodBranded:()=>na,ZodCatch:()=>dr,ZodDate:()=>tr,ZodDefault:()=>ur,ZodDiscriminatedUnion:()=>qa,ZodEffects:()=>tt,ZodEnum:()=>lr,ZodError:()=>Ue,ZodFirstPartyTypeKind:()=>C,ZodFunction:()=>za,ZodIntersection:()=>nr,ZodIssueCode:()=>T,ZodLazy:()=>or,ZodLiteral:()=>ir,ZodMap:()=>Dr,ZodNaN:()=>jr,ZodNativeEnum:()=>cr,ZodNever:()=>nt,ZodNull:()=>ar,ZodNullable:()=>mt,ZodNumber:()=>Yt,ZodObject:()=>ze,ZodOptional:()=>Xe,ZodParsedType:()=>N,ZodPipeline:()=>oa,ZodPromise:()=>jt,ZodReadonly:()=>hr,ZodRecord:()=>Ua,ZodSchema:()=>G,ZodSet:()=>Nr,ZodString:()=>Dt,ZodSymbol:()=>$r,ZodTransformer:()=>tt,ZodTuple:()=>pt,ZodType:()=>G,ZodUndefined:()=>rr,ZodUnion:()=>sr,ZodUnknown:()=>St,ZodVoid:()=>kr,addIssueToContext:()=>D,any:()=>Sh,array:()=>Ch,bigint:()=>bh,boolean:()=>Go,coerce:()=>Xh,custom:()=>Jo,date:()=>wh,datetimeRegex:()=>Zo,defaultErrorMap:()=>Et,discriminatedUnion:()=>kh,effect:()=>Zh,enum:()=>zh,function:()=>Fh,getErrorMap:()=>Cr,getParsedType:()=>ft,instanceof:()=>yh,intersection:()=>Dh,isAborted:()=>La,isAsync:()=>Ir,isDirty:()=>Fa,isValid:()=>kt,late:()=>gh,lazy:()=>qh,literal:()=>Uh,makeIssue:()=>sa,map:()=>Mh,nan:()=>_h,nativeEnum:()=>Vh,never:()=>Oh,null:()=>Ph,nullable:()=>Jh,number:()=>Wo,object:()=>Ih,objectUtil:()=>Vs,oboolean:()=>Yh,onumber:()=>Kh,optional:()=>Bh,ostring:()=>Gh,pipeline:()=>Wh,preprocess:()=>Qh,promise:()=>Hh,quotelessJson:()=>Zd,record:()=>jh,set:()=>Lh,setErrorMap:()=>Jd,strictObject:()=>Ah,string:()=>Qo,symbol:()=>xh,transformer:()=>Zh,tuple:()=>Nh,undefined:()=>Eh,union:()=>$h,unknown:()=>Rh,util:()=>X,void:()=>Th});var X;(function(a){a.assertEqual=t=>{};function e(t){}a.assertIs=e;function r(t){throw new Error}a.assertNever=r,a.arrayToEnum=t=>{let n={};for(let o of t)n[o]=o;return n},a.getValidEnumValues=t=>{let n=a.objectKeys(t).filter(i=>typeof t[t[i]]!="number"),o={};for(let i of n)o[i]=t[i];return a.objectValues(o)},a.objectValues=t=>a.objectKeys(t).map(function(n){return t[n]}),a.objectKeys=typeof Object.keys=="function"?t=>Object.keys(t):t=>{let n=[];for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.push(o);return n},a.find=(t,n)=>{for(let o of t)if(n(o))return o},a.isInteger=typeof Number.isInteger=="function"?t=>Number.isInteger(t):t=>typeof t=="number"&&Number.isFinite(t)&&Math.floor(t)===t;function s(t,n=" | "){return t.map(o=>typeof o=="string"?`'${o}'`:o).join(n)}a.joinValues=s,a.jsonStringifyReplacer=(t,n)=>typeof n=="bigint"?n.toString():n})(X||(X={}));var Vs;(function(a){a.mergeShapes=(e,r)=>({...e,...r})})(Vs||(Vs={}));var N=X.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ft=a=>{switch(typeof a){case"undefined":return N.undefined;case"string":return N.string;case"number":return Number.isNaN(a)?N.nan:N.number;case"boolean":return N.boolean;case"function":return N.function;case"bigint":return N.bigint;case"symbol":return N.symbol;case"object":return Array.isArray(a)?N.array:a===null?N.null:a.then&&typeof a.then=="function"&&a.catch&&typeof a.catch=="function"?N.promise:typeof Map!="undefined"&&a instanceof Map?N.map:typeof Set!="undefined"&&a instanceof Set?N.set:typeof Date!="undefined"&&a instanceof Date?N.date:N.object;default:return N.unknown}};var T=X.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Zd=a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:"),Ue=class a extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(n){return n.message},s={_errors:[]},t=n=>{for(let o of n.issues)if(o.code==="invalid_union")o.unionErrors.map(t);else if(o.code==="invalid_return_type")t(o.returnTypeError);else if(o.code==="invalid_arguments")t(o.argumentsError);else if(o.path.length===0)s._errors.push(r(o));else{let i=s,u=0;for(;u<o.path.length;){let c=o.path[u];u===o.path.length-1?(i[c]=i[c]||{_errors:[]},i[c]._errors.push(r(o))):i[c]=i[c]||{_errors:[]},i=i[c],u++}}};return t(this),s}static assert(e){if(!(e instanceof a))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,X.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},s=[];for(let t of this.issues)if(t.path.length>0){let n=t.path[0];r[n]=r[n]||[],r[n].push(e(t))}else s.push(e(t));return{formErrors:s,fieldErrors:r}}get formErrors(){return this.flatten()}};Ue.create=a=>new Ue(a);var Bd=(a,e)=>{let r;switch(a.code){case T.invalid_type:a.received===N.undefined?r="Required":r=`Expected ${a.expected}, received ${a.received}`;break;case T.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(a.expected,X.jsonStringifyReplacer)}`;break;case T.unrecognized_keys:r=`Unrecognized key(s) in object: ${X.joinValues(a.keys,", ")}`;break;case T.invalid_union:r="Invalid input";break;case T.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${X.joinValues(a.options)}`;break;case T.invalid_enum_value:r=`Invalid enum value. Expected ${X.joinValues(a.options)}, received '${a.received}'`;break;case T.invalid_arguments:r="Invalid function arguments";break;case T.invalid_return_type:r="Invalid function return type";break;case T.invalid_date:r="Invalid date";break;case T.invalid_string:typeof a.validation=="object"?"includes"in a.validation?(r=`Invalid input: must include "${a.validation.includes}"`,typeof a.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?r=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?r=`Invalid input: must end with "${a.validation.endsWith}"`:X.assertNever(a.validation):a.validation!=="regex"?r=`Invalid ${a.validation}`:r="Invalid";break;case T.too_small:a.type==="array"?r=`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:a.type==="string"?r=`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:a.type==="number"?r=`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:a.type==="bigint"?r=`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:a.type==="date"?r=`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:r="Invalid input";break;case T.too_big:a.type==="array"?r=`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:a.type==="string"?r=`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:a.type==="number"?r=`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="bigint"?r=`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="date"?r=`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:r="Invalid input";break;case T.custom:r="Invalid input";break;case T.invalid_intersection_types:r="Intersection results could not be merged";break;case T.not_multiple_of:r=`Number must be a multiple of ${a.multipleOf}`;break;case T.not_finite:r="Number must be finite";break;default:r=e.defaultError,X.assertNever(a)}return{message:r}},Et=Bd;var qo=Et;function Jd(a){qo=a}function Cr(){return qo}var sa=a=>{let{data:e,path:r,errorMaps:s,issueData:t}=a,n=[...r,...t.path||[]],o={...t,path:n};if(t.message!==void 0)return{...t,path:n,message:t.message};let i="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)i=c(o,{data:e,defaultError:i}).message;return{...t,path:n,message:i}},Qd=[];function D(a,e){let r=Cr(),s=sa({issueData:e,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,r,r===Et?void 0:Et].filter(t=>!!t)});a.common.issues.push(s)}var Ce=class a{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let s=[];for(let t of r){if(t.status==="aborted")return B;t.status==="dirty"&&e.dirty(),s.push(t.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,r){let s=[];for(let t of r){let n=await t.key,o=await t.value;s.push({key:n,value:o})}return a.mergeObjectSync(e,s)}static mergeObjectSync(e,r){let s={};for(let t of r){let{key:n,value:o}=t;if(n.status==="aborted"||o.status==="aborted")return B;n.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof o.value!="undefined"||t.alwaysSet)&&(s[n.value]=o.value)}return{status:e.value,value:s}}},B=Object.freeze({status:"aborted"}),Kt=a=>({status:"dirty",value:a}),$e=a=>({status:"valid",value:a}),La=a=>a.status==="aborted",Fa=a=>a.status==="dirty",kt=a=>a.status==="valid",Ir=a=>typeof Promise!="undefined"&&a instanceof Promise;var H;(function(a){a.errToObj=e=>typeof e=="string"?{message:e}:e||{},a.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(H||(H={}));var et=class{constructor(e,r,s,t){this._cachedPath=[],this.parent=e,this.data=r,this._path=s,this._key=t}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Uo=(a,e)=>{if(kt(e))return{success:!0,data:e.value};if(!a.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Ue(a.common.issues);return this._error=r,this._error}}};function Q(a){if(!a)return{};let{errorMap:e,invalid_type_error:r,required_error:s,description:t}=a;if(e&&(r||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(o,i)=>{var c,h;let{message:u}=a;return o.code==="invalid_enum_value"?{message:u!=null?u:i.defaultError}:typeof i.data=="undefined"?{message:(c=u!=null?u:s)!=null?c:i.defaultError}:o.code!=="invalid_type"?{message:i.defaultError}:{message:(h=u!=null?u:r)!=null?h:i.defaultError}},description:t}}var G=class{get description(){return this._def.description}_getType(e){return ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ce,ctx:{common:e.parent.common,data:e.data,parsedType:ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Ir(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let s=this.safeParse(e,r);if(s.success)return s.data;throw s.error}safeParse(e,r){var n;let s={common:{issues:[],async:(n=r==null?void 0:r.async)!=null?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)},t=this._parseSync({data:e,path:s.path,parent:s});return Uo(s,t)}"~validate"(e){var s,t;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return kt(n)?{value:n.value}:{issues:r.common.issues}}catch(n){(t=(s=n==null?void 0:n.message)==null?void 0:s.toLowerCase())!=null&&t.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>kt(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let s=await this.safeParseAsync(e,r);if(s.success)return s.data;throw s.error}async safeParseAsync(e,r){let s={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)},t=this._parse({data:e,path:s.path,parent:s}),n=await(Ir(t)?t:Promise.resolve(t));return Uo(s,n)}refine(e,r){let s=t=>typeof r=="string"||typeof r=="undefined"?{message:r}:typeof r=="function"?r(t):r;return this._refinement((t,n)=>{let o=e(t),i=()=>n.addIssue({code:T.custom,...s(t)});return typeof Promise!="undefined"&&o instanceof Promise?o.then(u=>u?!0:(i(),!1)):o?!0:(i(),!1)})}refinement(e,r){return this._refinement((s,t)=>e(s)?!0:(t.addIssue(typeof r=="function"?r(s,t):r),!1))}_refinement(e){return new tt({schema:this,typeName:C.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Xe.create(this,this._def)}nullable(){return mt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Rt.create(this)}promise(){return jt.create(this,this._def)}or(e){return sr.create([this,e],this._def)}and(e){return nr.create(this,e,this._def)}transform(e){return new tt({...Q(this._def),schema:this,typeName:C.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new ur({...Q(this._def),innerType:this,defaultValue:r,typeName:C.ZodDefault})}brand(){return new na({typeName:C.ZodBranded,type:this,...Q(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new dr({...Q(this._def),innerType:this,catchValue:r,typeName:C.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return oa.create(this,e)}readonly(){return hr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Wd=/^c[^\s-]{8,}$/i,Gd=/^[0-9a-z]+$/,Kd=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Yd=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Xd=/^[a-z0-9_-]{21}$/i,eh=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,th=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,rh=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ah="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Hs,sh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,nh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,oh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ih=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,lh=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ch=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Vo="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",uh=new RegExp(`^${Vo}$`);function Ho(a){let e="[0-5]\\d";a.precision?e=`${e}\\.\\d{${a.precision}}`:a.precision==null&&(e=`${e}(\\.\\d+)?`);let r=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function dh(a){return new RegExp(`^${Ho(a)}$`)}function Zo(a){let e=`${Vo}T${Ho(a)}`,r=[];return r.push(a.local?"Z?":"Z"),a.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function hh(a,e){return!!((e==="v4"||!e)&&sh.test(a)||(e==="v6"||!e)&&oh.test(a))}function fh(a,e){if(!eh.test(a))return!1;try{let[r]=a.split(".");if(!r)return!1;let s=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),t=JSON.parse(atob(s));return!(typeof t!="object"||t===null||"typ"in t&&(t==null?void 0:t.typ)!=="JWT"||!t.alg||e&&t.alg!==e)}catch{return!1}}function ph(a,e){return!!((e==="v4"||!e)&&nh.test(a)||(e==="v6"||!e)&&ih.test(a))}var Dt=class a extends G{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==N.string){let n=this._getOrReturnCtx(e);return D(n,{code:T.invalid_type,expected:N.string,received:n.parsedType}),B}let s=new Ce,t;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(t=this._getOrReturnCtx(e,t),D(t,{code:T.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="max")e.data.length>n.value&&(t=this._getOrReturnCtx(e,t),D(t,{code:T.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="length"){let o=e.data.length>n.value,i=e.data.length<n.value;(o||i)&&(t=this._getOrReturnCtx(e,t),o?D(t,{code:T.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):i&&D(t,{code:T.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),s.dirty())}else if(n.kind==="email")rh.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"email",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="emoji")Hs||(Hs=new RegExp(ah,"u")),Hs.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"emoji",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="uuid")Yd.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"uuid",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="nanoid")Xd.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"nanoid",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid")Wd.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"cuid",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid2")Gd.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"cuid2",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="ulid")Kd.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"ulid",code:T.invalid_string,message:n.message}),s.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{t=this._getOrReturnCtx(e,t),D(t,{validation:"url",code:T.invalid_string,message:n.message}),s.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"regex",code:T.invalid_string,message:n.message}),s.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(t=this._getOrReturnCtx(e,t),D(t,{code:T.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),s.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(t=this._getOrReturnCtx(e,t),D(t,{code:T.invalid_string,validation:{startsWith:n.value},message:n.message}),s.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(t=this._getOrReturnCtx(e,t),D(t,{code:T.invalid_string,validation:{endsWith:n.value},message:n.message}),s.dirty()):n.kind==="datetime"?Zo(n).test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{code:T.invalid_string,validation:"datetime",message:n.message}),s.dirty()):n.kind==="date"?uh.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{code:T.invalid_string,validation:"date",message:n.message}),s.dirty()):n.kind==="time"?dh(n).test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{code:T.invalid_string,validation:"time",message:n.message}),s.dirty()):n.kind==="duration"?th.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"duration",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="ip"?hh(e.data,n.version)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"ip",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="jwt"?fh(e.data,n.alg)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"jwt",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="cidr"?ph(e.data,n.version)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"cidr",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="base64"?lh.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"base64",code:T.invalid_string,message:n.message}),s.dirty()):n.kind==="base64url"?ch.test(e.data)||(t=this._getOrReturnCtx(e,t),D(t,{validation:"base64url",code:T.invalid_string,message:n.message}),s.dirty()):X.assertNever(n);return{status:s.value,value:e.data}}_regex(e,r,s){return this.refinement(t=>e.test(t),{validation:r,code:T.invalid_string,...H.errToObj(s)})}_addCheck(e){return new a({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...H.errToObj(e)})}url(e){return this._addCheck({kind:"url",...H.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...H.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...H.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...H.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...H.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...H.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...H.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...H.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...H.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...H.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...H.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...H.errToObj(e)})}datetime(e){var r,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)=="undefined"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!=null?r:!1,local:(s=e==null?void 0:e.local)!=null?s:!1,...H.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)=="undefined"?null:e==null?void 0:e.precision,...H.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...H.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...H.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...H.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...H.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...H.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...H.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...H.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...H.errToObj(r)})}nonempty(e){return this.min(1,H.errToObj(e))}trim(){return new a({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new a({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new a({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Dt.create=a=>{var e;return new Dt({checks:[],typeName:C.ZodString,coerce:(e=a==null?void 0:a.coerce)!=null?e:!1,...Q(a)})};function mh(a,e){let r=(a.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,t=r>s?r:s,n=Number.parseInt(a.toFixed(t).replace(".","")),o=Number.parseInt(e.toFixed(t).replace(".",""));return n%o/10**t}var Yt=class a extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==N.number){let n=this._getOrReturnCtx(e);return D(n,{code:T.invalid_type,expected:N.number,received:n.parsedType}),B}let s,t=new Ce;for(let n of this._def.checks)n.kind==="int"?X.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),D(s,{code:T.invalid_type,expected:"integer",received:"float",message:n.message}),t.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(s=this._getOrReturnCtx(e,s),D(s,{code:T.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(s=this._getOrReturnCtx(e,s),D(s,{code:T.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="multipleOf"?mh(e.data,n.value)!==0&&(s=this._getOrReturnCtx(e,s),D(s,{code:T.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),D(s,{code:T.not_finite,message:n.message}),t.dirty()):X.assertNever(n);return{status:t.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,H.toString(r))}gt(e,r){return this.setLimit("min",e,!1,H.toString(r))}lte(e,r){return this.setLimit("max",e,!0,H.toString(r))}lt(e,r){return this.setLimit("max",e,!1,H.toString(r))}setLimit(e,r,s,t){return new a({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:s,message:H.toString(t)}]})}_addCheck(e){return new a({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:H.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:H.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:H.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:H.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:H.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&X.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(r===null||s.value>r)&&(r=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Yt.create=a=>new Yt({checks:[],typeName:C.ZodNumber,coerce:(a==null?void 0:a.coerce)||!1,...Q(a)});var Xt=class a extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==N.bigint)return this._getInvalidInput(e);let s,t=new Ce;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(s=this._getOrReturnCtx(e,s),D(s,{code:T.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(s=this._getOrReturnCtx(e,s),D(s,{code:T.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),D(s,{code:T.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):X.assertNever(n);return{status:t.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return D(r,{code:T.invalid_type,expected:N.bigint,received:r.parsedType}),B}gte(e,r){return this.setLimit("min",e,!0,H.toString(r))}gt(e,r){return this.setLimit("min",e,!1,H.toString(r))}lte(e,r){return this.setLimit("max",e,!0,H.toString(r))}lt(e,r){return this.setLimit("max",e,!1,H.toString(r))}setLimit(e,r,s,t){return new a({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:s,message:H.toString(t)}]})}_addCheck(e){return new a({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:H.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Xt.create=a=>{var e;return new Xt({checks:[],typeName:C.ZodBigInt,coerce:(e=a==null?void 0:a.coerce)!=null?e:!1,...Q(a)})};var er=class extends G{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==N.boolean){let s=this._getOrReturnCtx(e);return D(s,{code:T.invalid_type,expected:N.boolean,received:s.parsedType}),B}return $e(e.data)}};er.create=a=>new er({typeName:C.ZodBoolean,coerce:(a==null?void 0:a.coerce)||!1,...Q(a)});var tr=class a extends G{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==N.date){let n=this._getOrReturnCtx(e);return D(n,{code:T.invalid_type,expected:N.date,received:n.parsedType}),B}if(Number.isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return D(n,{code:T.invalid_date}),B}let s=new Ce,t;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(t=this._getOrReturnCtx(e,t),D(t,{code:T.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),s.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(t=this._getOrReturnCtx(e,t),D(t,{code:T.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),s.dirty()):X.assertNever(n);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new a({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:H.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:H.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};tr.create=a=>new tr({checks:[],coerce:(a==null?void 0:a.coerce)||!1,typeName:C.ZodDate,...Q(a)});var $r=class extends G{_parse(e){if(this._getType(e)!==N.symbol){let s=this._getOrReturnCtx(e);return D(s,{code:T.invalid_type,expected:N.symbol,received:s.parsedType}),B}return $e(e.data)}};$r.create=a=>new $r({typeName:C.ZodSymbol,...Q(a)});var rr=class extends G{_parse(e){if(this._getType(e)!==N.undefined){let s=this._getOrReturnCtx(e);return D(s,{code:T.invalid_type,expected:N.undefined,received:s.parsedType}),B}return $e(e.data)}};rr.create=a=>new rr({typeName:C.ZodUndefined,...Q(a)});var ar=class extends G{_parse(e){if(this._getType(e)!==N.null){let s=this._getOrReturnCtx(e);return D(s,{code:T.invalid_type,expected:N.null,received:s.parsedType}),B}return $e(e.data)}};ar.create=a=>new ar({typeName:C.ZodNull,...Q(a)});var Nt=class extends G{constructor(){super(...arguments),this._any=!0}_parse(e){return $e(e.data)}};Nt.create=a=>new Nt({typeName:C.ZodAny,...Q(a)});var St=class extends G{constructor(){super(...arguments),this._unknown=!0}_parse(e){return $e(e.data)}};St.create=a=>new St({typeName:C.ZodUnknown,...Q(a)});var nt=class extends G{_parse(e){let r=this._getOrReturnCtx(e);return D(r,{code:T.invalid_type,expected:N.never,received:r.parsedType}),B}};nt.create=a=>new nt({typeName:C.ZodNever,...Q(a)});var kr=class extends G{_parse(e){if(this._getType(e)!==N.undefined){let s=this._getOrReturnCtx(e);return D(s,{code:T.invalid_type,expected:N.void,received:s.parsedType}),B}return $e(e.data)}};kr.create=a=>new kr({typeName:C.ZodVoid,...Q(a)});var Rt=class a extends G{_parse(e){let{ctx:r,status:s}=this._processInputParams(e),t=this._def;if(r.parsedType!==N.array)return D(r,{code:T.invalid_type,expected:N.array,received:r.parsedType}),B;if(t.exactLength!==null){let o=r.data.length>t.exactLength.value,i=r.data.length<t.exactLength.value;(o||i)&&(D(r,{code:o?T.too_big:T.too_small,minimum:i?t.exactLength.value:void 0,maximum:o?t.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:t.exactLength.message}),s.dirty())}if(t.minLength!==null&&r.data.length<t.minLength.value&&(D(r,{code:T.too_small,minimum:t.minLength.value,type:"array",inclusive:!0,exact:!1,message:t.minLength.message}),s.dirty()),t.maxLength!==null&&r.data.length>t.maxLength.value&&(D(r,{code:T.too_big,maximum:t.maxLength.value,type:"array",inclusive:!0,exact:!1,message:t.maxLength.message}),s.dirty()),r.common.async)return Promise.all([...r.data].map((o,i)=>t.type._parseAsync(new et(r,o,r.path,i)))).then(o=>Ce.mergeArray(s,o));let n=[...r.data].map((o,i)=>t.type._parseSync(new et(r,o,r.path,i)));return Ce.mergeArray(s,n)}get element(){return this._def.type}min(e,r){return new a({...this._def,minLength:{value:e,message:H.toString(r)}})}max(e,r){return new a({...this._def,maxLength:{value:e,message:H.toString(r)}})}length(e,r){return new a({...this._def,exactLength:{value:e,message:H.toString(r)}})}nonempty(e){return this.min(1,e)}};Rt.create=(a,e)=>new Rt({type:a,minLength:null,maxLength:null,exactLength:null,typeName:C.ZodArray,...Q(e)});function Ar(a){if(a instanceof ze){let e={};for(let r in a.shape){let s=a.shape[r];e[r]=Xe.create(Ar(s))}return new ze({...a._def,shape:()=>e})}else return a instanceof Rt?new Rt({...a._def,type:Ar(a.element)}):a instanceof Xe?Xe.create(Ar(a.unwrap())):a instanceof mt?mt.create(Ar(a.unwrap())):a instanceof pt?pt.create(a.items.map(e=>Ar(e))):a}var ze=class a extends G{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=X.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==N.object){let c=this._getOrReturnCtx(e);return D(c,{code:T.invalid_type,expected:N.object,received:c.parsedType}),B}let{status:s,ctx:t}=this._processInputParams(e),{shape:n,keys:o}=this._getCached(),i=[];if(!(this._def.catchall instanceof nt&&this._def.unknownKeys==="strip"))for(let c in t.data)o.includes(c)||i.push(c);let u=[];for(let c of o){let h=n[c],f=t.data[c];u.push({key:{status:"valid",value:c},value:h._parse(new et(t,f,t.path,c)),alwaysSet:c in t.data})}if(this._def.catchall instanceof nt){let c=this._def.unknownKeys;if(c==="passthrough")for(let h of i)u.push({key:{status:"valid",value:h},value:{status:"valid",value:t.data[h]}});else if(c==="strict")i.length>0&&(D(t,{code:T.unrecognized_keys,keys:i}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let c=this._def.catchall;for(let h of i){let f=t.data[h];u.push({key:{status:"valid",value:h},value:c._parse(new et(t,f,t.path,h)),alwaysSet:h in t.data})}}return t.common.async?Promise.resolve().then(async()=>{let c=[];for(let h of u){let f=await h.key,v=await h.value;c.push({key:f,value:v,alwaysSet:h.alwaysSet})}return c}).then(c=>Ce.mergeObjectSync(s,c)):Ce.mergeObjectSync(s,u)}get shape(){return this._def.shape()}strict(e){return H.errToObj,new a({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,s)=>{var n,o,i,u;let t=(i=(o=(n=this._def).errorMap)==null?void 0:o.call(n,r,s).message)!=null?i:s.defaultError;return r.code==="unrecognized_keys"?{message:(u=H.errToObj(e).message)!=null?u:t}:{message:t}}}:{}})}strip(){return new a({...this._def,unknownKeys:"strip"})}passthrough(){return new a({...this._def,unknownKeys:"passthrough"})}extend(e){return new a({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new a({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:C.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new a({...this._def,catchall:e})}pick(e){let r={};for(let s of X.objectKeys(e))e[s]&&this.shape[s]&&(r[s]=this.shape[s]);return new a({...this._def,shape:()=>r})}omit(e){let r={};for(let s of X.objectKeys(this.shape))e[s]||(r[s]=this.shape[s]);return new a({...this._def,shape:()=>r})}deepPartial(){return Ar(this)}partial(e){let r={};for(let s of X.objectKeys(this.shape)){let t=this.shape[s];e&&!e[s]?r[s]=t:r[s]=t.optional()}return new a({...this._def,shape:()=>r})}required(e){let r={};for(let s of X.objectKeys(this.shape))if(e&&!e[s])r[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Xe;)n=n._def.innerType;r[s]=n}return new a({...this._def,shape:()=>r})}keyof(){return Bo(X.objectKeys(this.shape))}};ze.create=(a,e)=>new ze({shape:()=>a,unknownKeys:"strip",catchall:nt.create(),typeName:C.ZodObject,...Q(e)});ze.strictCreate=(a,e)=>new ze({shape:()=>a,unknownKeys:"strict",catchall:nt.create(),typeName:C.ZodObject,...Q(e)});ze.lazycreate=(a,e)=>new ze({shape:a,unknownKeys:"strip",catchall:nt.create(),typeName:C.ZodObject,...Q(e)});var sr=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),s=this._def.options;function t(n){for(let i of n)if(i.result.status==="valid")return i.result;for(let i of n)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;let o=n.map(i=>new Ue(i.ctx.common.issues));return D(r,{code:T.invalid_union,unionErrors:o}),B}if(r.common.async)return Promise.all(s.map(async n=>{let o={...r,common:{...r.common,issues:[]},parent:null};return{result:await n._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(t);{let n,o=[];for(let u of s){let c={...r,common:{...r.common,issues:[]},parent:null},h=u._parseSync({data:r.data,path:r.path,parent:c});if(h.status==="valid")return h;h.status==="dirty"&&!n&&(n={result:h,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(n)return r.common.issues.push(...n.ctx.common.issues),n.result;let i=o.map(u=>new Ue(u));return D(r,{code:T.invalid_union,unionErrors:i}),B}}get options(){return this._def.options}};sr.create=(a,e)=>new sr({options:a,typeName:C.ZodUnion,...Q(e)});var Pt=a=>a instanceof or?Pt(a.schema):a instanceof tt?Pt(a.innerType()):a instanceof ir?[a.value]:a instanceof lr?a.options:a instanceof cr?X.objectValues(a.enum):a instanceof ur?Pt(a._def.innerType):a instanceof rr?[void 0]:a instanceof ar?[null]:a instanceof Xe?[void 0,...Pt(a.unwrap())]:a instanceof mt?[null,...Pt(a.unwrap())]:a instanceof na||a instanceof hr?Pt(a.unwrap()):a instanceof dr?Pt(a._def.innerType):[],qa=class a extends G{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==N.object)return D(r,{code:T.invalid_type,expected:N.object,received:r.parsedType}),B;let s=this.discriminator,t=r.data[s],n=this.optionsMap.get(t);return n?r.common.async?n._parseAsync({data:r.data,path:r.path,parent:r}):n._parseSync({data:r.data,path:r.path,parent:r}):(D(r,{code:T.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),B)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,s){let t=new Map;for(let n of r){let o=Pt(n.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let i of o){if(t.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);t.set(i,n)}}return new a({typeName:C.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:t,...Q(s)})}};function Zs(a,e){let r=ft(a),s=ft(e);if(a===e)return{valid:!0,data:a};if(r===N.object&&s===N.object){let t=X.objectKeys(e),n=X.objectKeys(a).filter(i=>t.indexOf(i)!==-1),o={...a,...e};for(let i of n){let u=Zs(a[i],e[i]);if(!u.valid)return{valid:!1};o[i]=u.data}return{valid:!0,data:o}}else if(r===N.array&&s===N.array){if(a.length!==e.length)return{valid:!1};let t=[];for(let n=0;n<a.length;n++){let o=a[n],i=e[n],u=Zs(o,i);if(!u.valid)return{valid:!1};t.push(u.data)}return{valid:!0,data:t}}else return r===N.date&&s===N.date&&+a==+e?{valid:!0,data:a}:{valid:!1}}var nr=class extends G{_parse(e){let{status:r,ctx:s}=this._processInputParams(e),t=(n,o)=>{if(La(n)||La(o))return B;let i=Zs(n.value,o.value);return i.valid?((Fa(n)||Fa(o))&&r.dirty(),{status:r.value,value:i.data}):(D(s,{code:T.invalid_intersection_types}),B)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([n,o])=>t(n,o)):t(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};nr.create=(a,e,r)=>new nr({left:a,right:e,typeName:C.ZodIntersection,...Q(r)});var pt=class a extends G{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==N.array)return D(s,{code:T.invalid_type,expected:N.array,received:s.parsedType}),B;if(s.data.length<this._def.items.length)return D(s,{code:T.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),B;!this._def.rest&&s.data.length>this._def.items.length&&(D(s,{code:T.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let n=[...s.data].map((o,i)=>{let u=this._def.items[i]||this._def.rest;return u?u._parse(new et(s,o,s.path,i)):null}).filter(o=>!!o);return s.common.async?Promise.all(n).then(o=>Ce.mergeArray(r,o)):Ce.mergeArray(r,n)}get items(){return this._def.items}rest(e){return new a({...this._def,rest:e})}};pt.create=(a,e)=>{if(!Array.isArray(a))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new pt({items:a,typeName:C.ZodTuple,rest:null,...Q(e)})};var Ua=class a extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==N.object)return D(s,{code:T.invalid_type,expected:N.object,received:s.parsedType}),B;let t=[],n=this._def.keyType,o=this._def.valueType;for(let i in s.data)t.push({key:n._parse(new et(s,i,s.path,i)),value:o._parse(new et(s,s.data[i],s.path,i)),alwaysSet:i in s.data});return s.common.async?Ce.mergeObjectAsync(r,t):Ce.mergeObjectSync(r,t)}get element(){return this._def.valueType}static create(e,r,s){return r instanceof G?new a({keyType:e,valueType:r,typeName:C.ZodRecord,...Q(s)}):new a({keyType:Dt.create(),valueType:e,typeName:C.ZodRecord,...Q(r)})}},Dr=class extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==N.map)return D(s,{code:T.invalid_type,expected:N.map,received:s.parsedType}),B;let t=this._def.keyType,n=this._def.valueType,o=[...s.data.entries()].map(([i,u],c)=>({key:t._parse(new et(s,i,s.path,[c,"key"])),value:n._parse(new et(s,u,s.path,[c,"value"]))}));if(s.common.async){let i=new Map;return Promise.resolve().then(async()=>{for(let u of o){let c=await u.key,h=await u.value;if(c.status==="aborted"||h.status==="aborted")return B;(c.status==="dirty"||h.status==="dirty")&&r.dirty(),i.set(c.value,h.value)}return{status:r.value,value:i}})}else{let i=new Map;for(let u of o){let c=u.key,h=u.value;if(c.status==="aborted"||h.status==="aborted")return B;(c.status==="dirty"||h.status==="dirty")&&r.dirty(),i.set(c.value,h.value)}return{status:r.value,value:i}}}};Dr.create=(a,e,r)=>new Dr({valueType:e,keyType:a,typeName:C.ZodMap,...Q(r)});var Nr=class a extends G{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==N.set)return D(s,{code:T.invalid_type,expected:N.set,received:s.parsedType}),B;let t=this._def;t.minSize!==null&&s.data.size<t.minSize.value&&(D(s,{code:T.too_small,minimum:t.minSize.value,type:"set",inclusive:!0,exact:!1,message:t.minSize.message}),r.dirty()),t.maxSize!==null&&s.data.size>t.maxSize.value&&(D(s,{code:T.too_big,maximum:t.maxSize.value,type:"set",inclusive:!0,exact:!1,message:t.maxSize.message}),r.dirty());let n=this._def.valueType;function o(u){let c=new Set;for(let h of u){if(h.status==="aborted")return B;h.status==="dirty"&&r.dirty(),c.add(h.value)}return{status:r.value,value:c}}let i=[...s.data.values()].map((u,c)=>n._parse(new et(s,u,s.path,c)));return s.common.async?Promise.all(i).then(u=>o(u)):o(i)}min(e,r){return new a({...this._def,minSize:{value:e,message:H.toString(r)}})}max(e,r){return new a({...this._def,maxSize:{value:e,message:H.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Nr.create=(a,e)=>new Nr({valueType:a,minSize:null,maxSize:null,typeName:C.ZodSet,...Q(e)});var za=class a extends G{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==N.function)return D(r,{code:T.invalid_type,expected:N.function,received:r.parsedType}),B;function s(i,u){return sa({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Cr(),Et].filter(c=>!!c),issueData:{code:T.invalid_arguments,argumentsError:u}})}function t(i,u){return sa({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Cr(),Et].filter(c=>!!c),issueData:{code:T.invalid_return_type,returnTypeError:u}})}let n={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof jt){let i=this;return $e(async function(...u){let c=new Ue([]),h=await i._def.args.parseAsync(u,n).catch(d=>{throw c.addIssue(s(u,d)),c}),f=await Reflect.apply(o,this,h);return await i._def.returns._def.type.parseAsync(f,n).catch(d=>{throw c.addIssue(t(f,d)),c})})}else{let i=this;return $e(function(...u){let c=i._def.args.safeParse(u,n);if(!c.success)throw new Ue([s(u,c.error)]);let h=Reflect.apply(o,this,c.data),f=i._def.returns.safeParse(h,n);if(!f.success)throw new Ue([t(h,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new a({...this._def,args:pt.create(e).rest(St.create())})}returns(e){return new a({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,s){return new a({args:e||pt.create([]).rest(St.create()),returns:r||St.create(),typeName:C.ZodFunction,...Q(s)})}},or=class extends G{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};or.create=(a,e)=>new or({getter:a,typeName:C.ZodLazy,...Q(e)});var ir=class extends G{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return D(r,{received:r.data,code:T.invalid_literal,expected:this._def.value}),B}return{status:"valid",value:e.data}}get value(){return this._def.value}};ir.create=(a,e)=>new ir({value:a,typeName:C.ZodLiteral,...Q(e)});function Bo(a,e){return new lr({values:a,typeName:C.ZodEnum,...Q(e)})}var lr=class a extends G{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),s=this._def.values;return D(r,{expected:X.joinValues(s),received:r.parsedType,code:T.invalid_type}),B}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),s=this._def.values;return D(r,{received:r.data,code:T.invalid_enum_value,options:s}),B}return $e(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return a.create(e,{...this._def,...r})}exclude(e,r=this._def){return a.create(this.options.filter(s=>!e.includes(s)),{...this._def,...r})}};lr.create=Bo;var cr=class extends G{_parse(e){let r=X.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==N.string&&s.parsedType!==N.number){let t=X.objectValues(r);return D(s,{expected:X.joinValues(t),received:s.parsedType,code:T.invalid_type}),B}if(this._cache||(this._cache=new Set(X.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let t=X.objectValues(r);return D(s,{received:s.data,code:T.invalid_enum_value,options:t}),B}return $e(e.data)}get enum(){return this._def.values}};cr.create=(a,e)=>new cr({values:a,typeName:C.ZodNativeEnum,...Q(e)});var jt=class extends G{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==N.promise&&r.common.async===!1)return D(r,{code:T.invalid_type,expected:N.promise,received:r.parsedType}),B;let s=r.parsedType===N.promise?r.data:Promise.resolve(r.data);return $e(s.then(t=>this._def.type.parseAsync(t,{path:r.path,errorMap:r.common.contextualErrorMap})))}};jt.create=(a,e)=>new jt({type:a,typeName:C.ZodPromise,...Q(e)});var tt=class extends G{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===C.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:s}=this._processInputParams(e),t=this._def.effect||null,n={addIssue:o=>{D(s,o),o.fatal?r.abort():r.dirty()},get path(){return s.path}};if(n.addIssue=n.addIssue.bind(n),t.type==="preprocess"){let o=t.transform(s.data,n);if(s.common.async)return Promise.resolve(o).then(async i=>{if(r.value==="aborted")return B;let u=await this._def.schema._parseAsync({data:i,path:s.path,parent:s});return u.status==="aborted"?B:u.status==="dirty"?Kt(u.value):r.value==="dirty"?Kt(u.value):u});{if(r.value==="aborted")return B;let i=this._def.schema._parseSync({data:o,path:s.path,parent:s});return i.status==="aborted"?B:i.status==="dirty"?Kt(i.value):r.value==="dirty"?Kt(i.value):i}}if(t.type==="refinement"){let o=i=>{let u=t.refinement(i,n);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(s.common.async===!1){let i=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?B:(i.status==="dirty"&&r.dirty(),o(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(i=>i.status==="aborted"?B:(i.status==="dirty"&&r.dirty(),o(i.value).then(()=>({status:r.value,value:i.value}))))}if(t.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!kt(o))return B;let i=t.transform(o.value,n);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:i}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>kt(o)?Promise.resolve(t.transform(o.value,n)).then(i=>({status:r.value,value:i})):B);X.assertNever(t)}};tt.create=(a,e,r)=>new tt({schema:a,typeName:C.ZodEffects,effect:e,...Q(r)});tt.createWithPreprocess=(a,e,r)=>new tt({schema:e,effect:{type:"preprocess",transform:a},typeName:C.ZodEffects,...Q(r)});var Xe=class extends G{_parse(e){return this._getType(e)===N.undefined?$e(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Xe.create=(a,e)=>new Xe({innerType:a,typeName:C.ZodOptional,...Q(e)});var mt=class extends G{_parse(e){return this._getType(e)===N.null?$e(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};mt.create=(a,e)=>new mt({innerType:a,typeName:C.ZodNullable,...Q(e)});var ur=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),s=r.data;return r.parsedType===N.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};ur.create=(a,e)=>new ur({innerType:a,typeName:C.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Q(e)});var dr=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),s={...r,common:{...r.common,issues:[]}},t=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Ir(t)?t.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Ue(s.common.issues)},input:s.data})})):{status:"valid",value:t.status==="valid"?t.value:this._def.catchValue({get error(){return new Ue(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};dr.create=(a,e)=>new dr({innerType:a,typeName:C.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Q(e)});var jr=class extends G{_parse(e){if(this._getType(e)!==N.nan){let s=this._getOrReturnCtx(e);return D(s,{code:T.invalid_type,expected:N.nan,received:s.parsedType}),B}return{status:"valid",value:e.data}}};jr.create=a=>new jr({typeName:C.ZodNaN,...Q(a)});var vh=Symbol("zod_brand"),na=class extends G{_parse(e){let{ctx:r}=this._processInputParams(e),s=r.data;return this._def.type._parse({data:s,path:r.path,parent:r})}unwrap(){return this._def.type}},oa=class a extends G{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?B:n.status==="dirty"?(r.dirty(),Kt(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let t=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return t.status==="aborted"?B:t.status==="dirty"?(r.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:s.path,parent:s})}}static create(e,r){return new a({in:e,out:r,typeName:C.ZodPipeline})}},hr=class extends G{_parse(e){let r=this._def.innerType._parse(e),s=t=>(kt(t)&&(t.value=Object.freeze(t.value)),t);return Ir(r)?r.then(t=>s(t)):s(r)}unwrap(){return this._def.innerType}};hr.create=(a,e)=>new hr({innerType:a,typeName:C.ZodReadonly,...Q(e)});function zo(a,e){let r=typeof a=="function"?a(e):typeof a=="string"?{message:a}:a;return typeof r=="string"?{message:r}:r}function Jo(a,e={},r){return a?Nt.create().superRefine((s,t)=>{var o,i;let n=a(s);if(n instanceof Promise)return n.then(u=>{var c,h;if(!u){let f=zo(e,s),v=(h=(c=f.fatal)!=null?c:r)!=null?h:!0;t.addIssue({code:"custom",...f,fatal:v})}});if(!n){let u=zo(e,s),c=(i=(o=u.fatal)!=null?o:r)!=null?i:!0;t.addIssue({code:"custom",...u,fatal:c})}}):Nt.create()}var gh={object:ze.lazycreate},C;(function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"})(C||(C={}));var yh=(a,e={message:`Input not instance of ${a.name}`})=>Jo(r=>r instanceof a,e),Qo=Dt.create,Wo=Yt.create,_h=jr.create,bh=Xt.create,Go=er.create,wh=tr.create,xh=$r.create,Eh=rr.create,Ph=ar.create,Sh=Nt.create,Rh=St.create,Oh=nt.create,Th=kr.create,Ch=Rt.create,Ih=ze.create,Ah=ze.strictCreate,$h=sr.create,kh=qa.create,Dh=nr.create,Nh=pt.create,jh=Ua.create,Mh=Dr.create,Lh=Nr.create,Fh=za.create,qh=or.create,Uh=ir.create,zh=lr.create,Vh=cr.create,Hh=jt.create,Zh=tt.create,Bh=Xe.create,Jh=mt.create,Qh=tt.createWithPreprocess,Wh=oa.create,Gh=()=>Qo().optional(),Kh=()=>Wo().optional(),Yh=()=>Go().optional(),Xh={string:(a=>Dt.create({...a,coerce:!0})),number:(a=>Yt.create({...a,coerce:!0})),boolean:(a=>er.create({...a,coerce:!0})),bigint:(a=>Xt.create({...a,coerce:!0})),date:(a=>tr.create({...a,coerce:!0}))};var ef=B;var Mt="2025-06-18",Ko="2025-03-26",fr=[Mt,"2025-03-26","2024-11-05","2024-10-07"],Va="2.0",Yo=l.union([l.string(),l.number().int()]),Xo=l.string(),tf=l.object({progressToken:l.optional(Yo)}).passthrough(),rt=l.object({_meta:l.optional(tf)}).passthrough(),Ve=l.object({method:l.string(),params:l.optional(rt)}),ia=l.object({_meta:l.optional(l.object({}).passthrough())}).passthrough(),vt=l.object({method:l.string(),params:l.optional(ia)}),at=l.object({_meta:l.optional(l.object({}).passthrough())}).passthrough(),Ha=l.union([l.string(),l.number().int()]),ei=l.object({jsonrpc:l.literal(Va),id:Ha}).merge(Ve).strict(),pr=a=>ei.safeParse(a).success,ti=l.object({jsonrpc:l.literal(Va)}).merge(vt).strict(),ri=a=>ti.safeParse(a).success,ai=l.object({jsonrpc:l.literal(Va),id:Ha,result:at}).strict(),Ot=a=>ai.safeParse(a).success,Le;(function(a){a[a.ConnectionClosed=-32e3]="ConnectionClosed",a[a.RequestTimeout=-32001]="RequestTimeout",a[a.ParseError=-32700]="ParseError",a[a.InvalidRequest=-32600]="InvalidRequest",a[a.MethodNotFound=-32601]="MethodNotFound",a[a.InvalidParams=-32602]="InvalidParams",a[a.InternalError=-32603]="InternalError"})(Le||(Le={}));var si=l.object({jsonrpc:l.literal(Va),id:Ha,error:l.object({code:l.number().int(),message:l.string(),data:l.optional(l.unknown())})}).strict(),Mr=a=>si.safeParse(a).success,We=l.union([ei,ti,ai,si]),Tt=at.strict(),Za=vt.extend({method:l.literal("notifications/cancelled"),params:ia.extend({requestId:Ha,reason:l.string().optional()})}),la=l.object({name:l.string(),title:l.optional(l.string())}).passthrough(),ni=la.extend({version:l.string()}),rf=l.object({experimental:l.optional(l.object({}).passthrough()),sampling:l.optional(l.object({}).passthrough()),elicitation:l.optional(l.object({}).passthrough()),roots:l.optional(l.object({listChanged:l.optional(l.boolean())}).passthrough())}).passthrough(),Ba=Ve.extend({method:l.literal("initialize"),params:rt.extend({protocolVersion:l.string(),capabilities:rf,clientInfo:ni})}),oi=a=>Ba.safeParse(a).success,af=l.object({experimental:l.optional(l.object({}).passthrough()),logging:l.optional(l.object({}).passthrough()),completions:l.optional(l.object({}).passthrough()),prompts:l.optional(l.object({listChanged:l.optional(l.boolean())}).passthrough()),resources:l.optional(l.object({subscribe:l.optional(l.boolean()),listChanged:l.optional(l.boolean())}).passthrough()),tools:l.optional(l.object({listChanged:l.optional(l.boolean())}).passthrough())}).passthrough(),Bs=at.extend({protocolVersion:l.string(),capabilities:af,serverInfo:ni,instructions:l.optional(l.string())}),Ja=vt.extend({method:l.literal("notifications/initialized")}),ii=a=>Ja.safeParse(a).success,Lr=Ve.extend({method:l.literal("ping")}),sf=l.object({progress:l.number(),total:l.optional(l.number()),message:l.optional(l.string())}).passthrough(),Fr=vt.extend({method:l.literal("notifications/progress"),params:ia.merge(sf).extend({progressToken:Yo})}),Qa=Ve.extend({params:rt.extend({cursor:l.optional(Xo)}).optional()}),Wa=at.extend({nextCursor:l.optional(Xo)}),li=l.object({uri:l.string(),mimeType:l.optional(l.string()),_meta:l.optional(l.object({}).passthrough())}).passthrough(),ci=li.extend({text:l.string()}),Js=l.string().refine(a=>{try{return atob(a),!0}catch{return!1}},{message:"Invalid Base64 string"}),ui=li.extend({blob:Js}),di=la.extend({uri:l.string(),description:l.optional(l.string()),mimeType:l.optional(l.string()),_meta:l.optional(l.object({}).passthrough())}),nf=la.extend({uriTemplate:l.string(),description:l.optional(l.string()),mimeType:l.optional(l.string()),_meta:l.optional(l.object({}).passthrough())}),of=Qa.extend({method:l.literal("resources/list")}),Qs=Wa.extend({resources:l.array(di)}),lf=Qa.extend({method:l.literal("resources/templates/list")}),Ws=Wa.extend({resourceTemplates:l.array(nf)}),cf=Ve.extend({method:l.literal("resources/read"),params:rt.extend({uri:l.string()})}),Gs=at.extend({contents:l.array(l.union([ci,ui]))}),uf=vt.extend({method:l.literal("notifications/resources/list_changed")}),df=Ve.extend({method:l.literal("resources/subscribe"),params:rt.extend({uri:l.string()})}),hf=Ve.extend({method:l.literal("resources/unsubscribe"),params:rt.extend({uri:l.string()})}),ff=vt.extend({method:l.literal("notifications/resources/updated"),params:ia.extend({uri:l.string()})}),pf=l.object({name:l.string(),description:l.optional(l.string()),required:l.optional(l.boolean())}).passthrough(),mf=la.extend({description:l.optional(l.string()),arguments:l.optional(l.array(pf)),_meta:l.optional(l.object({}).passthrough())}),vf=Qa.extend({method:l.literal("prompts/list")}),Ks=Wa.extend({prompts:l.array(mf)}),gf=Ve.extend({method:l.literal("prompts/get"),params:rt.extend({name:l.string(),arguments:l.optional(l.record(l.string()))})}),Ys=l.object({type:l.literal("text"),text:l.string(),_meta:l.optional(l.object({}).passthrough())}).passthrough(),Xs=l.object({type:l.literal("image"),data:Js,mimeType:l.string(),_meta:l.optional(l.object({}).passthrough())}).passthrough(),en=l.object({type:l.literal("audio"),data:Js,mimeType:l.string(),_meta:l.optional(l.object({}).passthrough())}).passthrough(),yf=l.object({type:l.literal("resource"),resource:l.union([ci,ui]),_meta:l.optional(l.object({}).passthrough())}).passthrough(),_f=di.extend({type:l.literal("resource_link")}),hi=l.union([Ys,Xs,en,_f,yf]),bf=l.object({role:l.enum(["user","assistant"]),content:hi}).passthrough(),tn=at.extend({description:l.optional(l.string()),messages:l.array(bf)}),wf=vt.extend({method:l.literal("notifications/prompts/list_changed")}),xf=l.object({title:l.optional(l.string()),readOnlyHint:l.optional(l.boolean()),destructiveHint:l.optional(l.boolean()),idempotentHint:l.optional(l.boolean()),openWorldHint:l.optional(l.boolean())}).passthrough(),Ef=la.extend({description:l.optional(l.string()),inputSchema:l.object({type:l.literal("object"),properties:l.optional(l.object({}).passthrough()),required:l.optional(l.array(l.string()))}).passthrough(),outputSchema:l.optional(l.object({type:l.literal("object"),properties:l.optional(l.object({}).passthrough()),required:l.optional(l.array(l.string()))}).passthrough()),annotations:l.optional(xf),_meta:l.optional(l.object({}).passthrough())}),rn=Qa.extend({method:l.literal("tools/list")}),an=Wa.extend({tools:l.array(Ef)}),Ga=at.extend({content:l.array(hi).default([]),structuredContent:l.object({}).passthrough().optional(),isError:l.optional(l.boolean())}),sy=Ga.or(at.extend({toolResult:l.unknown()})),sn=Ve.extend({method:l.literal("tools/call"),params:rt.extend({name:l.string(),arguments:l.optional(l.record(l.unknown()))})}),Pf=vt.extend({method:l.literal("notifications/tools/list_changed")}),ca=l.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),nn=Ve.extend({method:l.literal("logging/setLevel"),params:rt.extend({level:ca})}),Sf=vt.extend({method:l.literal("notifications/message"),params:ia.extend({level:ca,logger:l.optional(l.string()),data:l.unknown()})}),Rf=l.object({name:l.string().optional()}).passthrough(),Of=l.object({hints:l.optional(l.array(Rf)),costPriority:l.optional(l.number().min(0).max(1)),speedPriority:l.optional(l.number().min(0).max(1)),intelligencePriority:l.optional(l.number().min(0).max(1))}).passthrough(),Tf=l.object({role:l.enum(["user","assistant"]),content:l.union([Ys,Xs,en])}).passthrough(),Cf=Ve.extend({method:l.literal("sampling/createMessage"),params:rt.extend({messages:l.array(Tf),systemPrompt:l.optional(l.string()),includeContext:l.optional(l.enum(["none","thisServer","allServers"])),temperature:l.optional(l.number()),maxTokens:l.number().int(),stopSequences:l.optional(l.array(l.string())),metadata:l.optional(l.object({}).passthrough()),modelPreferences:l.optional(Of)})}),on=at.extend({model:l.string(),stopReason:l.optional(l.enum(["endTurn","stopSequence","maxTokens"]).or(l.string())),role:l.enum(["user","assistant"]),content:l.discriminatedUnion("type",[Ys,Xs,en])}),If=l.object({type:l.literal("boolean"),title:l.optional(l.string()),description:l.optional(l.string()),default:l.optional(l.boolean())}).passthrough(),Af=l.object({type:l.literal("string"),title:l.optional(l.string()),description:l.optional(l.string()),minLength:l.optional(l.number()),maxLength:l.optional(l.number()),format:l.optional(l.enum(["email","uri","date","date-time"]))}).passthrough(),$f=l.object({type:l.enum(["number","integer"]),title:l.optional(l.string()),description:l.optional(l.string()),minimum:l.optional(l.number()),maximum:l.optional(l.number())}).passthrough(),kf=l.object({type:l.literal("string"),title:l.optional(l.string()),description:l.optional(l.string()),enum:l.array(l.string()),enumNames:l.optional(l.array(l.string()))}).passthrough(),Df=l.union([If,Af,$f,kf]),Nf=Ve.extend({method:l.literal("elicitation/create"),params:rt.extend({message:l.string(),requestedSchema:l.object({type:l.literal("object"),properties:l.record(l.string(),Df),required:l.optional(l.array(l.string()))}).passthrough()})}),ln=at.extend({action:l.enum(["accept","decline","cancel"]),content:l.optional(l.record(l.string(),l.unknown()))}),jf=l.object({type:l.literal("ref/resource"),uri:l.string()}).passthrough();var Mf=l.object({type:l.literal("ref/prompt"),name:l.string()}).passthrough(),Lf=Ve.extend({method:l.literal("completion/complete"),params:rt.extend({ref:l.union([Mf,jf]),argument:l.object({name:l.string(),value:l.string()}).passthrough(),context:l.optional(l.object({arguments:l.optional(l.record(l.string(),l.string()))}))})}),cn=at.extend({completion:l.object({values:l.array(l.string()).max(100),total:l.optional(l.number().int()),hasMore:l.optional(l.boolean())}).passthrough()}),Ff=l.object({uri:l.string().startsWith("file://"),name:l.optional(l.string()),_meta:l.optional(l.object({}).passthrough())}).passthrough(),un=Ve.extend({method:l.literal("roots/list")}),dn=at.extend({roots:l.array(Ff)}),qf=vt.extend({method:l.literal("notifications/roots/list_changed")}),ny=l.union([Lr,Ba,Lf,nn,gf,vf,of,lf,cf,df,hf,sn,rn]),oy=l.union([Za,Fr,Ja,qf]),iy=l.union([Tt,on,ln,dn]),ly=l.union([Lr,Cf,Nf,un]),cy=l.union([Za,Fr,Sf,ff,uf,Pf,wf]),uy=l.union([Tt,Bs,cn,tn,Ks,Qs,Ws,Gs,Ga,an]),ke=class extends Error{constructor(e,r,s){super(`MCP error ${e}: ${r}`),this.code=e,this.data=s,this.name="McpError"}};var Uf=6e4,qr=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(Za,r=>{let s=this._requestHandlerAbortControllers.get(r.params.requestId);s==null||s.abort(r.params.reason)}),this.setNotificationHandler(Fr,r=>{this._onprogress(r)}),this.setRequestHandler(Lr,r=>({}))}_setupTimeout(e,r,s,t,n=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(t,r),startTime:Date.now(),timeout:r,maxTotalTimeout:s,resetTimeoutOnProgress:n,onTimeout:t})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let s=Date.now()-r.startTime;if(r.maxTotalTimeout&&s>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),new ke(Le.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:s});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var r,s,t;this._transport=e;let n=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{n==null||n(),this._onclose()};let o=(s=this.transport)===null||s===void 0?void 0:s.onerror;this._transport.onerror=u=>{o==null||o(u),this._onerror(u)};let i=(t=this._transport)===null||t===void 0?void 0:t.onmessage;this._transport.onmessage=(u,c)=>{i==null||i(u,c),Ot(u)||Mr(u)?this._onresponse(u):pr(u)?this._onrequest(u,c):ri(u)?this._onnotification(u):this._onerror(new Error(`Unknown message type: ${JSON.stringify(u)}`))},await this._transport.start()}_onclose(){var e;let r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let s=new ke(Le.ConnectionClosed,"Connection closed");for(let t of r.values())t(s)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;let s=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;s!==void 0&&Promise.resolve().then(()=>s(e)).catch(t=>this._onerror(new Error(`Uncaught error in notification handler: ${t}`)))}_onrequest(e,r){var s,t;let n=(s=this._requestHandlers.get(e.method))!==null&&s!==void 0?s:this.fallbackRequestHandler,o=this._transport;if(n===void 0){o==null||o.send({jsonrpc:"2.0",id:e.id,error:{code:Le.MethodNotFound,message:"Method not found"}}).catch(c=>this._onerror(new Error(`Failed to send an error response: ${c}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);let u={signal:i.signal,sessionId:o==null?void 0:o.sessionId,_meta:(t=e.params)===null||t===void 0?void 0:t._meta,sendNotification:c=>this.notification(c,{relatedRequestId:e.id}),sendRequest:(c,h,f)=>this.request(c,h,{...f,relatedRequestId:e.id}),authInfo:r==null?void 0:r.authInfo,requestId:e.id,requestInfo:r==null?void 0:r.requestInfo};Promise.resolve().then(()=>n(e,u)).then(c=>{if(!i.signal.aborted)return o==null?void 0:o.send({result:c,jsonrpc:"2.0",id:e.id})},c=>{var h;if(!i.signal.aborted)return o==null?void 0:o.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(c.code)?c.code:Le.InternalError,message:(h=c.message)!==null&&h!==void 0?h:"Internal error"}})}).catch(c=>this._onerror(new Error(`Failed to send response: ${c}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...s}=e.params,t=Number(r),n=this._progressHandlers.get(t);if(!n){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let o=this._responseHandlers.get(t),i=this._timeoutInfo.get(t);if(i&&o&&i.resetTimeoutOnProgress)try{this._resetTimeout(t)}catch(u){o(u);return}n(s)}_onresponse(e){let r=Number(e.id),s=this._responseHandlers.get(r);if(s===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(r),this._progressHandlers.delete(r),this._cleanupTimeout(r),Ot(e))s(e);else{let t=new ke(e.error.code,e.error.message,e.error.data);s(t)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,r,s){let{relatedRequestId:t,resumptionToken:n,onresumptiontoken:o}=s!=null?s:{};return new Promise((i,u)=>{var c,h,f,v,d,y;if(!this._transport){u(new Error("Not connected"));return}((c=this._options)===null||c===void 0?void 0:c.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(h=s==null?void 0:s.signal)===null||h===void 0||h.throwIfAborted();let m=this._requestMessageId++,g={...e,jsonrpc:"2.0",id:m};s!=null&&s.onprogress&&(this._progressHandlers.set(m,s.onprogress),g.params={...e.params,_meta:{...((f=e.params)===null||f===void 0?void 0:f._meta)||{},progressToken:m}});let w=R=>{var O;this._responseHandlers.delete(m),this._progressHandlers.delete(m),this._cleanupTimeout(m),(O=this._transport)===null||O===void 0||O.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:m,reason:String(R)}},{relatedRequestId:t,resumptionToken:n,onresumptiontoken:o}).catch(A=>this._onerror(new Error(`Failed to send cancellation: ${A}`))),u(R)};this._responseHandlers.set(m,R=>{var O;if(!(!((O=s==null?void 0:s.signal)===null||O===void 0)&&O.aborted)){if(R instanceof Error)return u(R);try{let A=r.parse(R.result);i(A)}catch(A){u(A)}}}),(v=s==null?void 0:s.signal)===null||v===void 0||v.addEventListener("abort",()=>{var R;w((R=s==null?void 0:s.signal)===null||R===void 0?void 0:R.reason)});let S=(d=s==null?void 0:s.timeout)!==null&&d!==void 0?d:Uf,P=()=>w(new ke(Le.RequestTimeout,"Request timed out",{timeout:S}));this._setupTimeout(m,S,s==null?void 0:s.maxTotalTimeout,P,(y=s==null?void 0:s.resetTimeoutOnProgress)!==null&&y!==void 0?y:!1),this._transport.send(g,{relatedRequestId:t,resumptionToken:n,onresumptiontoken:o}).catch(R=>{this._cleanupTimeout(m),u(R)})})}async notification(e,r){var s,t;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),((t=(s=this._options)===null||s===void 0?void 0:s.debouncedNotificationMethods)!==null&&t!==void 0?t:[]).includes(e.method)&&!e.params&&!(r!=null&&r.relatedRequestId)){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var u;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let c={...e,jsonrpc:"2.0"};(u=this._transport)===null||u===void 0||u.send(c,r).catch(h=>this._onerror(h))});return}let i={...e,jsonrpc:"2.0"};await this._transport.send(i,r)}setRequestHandler(e,r){let s=e.shape.method.value;this.assertRequestHandlerCapability(s),this._requestHandlers.set(s,(t,n)=>Promise.resolve(r(e.parse(t),n)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){this._notificationHandlers.set(e.shape.method.value,s=>Promise.resolve(r(e.parse(s))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};function Ka(a,e){return Object.entries(e).reduce((r,[s,t])=>(t&&typeof t=="object"?r[s]=r[s]?{...r[s],...t}:t:r[s]=t,r),{...a})}var fc=ht(jn(),1),vs=class extends qr{constructor(e,r){var s;super(r),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._capabilities=(s=r==null?void 0:r.capabilities)!==null&&s!==void 0?s:{},this._ajv=new fc.default}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Ka(this._capabilities,e)}assertCapability(e,r){var s;if(!(!((s=this._serverCapabilities)===null||s===void 0)&&s[e]))throw new Error(`Server does not support ${e} (required for ${r})`)}async connect(e,r){if(await super.connect(e),e.sessionId===void 0)try{let s=await this.request({method:"initialize",params:{protocolVersion:Mt,capabilities:this._capabilities,clientInfo:this._clientInfo}},Bs,r);if(s===void 0)throw new Error(`Server sent invalid initialize result: ${s}`);if(!fr.includes(s.protocolVersion))throw new Error(`Server's protocol version is not supported: ${s.protocolVersion}`);this._serverCapabilities=s.capabilities,this._serverVersion=s.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(s.protocolVersion),this._instructions=s.instructions,await this.notification({method:"notifications/initialized"})}catch(s){throw this.close(),s}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var r,s,t,n,o;switch(e){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(!((s=this._serverCapabilities)===null||s===void 0)&&s.prompts))throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((t=this._serverCapabilities)===null||t===void 0)&&t.resources))throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.tools))throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(!((o=this._serverCapabilities)===null||o===void 0)&&o.completions))throw new Error(`Server does not support completions (required for ${e})`);break;case"initialize":break;case"ping":break}}assertNotificationCapability(e){var r;switch(e){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break;case"notifications/initialized":break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"ping":break}}async ping(e){return this.request({method:"ping"},Tt,e)}async complete(e,r){return this.request({method:"completion/complete",params:e},cn,r)}async setLoggingLevel(e,r){return this.request({method:"logging/setLevel",params:{level:e}},Tt,r)}async getPrompt(e,r){return this.request({method:"prompts/get",params:e},tn,r)}async listPrompts(e,r){return this.request({method:"prompts/list",params:e},Ks,r)}async listResources(e,r){return this.request({method:"resources/list",params:e},Qs,r)}async listResourceTemplates(e,r){return this.request({method:"resources/templates/list",params:e},Ws,r)}async readResource(e,r){return this.request({method:"resources/read",params:e},Gs,r)}async subscribeResource(e,r){return this.request({method:"resources/subscribe",params:e},Tt,r)}async unsubscribeResource(e,r){return this.request({method:"resources/unsubscribe",params:e},Tt,r)}async callTool(e,r=Ga,s){let t=await this.request({method:"tools/call",params:e},r,s),n=this.getToolOutputValidator(e.name);if(n){if(!t.structuredContent&&!t.isError)throw new ke(Le.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(t.structuredContent)try{if(!n(t.structuredContent))throw new ke(Le.InvalidParams,`Structured content does not match the tool's output schema: ${this._ajv.errorsText(n.errors)}`)}catch(o){throw o instanceof ke?o:new ke(Le.InvalidParams,`Failed to validate structured content: ${o instanceof Error?o.message:String(o)}`)}}return t}cacheToolOutputSchemas(e){this._cachedToolOutputValidators.clear();for(let r of e)if(r.outputSchema)try{let s=this._ajv.compile(r.outputSchema);this._cachedToolOutputValidators.set(r.name,s)}catch{}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,r){let s=await this.request({method:"tools/list",params:e},an,r);return this.cacheToolOutputSchemas(s.tools),s}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}};var pc=ht(jn(),1),gs=class extends qr{constructor(e,r){var s;super(r),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(ca.options.map((t,n)=>[t,n])),this.isMessageIgnored=(t,n)=>{let o=this._loggingLevels.get(n);return o?this.LOG_LEVEL_SEVERITY.get(t)<this.LOG_LEVEL_SEVERITY.get(o):!1},this._capabilities=(s=r==null?void 0:r.capabilities)!==null&&s!==void 0?s:{},this._instructions=r==null?void 0:r.instructions,this.setRequestHandler(Ba,t=>this._oninitialize(t)),this.setNotificationHandler(Ja,()=>{var t;return(t=this.oninitialized)===null||t===void 0?void 0:t.call(this)}),this._capabilities.logging&&this.setRequestHandler(nn,async(t,n)=>{var o;let i=n.sessionId||((o=n.requestInfo)===null||o===void 0?void 0:o.headers["mcp-session-id"])||void 0,{level:u}=t.params,c=ca.safeParse(u);return i&&c.success&&this._loggingLevels.set(i,c.data),{}})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Ka(this._capabilities,e)}assertCapabilityForMethod(e){var r,s,t;switch(e){case"sampling/createMessage":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(!((s=this._clientCapabilities)===null||s===void 0)&&s.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"ping":case"initialize":break}}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:fr.includes(r)?r:Mt,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},Tt)}async createMessage(e,r){return this.request({method:"sampling/createMessage",params:e},on,r)}async elicitInput(e,r){let s=await this.request({method:"elicitation/create",params:e},ln,r);if(s.action==="accept"&&s.content)try{let t=new pc.default,n=t.compile(e.requestedSchema);if(!n(s.content))throw new ke(Le.InvalidParams,`Elicitation response content does not match requested schema: ${t.errorsText(n.errors)}`)}catch(t){throw t instanceof ke?t:new ke(Le.InternalError,`Error validating elicitation response: ${t}`)}return s}async listRoots(e,r){return this.request({method:"roots/list",params:e},dn,r)}async sendLoggingMessage(e,r){if(this._capabilities.logging&&(!r||!this.isMessageIgnored(e.level,r)))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var ys=class extends Error{constructor(e,r){super(e),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}};function Mn(a){}function _s(a){if(typeof a=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:e=Mn,onError:r=Mn,onRetry:s=Mn,onComment:t}=a,n="",o=!0,i,u="",c="";function h(m){let g=o?m.replace(/^\xEF\xBB\xBF/,""):m,[w,S]=bm(`${n}${g}`);for(let P of w)f(P);n=S,o=!1}function f(m){if(m===""){d();return}if(m.startsWith(":")){t&&t(m.slice(m.startsWith(": ")?2:1));return}let g=m.indexOf(":");if(g!==-1){let w=m.slice(0,g),S=m[g+1]===" "?2:1,P=m.slice(g+S);v(w,P,m);return}v(m,"",m)}function v(m,g,w){switch(m){case"event":c=g;break;case"data":u=`${u}${g}
`;break;case"id":i=g.includes("\0")?void 0:g;break;case"retry":/^\d+$/.test(g)?s(parseInt(g,10)):r(new ys(`Invalid \`retry\` value: "${g}"`,{type:"invalid-retry",value:g,line:w}));break;default:r(new ys(`Unknown field "${m.length>20?`${m.slice(0,20)}\u2026`:m}"`,{type:"unknown-field",field:m,value:g,line:w}));break}}function d(){u.length>0&&e({id:i,event:c||void 0,data:u.endsWith(`
`)?u.slice(0,-1):u}),i=void 0,u="",c=""}function y(m={}){n&&m.consume&&f(n),o=!0,i=void 0,u="",c="",n=""}return{feed:h,reset:y}}function bm(a){let e=[],r="",s=0;for(;s<a.length;){let t=a.indexOf("\r",s),n=a.indexOf(`
`,s),o=-1;if(t!==-1&&n!==-1?o=Math.min(t,n):t!==-1?o=t:n!==-1&&(o=n),o===-1){r=a.slice(s);break}else{let i=a.slice(s,o);e.push(i),s=o+1,a[s-1]==="\r"&&a[s]===`
`&&s++}}return[e,r]}var ws=class extends Event{constructor(e,r){var s,t;super(e),this.code=(s=r==null?void 0:r.code)!=null?s:void 0,this.message=(t=r==null?void 0:r.message)!=null?t:void 0}[Symbol.for("nodejs.util.inspect.custom")](e,r,s){return s(mc(this),r)}[Symbol.for("Deno.customInspect")](e,r){return e(mc(this),r)}};function wm(a){let e=globalThis.DOMException;return typeof e=="function"?new e(a,"SyntaxError"):new SyntaxError(a)}function Ln(a){return a instanceof Error?"errors"in a&&Array.isArray(a.errors)?a.errors.map(Ln).join(", "):"cause"in a&&a.cause instanceof Error?`${a}: ${Ln(a.cause)}`:a.message:`${a}`}function mc(a){return{type:a.type,message:a.message,code:a.code,defaultPrevented:a.defaultPrevented,cancelable:a.cancelable,timeStamp:a.timeStamp}}var gc=a=>{throw TypeError(a)},Bn=(a,e,r)=>e.has(a)||gc("Cannot "+r),ee=(a,e,r)=>(Bn(a,e,"read from private field"),r?r.call(a):e.get(a)),Se=(a,e,r)=>e.has(a)?gc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,r),fe=(a,e,r,s)=>(Bn(a,e,"write to private field"),e.set(a,r),r),Ct=(a,e,r)=>(Bn(a,e,"access private method"),r),He,gr,Ur,bs,xs,fa,Hr,pa,Ut,zr,Zr,Vr,da,ot,Fn,qn,Un,vc,zn,Vn,ha,Hn,Zn,yr=class extends EventTarget{constructor(e,r){var s,t;super(),Se(this,ot),this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,Se(this,He),Se(this,gr),Se(this,Ur),Se(this,bs),Se(this,xs),Se(this,fa),Se(this,Hr),Se(this,pa,null),Se(this,Ut),Se(this,zr),Se(this,Zr,null),Se(this,Vr,null),Se(this,da,null),Se(this,qn,async n=>{var o;ee(this,zr).reset();let{body:i,redirected:u,status:c,headers:h}=n;if(c===204){Ct(this,ot,ha).call(this,"Server sent HTTP 204, not reconnecting",204),this.close();return}if(u?fe(this,Ur,new URL(n.url)):fe(this,Ur,void 0),c!==200){Ct(this,ot,ha).call(this,`Non-200 status code (${c})`,c);return}if(!(h.get("content-type")||"").startsWith("text/event-stream")){Ct(this,ot,ha).call(this,'Invalid content type, expected "text/event-stream"',c);return}if(ee(this,He)===this.CLOSED)return;fe(this,He,this.OPEN);let f=new Event("open");if((o=ee(this,da))==null||o.call(this,f),this.dispatchEvent(f),typeof i!="object"||!i||!("getReader"in i)){Ct(this,ot,ha).call(this,"Invalid response body, expected a web ReadableStream",c),this.close();return}let v=new TextDecoder,d=i.getReader(),y=!0;do{let{done:m,value:g}=await d.read();g&&ee(this,zr).feed(v.decode(g,{stream:!m})),m&&(y=!1,ee(this,zr).reset(),Ct(this,ot,Hn).call(this))}while(y)}),Se(this,Un,n=>{fe(this,Ut,void 0),!(n.name==="AbortError"||n.type==="aborted")&&Ct(this,ot,Hn).call(this,Ln(n))}),Se(this,zn,n=>{typeof n.id=="string"&&fe(this,pa,n.id);let o=new MessageEvent(n.event||"message",{data:n.data,origin:ee(this,Ur)?ee(this,Ur).origin:ee(this,gr).origin,lastEventId:n.id||""});ee(this,Vr)&&(!n.event||n.event==="message")&&ee(this,Vr).call(this,o),this.dispatchEvent(o)}),Se(this,Vn,n=>{fe(this,fa,n)}),Se(this,Zn,()=>{fe(this,Hr,void 0),ee(this,He)===this.CONNECTING&&Ct(this,ot,Fn).call(this)});try{if(e instanceof URL)fe(this,gr,e);else if(typeof e=="string")fe(this,gr,new URL(e,xm()));else throw new Error("Invalid URL")}catch{throw wm("An invalid or illegal string was specified")}fe(this,zr,_s({onEvent:ee(this,zn),onRetry:ee(this,Vn)})),fe(this,He,this.CONNECTING),fe(this,fa,3e3),fe(this,xs,(s=r==null?void 0:r.fetch)!=null?s:globalThis.fetch),fe(this,bs,(t=r==null?void 0:r.withCredentials)!=null?t:!1),Ct(this,ot,Fn).call(this)}get readyState(){return ee(this,He)}get url(){return ee(this,gr).href}get withCredentials(){return ee(this,bs)}get onerror(){return ee(this,Zr)}set onerror(e){fe(this,Zr,e)}get onmessage(){return ee(this,Vr)}set onmessage(e){fe(this,Vr,e)}get onopen(){return ee(this,da)}set onopen(e){fe(this,da,e)}addEventListener(e,r,s){let t=r;super.addEventListener(e,t,s)}removeEventListener(e,r,s){let t=r;super.removeEventListener(e,t,s)}close(){ee(this,Hr)&&clearTimeout(ee(this,Hr)),ee(this,He)!==this.CLOSED&&(ee(this,Ut)&&ee(this,Ut).abort(),fe(this,He,this.CLOSED),fe(this,Ut,void 0))}};He=new WeakMap,gr=new WeakMap,Ur=new WeakMap,bs=new WeakMap,xs=new WeakMap,fa=new WeakMap,Hr=new WeakMap,pa=new WeakMap,Ut=new WeakMap,zr=new WeakMap,Zr=new WeakMap,Vr=new WeakMap,da=new WeakMap,ot=new WeakSet,Fn=function(){fe(this,He,this.CONNECTING),fe(this,Ut,new AbortController),ee(this,xs)(ee(this,gr),Ct(this,ot,vc).call(this)).then(ee(this,qn)).catch(ee(this,Un))},qn=new WeakMap,Un=new WeakMap,vc=function(){var a;let e={mode:"cors",redirect:"follow",headers:{Accept:"text/event-stream",...ee(this,pa)?{"Last-Event-ID":ee(this,pa)}:void 0},cache:"no-store",signal:(a=ee(this,Ut))==null?void 0:a.signal};return"window"in globalThis&&(e.credentials=this.withCredentials?"include":"same-origin"),e},zn=new WeakMap,Vn=new WeakMap,ha=function(a,e){var r;ee(this,He)!==this.CLOSED&&fe(this,He,this.CLOSED);let s=new ws("error",{code:e,message:a});(r=ee(this,Zr))==null||r.call(this,s),this.dispatchEvent(s)},Hn=function(a,e){var r;if(ee(this,He)===this.CLOSED)return;fe(this,He,this.CONNECTING);let s=new ws("error",{code:e,message:a});(r=ee(this,Zr))==null||r.call(this,s),this.dispatchEvent(s),fe(this,Hr,setTimeout(ee(this,Zn),ee(this,fa)))},Zn=new WeakMap,yr.CONNECTING=0,yr.OPEN=1,yr.CLOSED=2;function xm(){let a="document"in globalThis?globalThis.document:void 0;return a&&typeof a=="object"&&"baseURI"in a&&typeof a.baseURI=="string"?a.baseURI:void 0}var Jn,yc,_c,bc;Jn=(bc=(_c=(yc=globalThis.crypto)==null?void 0:yc.webcrypto)!=null?_c:globalThis.crypto)!=null?bc:import("node:crypto").then(a=>a.webcrypto);async function Em(a){return(await Jn).getRandomValues(new Uint8Array(a))}async function Pm(a){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~",r="",s=await Em(a);for(let t=0;t<a;t++){let n=s[t]%e.length;r+=e[n]}return r}async function Sm(a){return await Pm(a)}async function Rm(a){let e=await(await Jn).subtle.digest("SHA-256",new TextEncoder().encode(a));return btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function Qn(a){if(a||(a=43),a<43||a>128)throw`Expected a length between 43 and 128. Received ${a}.`;let e=await Sm(a),r=await Rm(e);return{code_verifier:e,code_challenge:r}}var Oe=l.string().url().superRefine((a,e)=>{if(!URL.canParse(a))return e.addIssue({code:l.ZodIssueCode.custom,message:"URL must be parseable",fatal:!0}),l.NEVER}).refine(a=>{let e=new URL(a);return e.protocol!=="javascript:"&&e.protocol!=="data:"&&e.protocol!=="vbscript:"},{message:"URL cannot use javascript:, data:, or vbscript: scheme"}),wc=l.object({resource:l.string().url(),authorization_servers:l.array(Oe).optional(),jwks_uri:l.string().url().optional(),scopes_supported:l.array(l.string()).optional(),bearer_methods_supported:l.array(l.string()).optional(),resource_signing_alg_values_supported:l.array(l.string()).optional(),resource_name:l.string().optional(),resource_documentation:l.string().optional(),resource_policy_uri:l.string().url().optional(),resource_tos_uri:l.string().url().optional(),tls_client_certificate_bound_access_tokens:l.boolean().optional(),authorization_details_types_supported:l.array(l.string()).optional(),dpop_signing_alg_values_supported:l.array(l.string()).optional(),dpop_bound_access_tokens_required:l.boolean().optional()}).passthrough(),Wn=l.object({issuer:l.string(),authorization_endpoint:Oe,token_endpoint:Oe,registration_endpoint:Oe.optional(),scopes_supported:l.array(l.string()).optional(),response_types_supported:l.array(l.string()),response_modes_supported:l.array(l.string()).optional(),grant_types_supported:l.array(l.string()).optional(),token_endpoint_auth_methods_supported:l.array(l.string()).optional(),token_endpoint_auth_signing_alg_values_supported:l.array(l.string()).optional(),service_documentation:Oe.optional(),revocation_endpoint:Oe.optional(),revocation_endpoint_auth_methods_supported:l.array(l.string()).optional(),revocation_endpoint_auth_signing_alg_values_supported:l.array(l.string()).optional(),introspection_endpoint:l.string().optional(),introspection_endpoint_auth_methods_supported:l.array(l.string()).optional(),introspection_endpoint_auth_signing_alg_values_supported:l.array(l.string()).optional(),code_challenge_methods_supported:l.array(l.string()).optional()}).passthrough(),Om=l.object({issuer:l.string(),authorization_endpoint:Oe,token_endpoint:Oe,userinfo_endpoint:Oe.optional(),jwks_uri:Oe,registration_endpoint:Oe.optional(),scopes_supported:l.array(l.string()).optional(),response_types_supported:l.array(l.string()),response_modes_supported:l.array(l.string()).optional(),grant_types_supported:l.array(l.string()).optional(),acr_values_supported:l.array(l.string()).optional(),subject_types_supported:l.array(l.string()),id_token_signing_alg_values_supported:l.array(l.string()),id_token_encryption_alg_values_supported:l.array(l.string()).optional(),id_token_encryption_enc_values_supported:l.array(l.string()).optional(),userinfo_signing_alg_values_supported:l.array(l.string()).optional(),userinfo_encryption_alg_values_supported:l.array(l.string()).optional(),userinfo_encryption_enc_values_supported:l.array(l.string()).optional(),request_object_signing_alg_values_supported:l.array(l.string()).optional(),request_object_encryption_alg_values_supported:l.array(l.string()).optional(),request_object_encryption_enc_values_supported:l.array(l.string()).optional(),token_endpoint_auth_methods_supported:l.array(l.string()).optional(),token_endpoint_auth_signing_alg_values_supported:l.array(l.string()).optional(),display_values_supported:l.array(l.string()).optional(),claim_types_supported:l.array(l.string()).optional(),claims_supported:l.array(l.string()).optional(),service_documentation:l.string().optional(),claims_locales_supported:l.array(l.string()).optional(),ui_locales_supported:l.array(l.string()).optional(),claims_parameter_supported:l.boolean().optional(),request_parameter_supported:l.boolean().optional(),request_uri_parameter_supported:l.boolean().optional(),require_request_uri_registration:l.boolean().optional(),op_policy_uri:Oe.optional(),op_tos_uri:Oe.optional()}).passthrough(),xc=Om.merge(Wn.pick({code_challenge_methods_supported:!0})),Gn=l.object({access_token:l.string(),id_token:l.string().optional(),token_type:l.string(),expires_in:l.number().optional(),scope:l.string().optional(),refresh_token:l.string().optional()}).strip(),Ec=l.object({error:l.string(),error_description:l.string().optional(),error_uri:l.string().optional()}),Tm=l.object({redirect_uris:l.array(Oe),token_endpoint_auth_method:l.string().optional(),grant_types:l.array(l.string()).optional(),response_types:l.array(l.string()).optional(),client_name:l.string().optional(),client_uri:Oe.optional(),logo_uri:Oe.optional(),scope:l.string().optional(),contacts:l.array(l.string()).optional(),tos_uri:Oe.optional(),policy_uri:l.string().optional(),jwks_uri:Oe.optional(),jwks:l.any().optional(),software_id:l.string().optional(),software_version:l.string().optional(),software_statement:l.string().optional()}).strip(),Cm=l.object({client_id:l.string(),client_secret:l.string().optional(),client_id_issued_at:l.number().optional(),client_secret_expires_at:l.number().optional()}).strip(),Pc=Tm.merge(Cm),v_=l.object({error:l.string(),error_description:l.string().optional()}).strip(),g_=l.object({token:l.string(),token_type_hint:l.string().optional()}).strip();function Sc(a){let e=typeof a=="string"?new URL(a):new URL(a.href);return e.hash="",e}function Rc({requestedResource:a,configuredResource:e}){let r=typeof a=="string"?new URL(a):new URL(a.href),s=typeof e=="string"?new URL(e):new URL(e.href);if(r.origin!==s.origin||r.pathname.length<s.pathname.length)return!1;let t=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",n=s.pathname.endsWith("/")?s.pathname:s.pathname+"/";return t.startsWith(n)}var Pe=class extends Error{constructor(e,r){super(e),this.errorUri=r,this.name=this.constructor.name}toResponseObject(){let e={error:this.errorCode,error_description:this.message};return this.errorUri&&(e.error_uri=this.errorUri),e}get errorCode(){return this.constructor.errorCode}},ma=class extends Pe{};ma.errorCode="invalid_request";var _r=class extends Pe{};_r.errorCode="invalid_client";var br=class extends Pe{};br.errorCode="invalid_grant";var wr=class extends Pe{};wr.errorCode="unauthorized_client";var va=class extends Pe{};va.errorCode="unsupported_grant_type";var ga=class extends Pe{};ga.errorCode="invalid_scope";var ya=class extends Pe{};ya.errorCode="access_denied";var It=class extends Pe{};It.errorCode="server_error";var _a=class extends Pe{};_a.errorCode="temporarily_unavailable";var ba=class extends Pe{};ba.errorCode="unsupported_response_type";var wa=class extends Pe{};wa.errorCode="unsupported_token_type";var xa=class extends Pe{};xa.errorCode="invalid_token";var Ea=class extends Pe{};Ea.errorCode="method_not_allowed";var Pa=class extends Pe{};Pa.errorCode="too_many_requests";var Sa=class extends Pe{};Sa.errorCode="invalid_client_metadata";var Ra=class extends Pe{};Ra.errorCode="insufficient_scope";var Oc={[ma.errorCode]:ma,[_r.errorCode]:_r,[br.errorCode]:br,[wr.errorCode]:wr,[va.errorCode]:va,[ga.errorCode]:ga,[ya.errorCode]:ya,[It.errorCode]:It,[_a.errorCode]:_a,[ba.errorCode]:ba,[wa.errorCode]:wa,[xa.errorCode]:xa,[Ea.errorCode]:Ea,[Pa.errorCode]:Pa,[Sa.errorCode]:Sa,[Ra.errorCode]:Ra};var Ze=class extends Error{constructor(e){super(e!=null?e:"Unauthorized")}};function Cc(a,e){let r=a.client_secret!==void 0;return e.length===0?r?"client_secret_post":"none":r&&e.includes("client_secret_basic")?"client_secret_basic":r&&e.includes("client_secret_post")?"client_secret_post":e.includes("none")?"none":r?"client_secret_post":"none"}function Ic(a,e,r,s){let{client_id:t,client_secret:n}=e;switch(a){case"client_secret_basic":Im(t,n,r);return;case"client_secret_post":Am(t,n,s);return;case"none":$m(t,s);return;default:throw new Error(`Unsupported client authentication method: ${a}`)}}function Im(a,e,r){if(!e)throw new Error("client_secret_basic authentication requires a client_secret");let s=btoa(`${a}:${e}`);r.set("Authorization",`Basic ${s}`)}function Am(a,e,r){r.set("client_id",a),e&&r.set("client_secret",e)}function $m(a,e){e.set("client_id",a)}async function Yn(a){let e=a instanceof Response?a.status:void 0,r=a instanceof Response?await a.text():a;try{let s=Ec.parse(JSON.parse(r)),{error:t,error_description:n,error_uri:o}=s,i=Oc[t]||It;return new i(n||"",o)}catch(s){let t=`${e?`HTTP ${e}: `:""}Invalid OAuth error response: ${s}. Raw body: ${r}`;return new It(t)}}async function zt(a,e){var r,s;try{return await Kn(a,e)}catch(t){if(t instanceof _r||t instanceof wr)return await((r=a.invalidateCredentials)===null||r===void 0?void 0:r.call(a,"all")),await Kn(a,e);if(t instanceof br)return await((s=a.invalidateCredentials)===null||s===void 0?void 0:s.call(a,"tokens")),await Kn(a,e);throw t}}async function Kn(a,{serverUrl:e,authorizationCode:r,scope:s,resourceMetadataUrl:t,fetchFn:n}){let o,i;try{o=await Dm(e,{resourceMetadataUrl:t},n),o.authorization_servers&&o.authorization_servers.length>0&&(i=o.authorization_servers[0])}catch{}i||(i=e);let u=await km(e,a,o),c=await Fm(i,{fetchFn:n}),h=await Promise.resolve(a.clientInformation());if(!h){if(r!==void 0)throw new Error("Existing OAuth client information is required when exchanging an authorization code");if(!a.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");let m=await Vm(i,{metadata:c,clientMetadata:a.clientMetadata,fetchFn:n});await a.saveClientInformation(m),h=m}if(r!==void 0){let m=await a.codeVerifier(),g=await Um(i,{metadata:c,clientInformation:h,authorizationCode:r,codeVerifier:m,redirectUri:a.redirectUrl,resource:u,addClientAuthentication:a.addClientAuthentication,fetchFn:n});return await a.saveTokens(g),"AUTHORIZED"}let f=await a.tokens();if(f!=null&&f.refresh_token)try{let m=await zm(i,{metadata:c,clientInformation:h,refreshToken:f.refresh_token,resource:u,addClientAuthentication:a.addClientAuthentication,fetchFn:n});return await a.saveTokens(m),"AUTHORIZED"}catch(m){if(!(!(m instanceof Pe)||m instanceof It))throw m}let v=a.state?await a.state():void 0,{authorizationUrl:d,codeVerifier:y}=await qm(i,{metadata:c,clientInformation:h,state:v,redirectUrl:a.redirectUrl,scope:s||a.clientMetadata.scope,resource:u});return await a.saveCodeVerifier(y),await a.redirectToAuthorization(d),"REDIRECT"}async function km(a,e,r){let s=Sc(a);if(e.validateResourceURL)return await e.validateResourceURL(s,r==null?void 0:r.resource);if(r){if(!Rc({requestedResource:s,configuredResource:r.resource}))throw new Error(`Protected resource ${r.resource} does not match expected ${s} (or origin)`);return new URL(r.resource)}}function Oa(a){let e=a.headers.get("WWW-Authenticate");if(!e)return;let[r,s]=e.split(" ");if(r.toLowerCase()!=="bearer"||!s)return;let n=/resource_metadata="([^"]*)"/.exec(e);if(n)try{return new URL(n[1])}catch{return}}async function Dm(a,e,r=fetch){let s=await Mm(a,"oauth-protected-resource",r,{protocolVersion:e==null?void 0:e.protocolVersion,metadataUrl:e==null?void 0:e.resourceMetadataUrl});if(!s||s.status===404)throw new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!s.ok)throw new Error(`HTTP ${s.status} trying to load well-known OAuth protected resource metadata.`);return wc.parse(await s.json())}async function Xn(a,e,r=fetch){try{return await r(a,{headers:e})}catch(s){if(s instanceof TypeError)return e?Xn(a,void 0,r):void 0;throw s}}function Nm(a,e="",r={}){return e.endsWith("/")&&(e=e.slice(0,-1)),r.prependPathname?`${e}/.well-known/${a}`:`/.well-known/${a}${e}`}async function Tc(a,e,r=fetch){return await Xn(a,{"MCP-Protocol-Version":e},r)}function jm(a,e){return!a||a.status>=400&&a.status<500&&e!=="/"}async function Mm(a,e,r,s){var t,n;let o=new URL(a),i=(t=s==null?void 0:s.protocolVersion)!==null&&t!==void 0?t:Mt,u;if(s!=null&&s.metadataUrl)u=new URL(s.metadataUrl);else{let h=Nm(e,o.pathname);u=new URL(h,(n=s==null?void 0:s.metadataServerUrl)!==null&&n!==void 0?n:o),u.search=o.search}let c=await Tc(u,i,r);if(!(s!=null&&s.metadataUrl)&&jm(c,o.pathname)){let h=new URL(`/.well-known/${e}`,o);c=await Tc(h,i,r)}return c}function Lm(a){let e=typeof a=="string"?new URL(a):a,r=e.pathname!=="/",s=[];if(!r)return s.push({url:new URL("/.well-known/oauth-authorization-server",e.origin),type:"oauth"}),s.push({url:new URL("/.well-known/openid-configuration",e.origin),type:"oidc"}),s;let t=e.pathname;return t.endsWith("/")&&(t=t.slice(0,-1)),s.push({url:new URL(`/.well-known/oauth-authorization-server${t}`,e.origin),type:"oauth"}),s.push({url:new URL("/.well-known/oauth-authorization-server",e.origin),type:"oauth"}),s.push({url:new URL(`/.well-known/openid-configuration${t}`,e.origin),type:"oidc"}),s.push({url:new URL(`${t}/.well-known/openid-configuration`,e.origin),type:"oidc"}),s}async function Fm(a,{fetchFn:e=fetch,protocolVersion:r=Mt}={}){var s;let t={"MCP-Protocol-Version":r},n=Lm(a);for(let{url:o,type:i}of n){let u=await Xn(o,t,e);if(u){if(!u.ok){if(u.status>=400&&u.status<500)continue;throw new Error(`HTTP ${u.status} trying to load ${i==="oauth"?"OAuth":"OpenID provider"} metadata from ${o}`)}if(i==="oauth")return Wn.parse(await u.json());{let c=xc.parse(await u.json());if(!(!((s=c.code_challenge_methods_supported)===null||s===void 0)&&s.includes("S256")))throw new Error(`Incompatible OIDC provider at ${o}: does not support S256 code challenge method required by MCP specification`);return c}}}}async function qm(a,{metadata:e,clientInformation:r,redirectUrl:s,scope:t,state:n,resource:o}){let i="code",u="S256",c;if(e){if(c=new URL(e.authorization_endpoint),!e.response_types_supported.includes(i))throw new Error(`Incompatible auth server: does not support response type ${i}`);if(!e.code_challenge_methods_supported||!e.code_challenge_methods_supported.includes(u))throw new Error(`Incompatible auth server: does not support code challenge method ${u}`)}else c=new URL("/authorize",a);let h=await Qn(),f=h.code_verifier,v=h.code_challenge;return c.searchParams.set("response_type",i),c.searchParams.set("client_id",r.client_id),c.searchParams.set("code_challenge",v),c.searchParams.set("code_challenge_method",u),c.searchParams.set("redirect_uri",String(s)),n&&c.searchParams.set("state",n),t&&c.searchParams.set("scope",t),t!=null&&t.includes("offline_access")&&c.searchParams.append("prompt","consent"),o&&c.searchParams.set("resource",o.href),{authorizationUrl:c,codeVerifier:f}}async function Um(a,{metadata:e,clientInformation:r,authorizationCode:s,codeVerifier:t,redirectUri:n,resource:o,addClientAuthentication:i,fetchFn:u}){var c;let h="authorization_code",f=e!=null&&e.token_endpoint?new URL(e.token_endpoint):new URL("/token",a);if(e!=null&&e.grant_types_supported&&!e.grant_types_supported.includes(h))throw new Error(`Incompatible auth server: does not support grant type ${h}`);let v=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}),d=new URLSearchParams({grant_type:h,code:s,code_verifier:t,redirect_uri:String(n)});if(i)i(v,d,a,e);else{let m=(c=e==null?void 0:e.token_endpoint_auth_methods_supported)!==null&&c!==void 0?c:[],g=Cc(r,m);Ic(g,r,v,d)}o&&d.set("resource",o.href);let y=await(u!=null?u:fetch)(f,{method:"POST",headers:v,body:d});if(!y.ok)throw await Yn(y);return Gn.parse(await y.json())}async function zm(a,{metadata:e,clientInformation:r,refreshToken:s,resource:t,addClientAuthentication:n,fetchFn:o}){var i;let u="refresh_token",c;if(e){if(c=new URL(e.token_endpoint),e.grant_types_supported&&!e.grant_types_supported.includes(u))throw new Error(`Incompatible auth server: does not support grant type ${u}`)}else c=new URL("/token",a);let h=new Headers({"Content-Type":"application/x-www-form-urlencoded"}),f=new URLSearchParams({grant_type:u,refresh_token:s});if(n)n(h,f,a,e);else{let d=(i=e==null?void 0:e.token_endpoint_auth_methods_supported)!==null&&i!==void 0?i:[],y=Cc(r,d);Ic(y,r,h,f)}t&&f.set("resource",t.href);let v=await(o!=null?o:fetch)(c,{method:"POST",headers:h,body:f});if(!v.ok)throw await Yn(v);return Gn.parse({refresh_token:s,...await v.json()})}async function Vm(a,{metadata:e,clientMetadata:r,fetchFn:s}){let t;if(e){if(!e.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");t=new URL(e.registration_endpoint)}else t=new URL("/register",a);let n=await(s!=null?s:fetch)(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok)throw await Yn(n);return Pc.parse(await n.json())}var eo=class extends Error{constructor(e,r,s){super(`SSE error: ${r}`),this.code=e,this.event=s}},Es=class{constructor(e,r){this._url=e,this._resourceMetadataUrl=void 0,this._eventSourceInit=r==null?void 0:r.eventSourceInit,this._requestInit=r==null?void 0:r.requestInit,this._authProvider=r==null?void 0:r.authProvider,this._fetch=r==null?void 0:r.fetch}async _authThenStart(){var e;if(!this._authProvider)throw new Ze("No auth provider");let r;try{r=await zt(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})}catch(s){throw(e=this.onerror)===null||e===void 0||e.call(this,s),s}if(r!=="AUTHORIZED")throw new Ze;return await this._startOrAuth()}async _commonHeaders(){var e;let r={};if(this._authProvider){let s=await this._authProvider.tokens();s&&(r.Authorization=`Bearer ${s.access_token}`)}return this._protocolVersion&&(r["mcp-protocol-version"]=this._protocolVersion),new Headers({...r,...(e=this._requestInit)===null||e===void 0?void 0:e.headers})}_startOrAuth(){var e,r,s;let t=(s=(r=(e=this===null||this===void 0?void 0:this._eventSourceInit)===null||e===void 0?void 0:e.fetch)!==null&&r!==void 0?r:this._fetch)!==null&&s!==void 0?s:fetch;return new Promise((n,o)=>{this._eventSource=new yr(this._url.href,{...this._eventSourceInit,fetch:async(i,u)=>{let c=await this._commonHeaders();c.set("Accept","text/event-stream");let h=await t(i,{...u,headers:c});return h.status===401&&h.headers.has("www-authenticate")&&(this._resourceMetadataUrl=Oa(h)),h}}),this._abortController=new AbortController,this._eventSource.onerror=i=>{var u;if(i.code===401&&this._authProvider){this._authThenStart().then(n,o);return}let c=new eo(i.code,i.message,i);o(c),(u=this.onerror)===null||u===void 0||u.call(this,c)},this._eventSource.onopen=()=>{},this._eventSource.addEventListener("endpoint",i=>{var u;let c=i;try{if(this._endpoint=new URL(c.data,this._url),this._endpoint.origin!==this._url.origin)throw new Error(`Endpoint origin does not match connection origin: ${this._endpoint.origin}`)}catch(h){o(h),(u=this.onerror)===null||u===void 0||u.call(this,h),this.close();return}n()}),this._eventSource.onmessage=i=>{var u,c;let h=i,f;try{f=We.parse(JSON.parse(h.data))}catch(v){(u=this.onerror)===null||u===void 0||u.call(this,v);return}(c=this.onmessage)===null||c===void 0||c.call(this,f)}})}async start(){if(this._eventSource)throw new Error("SSEClientTransport already started! If using Client class, note that connect() calls start() automatically.");return await this._startOrAuth()}async finishAuth(e){if(!this._authProvider)throw new Ze("No auth provider");if(await zt(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})!=="AUTHORIZED")throw new Ze("Failed to authorize")}async close(){var e,r,s;(e=this._abortController)===null||e===void 0||e.abort(),(r=this._eventSource)===null||r===void 0||r.close(),(s=this.onclose)===null||s===void 0||s.call(this)}async send(e){var r,s,t;if(!this._endpoint)throw new Error("Not connected");try{let n=await this._commonHeaders();n.set("content-type","application/json");let o={...this._requestInit,method:"POST",headers:n,body:JSON.stringify(e),signal:(r=this._abortController)===null||r===void 0?void 0:r.signal},i=await((s=this._fetch)!==null&&s!==void 0?s:fetch)(this._endpoint,o);if(!i.ok){if(i.status===401&&this._authProvider){if(this._resourceMetadataUrl=Oa(i),await zt(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})!=="AUTHORIZED")throw new Ze;return this.send(e)}let u=await i.text().catch(()=>null);throw new Error(`Error POSTing to endpoint (HTTP ${i.status}): ${u}`)}}catch(n){throw(t=this.onerror)===null||t===void 0||t.call(this,n),n}}setProtocolVersion(e){this._protocolVersion=e}};var Lc=require("node:crypto");var Dc=ht(kc());function Ta(a,{limit:e,encoding:r}){let s=Dc.default.parse(e);return new Promise((t,n)=>{let o=0,i=[];a.on("data",u=>{if(o+=u.length,o>s)return n(new Error(`Message size exceeds limit of ${e} bytes`));i.push(u)}),a.on("end",()=>{try{t(Buffer.concat(i).toString(r))}catch(u){n(u)}}),a.on("error",u=>{n(u)})})}var Fc=ht(ro(),1),qc=require("url"),rv="4mb",Ss=class{constructor(e,r,s){this._endpoint=e,this.res=r,this._sessionId=(0,Lc.randomUUID)(),this._options=s||{enableDnsRebindingProtection:!1}}validateRequestHeaders(e){if(this._options.enableDnsRebindingProtection){if(this._options.allowedHosts&&this._options.allowedHosts.length>0){let r=e.headers.host;if(!r||!this._options.allowedHosts.includes(r))return`Invalid Host header: ${r}`}if(this._options.allowedOrigins&&this._options.allowedOrigins.length>0){let r=e.headers.origin;if(!r||!this._options.allowedOrigins.includes(r))return`Invalid Origin header: ${r}`}}}async start(){if(this._sseResponse)throw new Error("SSEServerTransport already started! If using Server class, note that connect() calls start() automatically.");this.res.writeHead(200,{"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"});let e="http://localhost",r=new qc.URL(this._endpoint,e);r.searchParams.set("sessionId",this._sessionId);let s=r.pathname+r.search+r.hash;this.res.write(`event: endpoint
data: ${s}

`),this._sseResponse=this.res,this.res.on("close",()=>{var t;this._sseResponse=void 0,(t=this.onclose)===null||t===void 0||t.call(this)})}async handlePostMessage(e,r,s){var t,n,o,i;if(!this._sseResponse){let v="SSE connection not established";throw r.writeHead(500).end(v),new Error(v)}let u=this.validateRequestHeaders(e);if(u){r.writeHead(403).end(u),(t=this.onerror)===null||t===void 0||t.call(this,new Error(u));return}let c=e.auth,h={headers:e.headers},f;try{let v=Fc.default.parse((n=e.headers["content-type"])!==null&&n!==void 0?n:"");if(v.type!=="application/json")throw new Error(`Unsupported content-type: ${v.type}`);f=s!=null?s:await Ta(e,{limit:rv,encoding:(o=v.parameters.charset)!==null&&o!==void 0?o:"utf-8"})}catch(v){r.writeHead(400).end(String(v)),(i=this.onerror)===null||i===void 0||i.call(this,v);return}try{await this.handleMessage(typeof f=="string"?JSON.parse(f):f,{requestInfo:h,authInfo:c})}catch{r.writeHead(400).end(`Invalid message: ${f}`);return}r.writeHead(202).end("Accepted")}async handleMessage(e,r){var s,t;let n;try{n=We.parse(e)}catch(o){throw(s=this.onerror)===null||s===void 0||s.call(this,o),o}(t=this.onmessage)===null||t===void 0||t.call(this,n,r)}async close(){var e,r;(e=this._sseResponse)===null||e===void 0||e.end(),this._sseResponse=void 0,(r=this.onclose)===null||r===void 0||r.call(this)}async send(e){if(!this._sseResponse)throw new Error("Not connected");this._sseResponse.write(`event: message
data: ${JSON.stringify(e)}

`)}get sessionId(){return this._sessionId}};var Cu=ht(Tu(),1),Ca=ht(require("node:process"),1),Iu=require("node:stream");var Qr=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),Cv(r)}clear(){this._buffer=void 0}};function Cv(a){return We.parse(JSON.parse(a))}function Os(a){return JSON.stringify(a)+`
`}var Iv=Ca.default.platform==="win32"?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE","PROGRAMFILES"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function Av(){let a={};for(let e of Iv){let r=Ca.default.env[e];r!==void 0&&(r.startsWith("()")||(a[e]=r))}return a}var Ts=class{constructor(e){this._abortController=new AbortController,this._readBuffer=new Qr,this._stderrStream=null,this._serverParams=e,(e.stderr==="pipe"||e.stderr==="overlapped")&&(this._stderrStream=new Iu.PassThrough)}async start(){if(this._process)throw new Error("StdioClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,r)=>{var s,t,n,o,i;this._process=(0,Cu.default)(this._serverParams.command,(s=this._serverParams.args)!==null&&s!==void 0?s:[],{env:{...Av(),...this._serverParams.env},stdio:["pipe","pipe",(t=this._serverParams.stderr)!==null&&t!==void 0?t:"inherit"],shell:!1,signal:this._abortController.signal,windowsHide:Ca.default.platform==="win32"&&$v(),cwd:this._serverParams.cwd}),this._process.on("error",u=>{var c,h;if(u.name==="AbortError"){(c=this.onclose)===null||c===void 0||c.call(this);return}r(u),(h=this.onerror)===null||h===void 0||h.call(this,u)}),this._process.on("spawn",()=>{e()}),this._process.on("close",u=>{var c;this._process=void 0,(c=this.onclose)===null||c===void 0||c.call(this)}),(n=this._process.stdin)===null||n===void 0||n.on("error",u=>{var c;(c=this.onerror)===null||c===void 0||c.call(this,u)}),(o=this._process.stdout)===null||o===void 0||o.on("data",u=>{this._readBuffer.append(u),this.processReadBuffer()}),(i=this._process.stdout)===null||i===void 0||i.on("error",u=>{var c;(c=this.onerror)===null||c===void 0||c.call(this,u)}),this._stderrStream&&this._process.stderr&&this._process.stderr.pipe(this._stderrStream)})}get stderr(){var e,r;return this._stderrStream?this._stderrStream:(r=(e=this._process)===null||e===void 0?void 0:e.stderr)!==null&&r!==void 0?r:null}get pid(){var e,r;return(r=(e=this._process)===null||e===void 0?void 0:e.pid)!==null&&r!==void 0?r:null}processReadBuffer(){for(var e,r;;)try{let s=this._readBuffer.readMessage();if(s===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,s)}catch(s){(r=this.onerror)===null||r===void 0||r.call(this,s)}}async close(){this._abortController.abort(),this._process=void 0,this._readBuffer.clear()}send(e){return new Promise(r=>{var s;if(!(!((s=this._process)===null||s===void 0)&&s.stdin))throw new Error("Not connected");let t=Os(e);this._process.stdin.write(t)?r():this._process.stdin.once("drain",r)})}};function $v(){return"type"in Ca.default}var fo=ht(require("node:process"),1);var Cs=class{constructor(e=fo.default.stdin,r=fo.default.stdout){this._stdin=e,this._stdout=r,this._readBuffer=new Qr,this._started=!1,this._ondata=s=>{this._readBuffer.append(s),this.processReadBuffer()},this._onerror=s=>{var t;(t=this.onerror)===null||t===void 0||t.call(this,s)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(var e,r;;)try{let s=this._readBuffer.readMessage();if(s===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,s)}catch(s){(r=this.onerror)===null||r===void 0||r.call(this,s)}}async close(){var e;this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),(e=this.onclose)===null||e===void 0||e.call(this)}send(e){return new Promise(r=>{let s=Os(e);this._stdout.write(s)?r():this._stdout.once("drain",r)})}};var Au=ht(ro(),1),$u=require("node:crypto"),kv="4mb",Is=class{constructor(e){var r,s;this._started=!1,this._streamMapping=new Map,this._requestToStreamMapping=new Map,this._requestResponseMap=new Map,this._initialized=!1,this._enableJsonResponse=!1,this._standaloneSseStreamId="_GET_stream",this.sessionIdGenerator=e.sessionIdGenerator,this._enableJsonResponse=(r=e.enableJsonResponse)!==null&&r!==void 0?r:!1,this._eventStore=e.eventStore,this._onsessioninitialized=e.onsessioninitialized,this._onsessionclosed=e.onsessionclosed,this._allowedHosts=e.allowedHosts,this._allowedOrigins=e.allowedOrigins,this._enableDnsRebindingProtection=(s=e.enableDnsRebindingProtection)!==null&&s!==void 0?s:!1}async start(){if(this._started)throw new Error("Transport already started");this._started=!0}validateRequestHeaders(e){if(this._enableDnsRebindingProtection){if(this._allowedHosts&&this._allowedHosts.length>0){let r=e.headers.host;if(!r||!this._allowedHosts.includes(r))return`Invalid Host header: ${r}`}if(this._allowedOrigins&&this._allowedOrigins.length>0){let r=e.headers.origin;if(!r||!this._allowedOrigins.includes(r))return`Invalid Origin header: ${r}`}}}async handleRequest(e,r,s){var t;let n=this.validateRequestHeaders(e);if(n){r.writeHead(403).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:n},id:null})),(t=this.onerror)===null||t===void 0||t.call(this,new Error(n));return}e.method==="POST"?await this.handlePostRequest(e,r,s):e.method==="GET"?await this.handleGetRequest(e,r):e.method==="DELETE"?await this.handleDeleteRequest(e,r):await this.handleUnsupportedRequest(r)}async handleGetRequest(e,r){let s=e.headers.accept;if(!(s!=null&&s.includes("text/event-stream"))){r.writeHead(406).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Not Acceptable: Client must accept text/event-stream"},id:null}));return}if(!this.validateSession(e,r)||!this.validateProtocolVersion(e,r))return;if(this._eventStore){let n=e.headers["last-event-id"];if(n){await this.replayEvents(n,r);return}}let t={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"};if(this.sessionId!==void 0&&(t["mcp-session-id"]=this.sessionId),this._streamMapping.get(this._standaloneSseStreamId)!==void 0){r.writeHead(409).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Conflict: Only one SSE stream is allowed per session"},id:null}));return}r.writeHead(200,t).flushHeaders(),this._streamMapping.set(this._standaloneSseStreamId,r),r.on("close",()=>{this._streamMapping.delete(this._standaloneSseStreamId)})}async replayEvents(e,r){var s,t;if(this._eventStore)try{let n={"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive"};this.sessionId!==void 0&&(n["mcp-session-id"]=this.sessionId),r.writeHead(200,n).flushHeaders();let o=await((s=this._eventStore)===null||s===void 0?void 0:s.replayEventsAfter(e,{send:async(i,u)=>{var c;this.writeSSEEvent(r,u,i)||((c=this.onerror)===null||c===void 0||c.call(this,new Error("Failed replay events")),r.end())}}));this._streamMapping.set(o,r)}catch(n){(t=this.onerror)===null||t===void 0||t.call(this,n)}}writeSSEEvent(e,r,s){let t=`event: message
`;return s&&(t+=`id: ${s}
`),t+=`data: ${JSON.stringify(r)}

`,e.write(t)}async handleUnsupportedRequest(e){e.writeHead(405,{Allow:"GET, POST, DELETE"}).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Method not allowed."},id:null}))}async handlePostRequest(e,r,s){var t,n,o,i,u;try{let c=e.headers.accept;if(!(c!=null&&c.includes("application/json"))||!c.includes("text/event-stream")){r.writeHead(406).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Not Acceptable: Client must accept both application/json and text/event-stream"},id:null}));return}let h=e.headers["content-type"];if(!h||!h.includes("application/json")){r.writeHead(415).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Unsupported Media Type: Content-Type must be application/json"},id:null}));return}let f=e.auth,v={headers:e.headers},d;if(s!==void 0)d=s;else{let w=Au.default.parse(h),S=await Ta(e,{limit:kv,encoding:(t=w.parameters.charset)!==null&&t!==void 0?t:"utf-8"});d=JSON.parse(S.toString())}let y;Array.isArray(d)?y=d.map(w=>We.parse(w)):y=[We.parse(d)];let m=y.some(oi);if(m){if(this._initialized&&this.sessionId!==void 0){r.writeHead(400).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32600,message:"Invalid Request: Server already initialized"},id:null}));return}if(y.length>1){r.writeHead(400).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32600,message:"Invalid Request: Only one initialization request is allowed"},id:null}));return}this.sessionId=(n=this.sessionIdGenerator)===null||n===void 0?void 0:n.call(this),this._initialized=!0,this.sessionId&&this._onsessioninitialized&&await Promise.resolve(this._onsessioninitialized(this.sessionId))}if(!m&&(!this.validateSession(e,r)||!this.validateProtocolVersion(e,r)))return;let g=y.some(pr);if(g){if(g){let w=(0,$u.randomUUID)();if(!this._enableJsonResponse){let S={"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"};this.sessionId!==void 0&&(S["mcp-session-id"]=this.sessionId),r.writeHead(200,S)}for(let S of y)pr(S)&&(this._streamMapping.set(w,r),this._requestToStreamMapping.set(S.id,w));r.on("close",()=>{this._streamMapping.delete(w)});for(let S of y)(i=this.onmessage)===null||i===void 0||i.call(this,S,{authInfo:f,requestInfo:v})}}else{r.writeHead(202).end();for(let w of y)(o=this.onmessage)===null||o===void 0||o.call(this,w,{authInfo:f,requestInfo:v})}}catch(c){r.writeHead(400).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32700,message:"Parse error",data:String(c)},id:null})),(u=this.onerror)===null||u===void 0||u.call(this,c)}}async handleDeleteRequest(e,r){var s;this.validateSession(e,r)&&this.validateProtocolVersion(e,r)&&(await Promise.resolve((s=this._onsessionclosed)===null||s===void 0?void 0:s.call(this,this.sessionId)),await this.close(),r.writeHead(200).end())}validateSession(e,r){if(this.sessionIdGenerator===void 0)return!0;if(!this._initialized)return r.writeHead(400).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Bad Request: Server not initialized"},id:null})),!1;let s=e.headers["mcp-session-id"];if(s){if(Array.isArray(s))return r.writeHead(400).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Bad Request: Mcp-Session-Id header must be a single value"},id:null})),!1;if(s!==this.sessionId)return r.writeHead(404).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32001,message:"Session not found"},id:null})),!1}else return r.writeHead(400).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:"Bad Request: Mcp-Session-Id header is required"},id:null})),!1;return!0}validateProtocolVersion(e,r){var s;let t=(s=e.headers["mcp-protocol-version"])!==null&&s!==void 0?s:Ko;return Array.isArray(t)&&(t=t[t.length-1]),fr.includes(t)?!0:(r.writeHead(400).end(JSON.stringify({jsonrpc:"2.0",error:{code:-32e3,message:`Bad Request: Unsupported protocol version (supported versions: ${fr.join(", ")})`},id:null})),!1)}async close(){var e;this._streamMapping.forEach(r=>{r.end()}),this._streamMapping.clear(),this._requestResponseMap.clear(),(e=this.onclose)===null||e===void 0||e.call(this)}async send(e,r){let s=r==null?void 0:r.relatedRequestId;if((Ot(e)||Mr(e))&&(s=e.id),s===void 0){if(Ot(e)||Mr(e))throw new Error("Cannot send a response on a standalone SSE stream unless resuming a previous client request");let o=this._streamMapping.get(this._standaloneSseStreamId);if(o===void 0)return;let i;this._eventStore&&(i=await this._eventStore.storeEvent(this._standaloneSseStreamId,e)),this.writeSSEEvent(o,e,i);return}let t=this._requestToStreamMapping.get(s),n=this._streamMapping.get(t);if(!t)throw new Error(`No connection established for request ID: ${String(s)}`);if(!this._enableJsonResponse){let o;this._eventStore&&(o=await this._eventStore.storeEvent(t,e)),n&&this.writeSSEEvent(n,e,o)}if(Ot(e)||Mr(e)){this._requestResponseMap.set(s,e);let o=Array.from(this._requestToStreamMapping.entries()).filter(([u,c])=>this._streamMapping.get(c)===n).map(([u])=>u);if(o.every(u=>this._requestResponseMap.has(u))){if(!n)throw new Error(`No connection established for request ID: ${String(s)}`);if(this._enableJsonResponse){let u={"Content-Type":"application/json"};this.sessionId!==void 0&&(u["mcp-session-id"]=this.sessionId);let c=o.map(h=>this._requestResponseMap.get(h));n.writeHead(200,u),c.length===1?n.end(JSON.stringify(c[0])):n.end(JSON.stringify(c))}else n.end();for(let u of o)this._requestResponseMap.delete(u),this._requestToStreamMapping.delete(u)}}}};var As=class extends TransformStream{constructor({onError:e,onRetry:r,onComment:s}={}){let t;super({start(n){t=_s({onEvent:o=>{n.enqueue(o)},onError(o){e==="terminate"?n.error(o):typeof e=="function"&&e(o)},onRetry:r,onComment:s})},transform(n){t.feed(n)}})}};var Dv={initialReconnectionDelay:1e3,maxReconnectionDelay:3e4,reconnectionDelayGrowFactor:1.5,maxRetries:2},Ia=class extends Error{constructor(e,r){super(`Streamable HTTP error: ${r}`),this.code=e}},$s=class{constructor(e,r){var s;this._url=e,this._resourceMetadataUrl=void 0,this._requestInit=r==null?void 0:r.requestInit,this._authProvider=r==null?void 0:r.authProvider,this._fetch=r==null?void 0:r.fetch,this._sessionId=r==null?void 0:r.sessionId,this._reconnectionOptions=(s=r==null?void 0:r.reconnectionOptions)!==null&&s!==void 0?s:Dv}async _authThenStart(){var e;if(!this._authProvider)throw new Ze("No auth provider");let r;try{r=await zt(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})}catch(s){throw(e=this.onerror)===null||e===void 0||e.call(this,s),s}if(r!=="AUTHORIZED")throw new Ze;return await this._startOrAuthSse({resumptionToken:void 0})}async _commonHeaders(){var e;let r={};if(this._authProvider){let t=await this._authProvider.tokens();t&&(r.Authorization=`Bearer ${t.access_token}`)}this._sessionId&&(r["mcp-session-id"]=this._sessionId),this._protocolVersion&&(r["mcp-protocol-version"]=this._protocolVersion);let s=this._normalizeHeaders((e=this._requestInit)===null||e===void 0?void 0:e.headers);return new Headers({...r,...s})}async _startOrAuthSse(e){var r,s,t;let{resumptionToken:n}=e;try{let o=await this._commonHeaders();o.set("Accept","text/event-stream"),n&&o.set("last-event-id",n);let i=await((r=this._fetch)!==null&&r!==void 0?r:fetch)(this._url,{method:"GET",headers:o,signal:(s=this._abortController)===null||s===void 0?void 0:s.signal});if(!i.ok){if(i.status===401&&this._authProvider)return await this._authThenStart();if(i.status===405)return;throw new Ia(i.status,`Failed to open SSE stream: ${i.statusText}`)}this._handleSseStream(i.body,e,!0)}catch(o){throw(t=this.onerror)===null||t===void 0||t.call(this,o),o}}_getNextReconnectionDelay(e){let r=this._reconnectionOptions.initialReconnectionDelay,s=this._reconnectionOptions.reconnectionDelayGrowFactor,t=this._reconnectionOptions.maxReconnectionDelay;return Math.min(r*Math.pow(s,e),t)}_normalizeHeaders(e){return e?e instanceof Headers?Object.fromEntries(e.entries()):Array.isArray(e)?Object.fromEntries(e):{...e}:{}}_scheduleReconnection(e,r=0){var s;let t=this._reconnectionOptions.maxRetries;if(t>0&&r>=t){(s=this.onerror)===null||s===void 0||s.call(this,new Error(`Maximum reconnection attempts (${t}) exceeded.`));return}let n=this._getNextReconnectionDelay(r);setTimeout(()=>{this._startOrAuthSse(e).catch(o=>{var i;(i=this.onerror)===null||i===void 0||i.call(this,new Error(`Failed to reconnect SSE stream: ${o instanceof Error?o.message:String(o)}`)),this._scheduleReconnection(e,r+1)})},n)}_handleSseStream(e,r,s){if(!e)return;let{onresumptiontoken:t,replayMessageId:n}=r,o;(async()=>{var u,c,h,f;try{let v=e.pipeThrough(new TextDecoderStream).pipeThrough(new As).getReader();for(;;){let{value:d,done:y}=await v.read();if(y)break;if(d.id&&(o=d.id,t==null||t(d.id)),!d.event||d.event==="message")try{let m=We.parse(JSON.parse(d.data));n!==void 0&&Ot(m)&&(m.id=n),(u=this.onmessage)===null||u===void 0||u.call(this,m)}catch(m){(c=this.onerror)===null||c===void 0||c.call(this,m)}}}catch(v){if((h=this.onerror)===null||h===void 0||h.call(this,new Error(`SSE stream disconnected: ${v}`)),s&&this._abortController&&!this._abortController.signal.aborted)try{this._scheduleReconnection({resumptionToken:o,onresumptiontoken:t,replayMessageId:n},0)}catch(d){(f=this.onerror)===null||f===void 0||f.call(this,new Error(`Failed to reconnect: ${d instanceof Error?d.message:String(d)}`))}}})()}async start(){if(this._abortController)throw new Error("StreamableHTTPClientTransport already started! If using Client class, note that connect() calls start() automatically.");this._abortController=new AbortController}async finishAuth(e){if(!this._authProvider)throw new Ze("No auth provider");if(await zt(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})!=="AUTHORIZED")throw new Ze("Failed to authorize")}async close(){var e,r;(e=this._abortController)===null||e===void 0||e.abort(),(r=this.onclose)===null||r===void 0||r.call(this)}async send(e,r){var s,t,n,o;try{let{resumptionToken:i,onresumptiontoken:u}=r||{};if(i){this._startOrAuthSse({resumptionToken:i,replayMessageId:pr(e)?e.id:void 0}).catch(g=>{var w;return(w=this.onerror)===null||w===void 0?void 0:w.call(this,g)});return}let c=await this._commonHeaders();c.set("content-type","application/json"),c.set("accept","application/json, text/event-stream");let h={...this._requestInit,method:"POST",headers:c,body:JSON.stringify(e),signal:(s=this._abortController)===null||s===void 0?void 0:s.signal},f=await((t=this._fetch)!==null&&t!==void 0?t:fetch)(this._url,h),v=f.headers.get("mcp-session-id");if(v&&(this._sessionId=v),!f.ok){if(f.status===401&&this._authProvider){if(this._resourceMetadataUrl=Oa(f),await zt(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})!=="AUTHORIZED")throw new Ze;return this.send(e)}let g=await f.text().catch(()=>null);throw new Error(`Error POSTing to endpoint (HTTP ${f.status}): ${g}`)}if(f.status===202){ii(e)&&this._startOrAuthSse({resumptionToken:void 0}).catch(g=>{var w;return(w=this.onerror)===null||w===void 0?void 0:w.call(this,g)});return}let y=(Array.isArray(e)?e:[e]).filter(g=>"method"in g&&"id"in g&&g.id!==void 0).length>0,m=f.headers.get("content-type");if(y)if(m!=null&&m.includes("text/event-stream"))this._handleSseStream(f.body,{onresumptiontoken:u},!1);else if(m!=null&&m.includes("application/json")){let g=await f.json(),w=Array.isArray(g)?g.map(S=>We.parse(S)):[We.parse(g)];for(let S of w)(n=this.onmessage)===null||n===void 0||n.call(this,S)}else throw new Ia(-1,`Unexpected content type: ${m}`)}catch(i){throw(o=this.onerror)===null||o===void 0||o.call(this,i),i}}get sessionId(){return this._sessionId}async terminateSession(){var e,r,s;if(this._sessionId)try{let t=await this._commonHeaders(),n={...this._requestInit,method:"DELETE",headers:t,signal:(e=this._abortController)===null||e===void 0?void 0:e.signal},o=await((r=this._fetch)!==null&&r!==void 0?r:fetch)(this._url,n);if(!o.ok&&o.status!==405)throw new Ia(o.status,`Failed to terminate session: ${o.statusText}`);this._sessionId=void 0}catch(t){throw(s=this.onerror)===null||s===void 0||s.call(this,t),t}}setProtocolVersion(e){this._protocolVersion=e}get protocolVersion(){return this._protocolVersion}};var Wr={};Fo(Wr,ht(qu(),1));var zu=Symbol("Let zodToJsonSchema decide on which parser to use");var Uu={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},Vu=a=>typeof a=="string"?{...Uu,name:a}:{...Uu,...a};var Hu=a=>{let e=Vu(a),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([s,t])=>[t._def,{def:t._def,path:[...e.basePath,e.definitionPath,s],jsonSchema:void 0}]))}};function wo(a,e,r,s){s!=null&&s.errorMessages&&r&&(a.errorMessage={...a.errorMessage,[e]:r})}function te(a,e,r,s,t){a[e]=r,wo(a,e,s,t)}var Ns=(a,e)=>{let r=0;for(;r<a.length&&r<e.length&&a[r]===e[r];r++);return[(a.length-r).toString(),...e.slice(r)].join("/")};function pe(a){if(a.target!=="openAi")return{};let e=[...a.basePath,a.definitionPath,a.openAiAnyTypeName];return a.flags.hasReferencedOpenAiAnyType=!0,{$ref:a.$refStrategy==="relative"?Ns(e,a.currentPath):e.join("/")}}function Zu(a,e){var s,t,n;let r={type:"array"};return(s=a.type)!=null&&s._def&&((n=(t=a.type)==null?void 0:t._def)==null?void 0:n.typeName)!==C.ZodAny&&(r.items=J(a.type._def,{...e,currentPath:[...e.currentPath,"items"]})),a.minLength&&te(r,"minItems",a.minLength.value,a.minLength.message,e),a.maxLength&&te(r,"maxItems",a.maxLength.value,a.maxLength.message,e),a.exactLength&&(te(r,"minItems",a.exactLength.value,a.exactLength.message,e),te(r,"maxItems",a.exactLength.value,a.exactLength.message,e)),r}function Bu(a,e){let r={type:"integer",format:"int64"};if(!a.checks)return r;for(let s of a.checks)switch(s.kind){case"min":e.target==="jsonSchema7"?s.inclusive?te(r,"minimum",s.value,s.message,e):te(r,"exclusiveMinimum",s.value,s.message,e):(s.inclusive||(r.exclusiveMinimum=!0),te(r,"minimum",s.value,s.message,e));break;case"max":e.target==="jsonSchema7"?s.inclusive?te(r,"maximum",s.value,s.message,e):te(r,"exclusiveMaximum",s.value,s.message,e):(s.inclusive||(r.exclusiveMaximum=!0),te(r,"maximum",s.value,s.message,e));break;case"multipleOf":te(r,"multipleOf",s.value,s.message,e);break}return r}function Ju(){return{type:"boolean"}}function js(a,e){return J(a.type._def,e)}var Qu=(a,e)=>J(a.innerType._def,e);function xo(a,e,r){let s=r!=null?r:e.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((t,n)=>xo(a,e,t))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return fg(a,e)}}var fg=(a,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let s of a.checks)switch(s.kind){case"min":te(r,"minimum",s.value,s.message,e);break;case"max":te(r,"maximum",s.value,s.message,e);break}return r};function Wu(a,e){return{...J(a.innerType._def,e),default:a.defaultValue()}}function Gu(a,e){return e.effectStrategy==="input"?J(a.schema._def,e):pe(e)}function Ku(a){return{type:"string",enum:Array.from(a.values)}}var pg=a=>"type"in a&&a.type==="string"?!1:"allOf"in a;function Yu(a,e){let r=[J(a.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),J(a.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(n=>!!n),s=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,t=[];return r.forEach(n=>{if(pg(n))t.push(...n.allOf),n.unevaluatedProperties===void 0&&(s=void 0);else{let o=n;if("additionalProperties"in n&&n.additionalProperties===!1){let{additionalProperties:i,...u}=n;o=u}else s=void 0;t.push(o)}}),t.length?{allOf:t,...s}:void 0}function Xu(a,e){let r=typeof a.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(a.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[a.value]}:{type:r==="bigint"?"integer":r,const:a.value}}var Eo,it={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Eo===void 0&&(Eo=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Eo),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Ms(a,e){let r={type:"string"};if(a.checks)for(let s of a.checks)switch(s.kind){case"min":te(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,s.value):s.value,s.message,e);break;case"max":te(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":lt(r,"email",s.message,e);break;case"format:idn-email":lt(r,"idn-email",s.message,e);break;case"pattern:zod":Fe(r,it.email,s.message,e);break}break;case"url":lt(r,"uri",s.message,e);break;case"uuid":lt(r,"uuid",s.message,e);break;case"regex":Fe(r,s.regex,s.message,e);break;case"cuid":Fe(r,it.cuid,s.message,e);break;case"cuid2":Fe(r,it.cuid2,s.message,e);break;case"startsWith":Fe(r,RegExp(`^${Po(s.value,e)}`),s.message,e);break;case"endsWith":Fe(r,RegExp(`${Po(s.value,e)}$`),s.message,e);break;case"datetime":lt(r,"date-time",s.message,e);break;case"date":lt(r,"date",s.message,e);break;case"time":lt(r,"time",s.message,e);break;case"duration":lt(r,"duration",s.message,e);break;case"length":te(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,s.value):s.value,s.message,e),te(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,s.value):s.value,s.message,e);break;case"includes":{Fe(r,RegExp(Po(s.value,e)),s.message,e);break}case"ip":{s.version!=="v6"&&lt(r,"ipv4",s.message,e),s.version!=="v4"&&lt(r,"ipv6",s.message,e);break}case"base64url":Fe(r,it.base64url,s.message,e);break;case"jwt":Fe(r,it.jwt,s.message,e);break;case"cidr":{s.version!=="v6"&&Fe(r,it.ipv4Cidr,s.message,e),s.version!=="v4"&&Fe(r,it.ipv6Cidr,s.message,e);break}case"emoji":Fe(r,it.emoji(),s.message,e);break;case"ulid":{Fe(r,it.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{lt(r,"binary",s.message,e);break}case"contentEncoding:base64":{te(r,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{Fe(r,it.base64,s.message,e);break}}break}case"nanoid":Fe(r,it.nanoid,s.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function Po(a,e){return e.patternStrategy==="escape"?vg(a):a}var mg=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function vg(a){let e="";for(let r=0;r<a.length;r++)mg.has(a[r])||(e+="\\"),e+=a[r];return e}function lt(a,e,r,s){var t;a.format||(t=a.anyOf)!=null&&t.some(n=>n.format)?(a.anyOf||(a.anyOf=[]),a.format&&(a.anyOf.push({format:a.format,...a.errorMessage&&s.errorMessages&&{errorMessage:{format:a.errorMessage.format}}}),delete a.format,a.errorMessage&&(delete a.errorMessage.format,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.anyOf.push({format:e,...r&&s.errorMessages&&{errorMessage:{format:r}}})):te(a,"format",e,r,s)}function Fe(a,e,r,s){var t;a.pattern||(t=a.allOf)!=null&&t.some(n=>n.pattern)?(a.allOf||(a.allOf=[]),a.pattern&&(a.allOf.push({pattern:a.pattern,...a.errorMessage&&s.errorMessages&&{errorMessage:{pattern:a.errorMessage.pattern}}}),delete a.pattern,a.errorMessage&&(delete a.errorMessage.pattern,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.allOf.push({pattern:ed(e,s),...r&&s.errorMessages&&{errorMessage:{pattern:r}}})):te(a,"pattern",ed(e,s),r,s)}function ed(a,e){var u;if(!e.applyRegexFlags||!a.flags)return a.source;let r={i:a.flags.includes("i"),m:a.flags.includes("m"),s:a.flags.includes("s")},s=r.i?a.source.toLowerCase():a.source,t="",n=!1,o=!1,i=!1;for(let c=0;c<s.length;c++){if(n){t+=s[c],n=!1;continue}if(r.i){if(o){if(s[c].match(/[a-z]/)){i?(t+=s[c],t+=`${s[c-2]}-${s[c]}`.toUpperCase(),i=!1):s[c+1]==="-"&&((u=s[c+2])!=null&&u.match(/[a-z]/))?(t+=s[c],i=!0):t+=`${s[c]}${s[c].toUpperCase()}`;continue}}else if(s[c].match(/[a-z]/)){t+=`[${s[c]}${s[c].toUpperCase()}]`;continue}}if(r.m){if(s[c]==="^"){t+=`(^|(?<=[\r
]))`;continue}else if(s[c]==="$"){t+=`($|(?=[\r
]))`;continue}}if(r.s&&s[c]==="."){t+=o?`${s[c]}\r
`:`[${s[c]}\r
]`;continue}t+=s[c],s[c]==="\\"?n=!0:o&&s[c]==="]"?o=!1:!o&&s[c]==="["&&(o=!0)}try{new RegExp(t)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),a.source}return t}function Ls(a,e){var s,t,n,o,i,u,c;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((s=a.keyType)==null?void 0:s._def.typeName)===C.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((h,f)=>{var v;return{...h,[f]:(v=J(a.valueType._def,{...e,currentPath:[...e.currentPath,"properties",f]}))!=null?v:pe(e)}},{}),additionalProperties:e.rejectedAdditionalProperties};let r={type:"object",additionalProperties:(t=J(a.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]}))!=null?t:e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(((n=a.keyType)==null?void 0:n._def.typeName)===C.ZodString&&((o=a.keyType._def.checks)!=null&&o.length)){let{type:h,...f}=Ms(a.keyType._def,e);return{...r,propertyNames:f}}else{if(((i=a.keyType)==null?void 0:i._def.typeName)===C.ZodEnum)return{...r,propertyNames:{enum:a.keyType._def.values}};if(((u=a.keyType)==null?void 0:u._def.typeName)===C.ZodBranded&&a.keyType._def.type._def.typeName===C.ZodString&&((c=a.keyType._def.type._def.checks)!=null&&c.length)){let{type:h,...f}=js(a.keyType._def,e);return{...r,propertyNames:f}}}return r}function td(a,e){if(e.mapStrategy==="record")return Ls(a,e);let r=J(a.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||pe(e),s=J(a.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||pe(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,s],minItems:2,maxItems:2}}}function rd(a){let e=a.values,s=Object.keys(a.values).filter(n=>typeof e[e[n]]!="number").map(n=>e[n]),t=Array.from(new Set(s.map(n=>typeof n)));return{type:t.length===1?t[0]==="string"?"string":"number":["string","number"],enum:s}}function ad(a){return a.target==="openAi"?void 0:{not:pe({...a,currentPath:[...a.currentPath,"not"]})}}function sd(a){return a.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var $a={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function od(a,e){if(e.target==="openApi3")return nd(a,e);let r=a.options instanceof Map?Array.from(a.options.values()):a.options;if(r.every(s=>s._def.typeName in $a&&(!s._def.checks||!s._def.checks.length))){let s=r.reduce((t,n)=>{let o=$a[n._def.typeName];return o&&!t.includes(o)?[...t,o]:t},[]);return{type:s.length>1?s:s[0]}}else if(r.every(s=>s._def.typeName==="ZodLiteral"&&!s.description)){let s=r.reduce((t,n)=>{let o=typeof n._def.value;switch(o){case"string":case"number":case"boolean":return[...t,o];case"bigint":return[...t,"integer"];case"object":if(n._def.value===null)return[...t,"null"];case"symbol":case"undefined":case"function":default:return t}},[]);if(s.length===r.length){let t=s.filter((n,o,i)=>i.indexOf(n)===o);return{type:t.length>1?t:t[0],enum:r.reduce((n,o)=>n.includes(o._def.value)?n:[...n,o._def.value],[])}}}else if(r.every(s=>s._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((s,t)=>[...s,...t._def.values.filter(n=>!s.includes(n))],[])};return nd(a,e)}var nd=(a,e)=>{let r=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((s,t)=>J(s._def,{...e,currentPath:[...e.currentPath,"anyOf",`${t}`]})).filter(s=>!!s&&(!e.strictUnions||typeof s=="object"&&Object.keys(s).length>0));return r.length?{anyOf:r}:void 0};function id(a,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(a.innerType._def.typeName)&&(!a.innerType._def.checks||!a.innerType._def.checks.length))return e.target==="openApi3"?{type:$a[a.innerType._def.typeName],nullable:!0}:{type:[$a[a.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let s=J(a.innerType._def,{...e,currentPath:[...e.currentPath]});return s&&"$ref"in s?{allOf:[s],nullable:!0}:s&&{...s,nullable:!0}}let r=J(a.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function ld(a,e){let r={type:"number"};if(!a.checks)return r;for(let s of a.checks)switch(s.kind){case"int":r.type="integer",wo(r,"type",s.message,e);break;case"min":e.target==="jsonSchema7"?s.inclusive?te(r,"minimum",s.value,s.message,e):te(r,"exclusiveMinimum",s.value,s.message,e):(s.inclusive||(r.exclusiveMinimum=!0),te(r,"minimum",s.value,s.message,e));break;case"max":e.target==="jsonSchema7"?s.inclusive?te(r,"maximum",s.value,s.message,e):te(r,"exclusiveMaximum",s.value,s.message,e):(s.inclusive||(r.exclusiveMaximum=!0),te(r,"maximum",s.value,s.message,e));break;case"multipleOf":te(r,"multipleOf",s.value,s.message,e);break}return r}function cd(a,e){let r=e.target==="openAi",s={type:"object",properties:{}},t=[],n=a.shape();for(let i in n){let u=n[i];if(u===void 0||u._def===void 0)continue;let c=yg(u);c&&r&&(u._def.typeName==="ZodOptional"&&(u=u._def.innerType),u.isNullable()||(u=u.nullable()),c=!1);let h=J(u._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});h!==void 0&&(s.properties[i]=h,c||t.push(i))}t.length&&(s.required=t);let o=gg(a,e);return o!==void 0&&(s.additionalProperties=o),s}function gg(a,e){if(a.catchall._def.typeName!=="ZodNever")return J(a.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(a.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function yg(a){try{return a.isOptional()}catch{return!0}}var ud=(a,e)=>{var s;if(e.currentPath.toString()===((s=e.propertyPath)==null?void 0:s.toString()))return J(a.innerType._def,e);let r=J(a.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:pe(e)},r]}:pe(e)};var dd=(a,e)=>{if(e.pipeStrategy==="input")return J(a.in._def,e);if(e.pipeStrategy==="output")return J(a.out._def,e);let r=J(a.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),s=J(a.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,s].filter(t=>t!==void 0)}};function hd(a,e){return J(a.type._def,e)}function fd(a,e){let s={type:"array",uniqueItems:!0,items:J(a.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return a.minSize&&te(s,"minItems",a.minSize.value,a.minSize.message,e),a.maxSize&&te(s,"maxItems",a.maxSize.value,a.maxSize.message,e),s}function pd(a,e){return a.rest?{type:"array",minItems:a.items.length,items:a.items.map((r,s)=>J(r._def,{...e,currentPath:[...e.currentPath,"items",`${s}`]})).reduce((r,s)=>s===void 0?r:[...r,s],[]),additionalItems:J(a.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:a.items.length,maxItems:a.items.length,items:a.items.map((r,s)=>J(r._def,{...e,currentPath:[...e.currentPath,"items",`${s}`]})).reduce((r,s)=>s===void 0?r:[...r,s],[])}}function md(a){return{not:pe(a)}}function vd(a){return pe(a)}var gd=(a,e)=>J(a.innerType._def,e);var yd=(a,e,r)=>{switch(e){case C.ZodString:return Ms(a,r);case C.ZodNumber:return ld(a,r);case C.ZodObject:return cd(a,r);case C.ZodBigInt:return Bu(a,r);case C.ZodBoolean:return Ju();case C.ZodDate:return xo(a,r);case C.ZodUndefined:return md(r);case C.ZodNull:return sd(r);case C.ZodArray:return Zu(a,r);case C.ZodUnion:case C.ZodDiscriminatedUnion:return od(a,r);case C.ZodIntersection:return Yu(a,r);case C.ZodTuple:return pd(a,r);case C.ZodRecord:return Ls(a,r);case C.ZodLiteral:return Xu(a,r);case C.ZodEnum:return Ku(a);case C.ZodNativeEnum:return rd(a);case C.ZodNullable:return id(a,r);case C.ZodOptional:return ud(a,r);case C.ZodMap:return td(a,r);case C.ZodSet:return fd(a,r);case C.ZodLazy:return()=>a.getter()._def;case C.ZodPromise:return hd(a,r);case C.ZodNaN:case C.ZodNever:return ad(r);case C.ZodEffects:return Gu(a,r);case C.ZodAny:return pe(r);case C.ZodUnknown:return vd(r);case C.ZodDefault:return Wu(a,r);case C.ZodBranded:return js(a,r);case C.ZodReadonly:return gd(a,r);case C.ZodCatch:return Qu(a,r);case C.ZodPipeline:return dd(a,r);case C.ZodFunction:case C.ZodVoid:case C.ZodSymbol:return;default:return(s=>{})(e)}};function J(a,e,r=!1){var i;let s=e.seen.get(a);if(e.override){let u=(i=e.override)==null?void 0:i.call(e,a,e,s,r);if(u!==zu)return u}if(s&&!r){let u=_g(s,e);if(u!==void 0)return u}let t={def:a,path:e.currentPath,jsonSchema:void 0};e.seen.set(a,t);let n=yd(a,a.typeName,e),o=typeof n=="function"?J(n(),e):n;if(o&&bg(a,e,o),e.postProcess){let u=e.postProcess(o,a,e);return t.jsonSchema=o,u}return t.jsonSchema=o,o}var _g=(a,e)=>{switch(e.$refStrategy){case"root":return{$ref:a.path.join("/")};case"relative":return{$ref:Ns(e.currentPath,a.path)};case"none":case"seen":return a.path.length<e.currentPath.length&&a.path.every((r,s)=>e.currentPath[s]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),pe(e)):e.$refStrategy==="seen"?pe(e):void 0}},bg=(a,e,r)=>(a.description&&(r.description=a.description,e.markdownDescription&&(r.markdownDescription=a.description)),r);var So=(a,e)=>{var u;let r=Hu(e),s=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((c,[h,f])=>{var v;return{...c,[h]:(v=J(f._def,{...r,currentPath:[...r.basePath,r.definitionPath,h]},!0))!=null?v:pe(r)}},{}):void 0,t=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,n=(u=J(a._def,t===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,t]},!1))!=null?u:pe(r),o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(n.title=o),r.flags.hasReferencedOpenAiAnyType&&(s||(s={}),s[r.openAiAnyTypeName]||(s[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let i=t===void 0?s?{...n,[r.definitionPath]:s}:n:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,t].join("/"),[r.definitionPath]:{...s,[t]:n}};return r.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};0&&(module.exports={CallToolRequestSchema,Client,ListRootsRequestSchema,ListToolsRequestSchema,Loop,PingRequestSchema,ProgressNotificationSchema,SSEClientTransport,SSEServerTransport,Server,StdioClientTransport,StdioServerTransport,StreamableHTTPClientTransport,StreamableHTTPServerTransport,z,zodToJsonSchema});
/*! Bundled license information:

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)

bytes/index.js:
  (*!
   * bytes
   * Copyright(c) 2012-2014 TJ Holowaychuk
   * Copyright(c) 2015 Jed Watson
   * MIT Licensed
   *)

content-type/index.js:
  (*!
   * content-type
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)
*/
